/*
 @license
 Shaka Player
 Copyright 2016 Google LLC
 SPDX-License-Identifier: Apache-2.0
*/
(function(){var innerGlobal=typeof window!="undefined"?window:global;var exportTo={};(function(window,global,module){var m,aa="function"==typeof Object.defineProperties?Object.defineProperty:function(b,c,d){b!=Array.prototype&&b!=Object.prototype&&(b[c]=d.value)},ca="undefined"!=typeof window&&window===this?this:"undefined"!=typeof global&&null!=global?global:this;function da(){da=function(){};ca.Symbol||(ca.Symbol=fa)}var fa=function(){var b=0;return function(c){return"jscomp_symbol_"+(c||"")+b++}}();
function ha(){da();var b=ca.Symbol.iterator;b||(b=ca.Symbol.iterator=ca.Symbol("iterator"));"function"!=typeof Array.prototype[b]&&aa(Array.prototype,b,{configurable:!0,writable:!0,value:function(){return ia(this)}});ha=function(){}}function ia(b){var c=0;return ka(function(){return c<b.length?{done:!1,value:b[c++]}:{done:!0}})}function ka(b){ha();b={next:b};b[ca.Symbol.iterator]=function(){return this};return b}function t(b){ha();var c=b[Symbol.iterator];return c?c.call(b):ia(b)}
function ma(b,c){if(c){for(var d=ca,e=b.split("."),f=0;f<e.length-1;f++){var g=e[f];g in d||(d[g]={});d=d[g]}e=e[e.length-1];f=d[e];g=c(f);g!=f&&null!=g&&aa(d,e,{configurable:!0,writable:!0,value:g})}}
ma("Promise",function(b){function c(b){this.b=0;this.g=void 0;this.a=[];var c=this.c();try{b(c.resolve,c.reject)}catch(l){c.reject(l)}}function d(){this.a=null}function e(b){return b instanceof c?b:new c(function(c){c(b)})}if(b)return b;d.prototype.b=function(b){null==this.a&&(this.a=[],this.f());this.a.push(b)};d.prototype.f=function(){var b=this;this.c(function(){b.h()})};var f=ca.setTimeout;d.prototype.c=function(b){f(b,0)};d.prototype.h=function(){for(;this.a&&this.a.length;){var b=this.a;this.a=
[];for(var c=0;c<b.length;++c){var d=b[c];b[c]=null;try{d()}catch(n){this.g(n)}}}this.a=null};d.prototype.g=function(b){this.c(function(){throw b;})};c.prototype.c=function(){function b(b){return function(e){d||(d=!0,b.call(c,e))}}var c=this,d=!1;return{resolve:b(this.u),reject:b(this.f)}};c.prototype.u=function(b){if(b===this)this.f(new TypeError("A Promise cannot resolve to itself"));else if(b instanceof c)this.w(b);else{a:switch(typeof b){case "object":var d=null!=b;break a;case "function":d=!0;
break a;default:d=!1}d?this.o(b):this.h(b)}};c.prototype.o=function(b){var c=void 0;try{c=b.then}catch(l){this.f(l);return}"function"==typeof c?this.D(c,b):this.h(b)};c.prototype.f=function(b){this.i(2,b)};c.prototype.h=function(b){this.i(1,b)};c.prototype.i=function(b,c){if(0!=this.b)throw Error("Cannot settle("+b+", "+c+"): Promise already settled in state"+this.b);this.b=b;this.g=c;this.l()};c.prototype.l=function(){if(null!=this.a){for(var b=0;b<this.a.length;++b)g.b(this.a[b]);this.a=null}};
var g=new d;c.prototype.w=function(b){var c=this.c();b.kc(c.resolve,c.reject)};c.prototype.D=function(b,c){var d=this.c();try{b.call(c,d.resolve,d.reject)}catch(n){d.reject(n)}};c.prototype.then=function(b,d){function e(b,c){return"function"==typeof b?function(c){try{f(b(c))}catch(z){g(z)}}:c}var f,g,h=new c(function(b,c){f=b;g=c});this.kc(e(b,f),e(d,g));return h};c.prototype["catch"]=function(b){return this.then(void 0,b)};c.prototype.kc=function(b,c){function d(){switch(e.b){case 1:b(e.g);break;
case 2:c(e.g);break;default:throw Error("Unexpected state: "+e.b);}}var e=this;null==this.a?g.b(d):this.a.push(d)};c.resolve=e;c.reject=function(b){return new c(function(c,d){d(b)})};c.race=function(b){return new c(function(c,d){for(var f=t(b),g=f.next();!g.done;g=f.next())e(g.value).kc(c,d)})};c.all=function(b){var d=t(b),f=d.next();return f.done?e([]):new c(function(b,c){function g(c){return function(d){h[c]=d;k--;0==k&&b(h)}}var h=[],k=0;do h.push(void 0),k++,e(f.value).kc(g(h.length-1),c),f=d.next();
while(!f.done)})};return c});ma("Promise.prototype.finally",function(b){return b?b:function(b){return this.then(function(c){return Promise.resolve(b()).then(function(){return c})},function(c){return Promise.resolve(b()).then(function(){throw c;})})}});function na(b){function c(c){return b.next(c)}function d(c){return b["throw"](c)}return new Promise(function(e,f){function g(b){b.done?e(b.value):Promise.resolve(b.value).then(c,d).then(g,f)}g(b.next())})}function u(b){return na(b())}
var oa="function"==typeof Object.create?Object.create:function(b){function c(){}c.prototype=b;return new c},pa;if("function"==typeof Object.setPrototypeOf)pa=Object.setPrototypeOf;else{var qa;a:{var ra={Pe:!0},va={};try{va.__proto__=ra;qa=va.Pe;break a}catch(b){}qa=!1}pa=qa?function(b,c){b.__proto__=c;if(b.__proto__!==c)throw new TypeError(b+" is not extensible");return b}:null}var wa=pa;
function xa(b,c){b.prototype=oa(c.prototype);b.prototype.constructor=b;if(wa)wa(b,c);else for(var d in c)if("prototype"!=d)if(Object.defineProperties){var e=Object.getOwnPropertyDescriptor(c,d);e&&Object.defineProperty(b,d,e)}else b[d]=c[d];b.Hg=c.prototype}function ya(){this.g=!1;this.c=null;this.s=void 0;this.j=1;this.b=this.f=0;this.i=this.a=null}function za(b){if(b.g)throw new TypeError("Generator is already running");b.g=!0}ya.prototype.h=function(b){this.s=b};
function Aa(b,c){b.a={Yd:c,je:!0};b.j=b.f||b.b}ya.prototype["return"]=function(b){this.a={"return":b};this.j=this.b};function v(b,c,d){b.j=d;return{value:c}}ya.prototype.C=function(b){this.j=b};function w(b){b.j=0}function Ba(b,c,d){b.f=c;void 0!=d&&(b.b=d)}function Ca(b,c){b.f=0;b.b=c||0}function Fa(b,c){b.j=c;b.f=0}function Ga(b){b.f=0;var c=b.a.Yd;b.a=null;return c}function Ha(b){b.i=[b.a];b.f=0;b.b=0}
function La(b,c){var d=b.i.splice(0)[0];(d=b.a=b.a||d)?d.je?b.j=b.f||b.b:void 0!=d.C&&b.b<d.C?(b.j=d.C,b.a=null):b.j=b.b:b.j=c}function Ma(b){this.a=new ya;this.b=b}function Na(b,c){za(b.a);var d=b.a.c;if(d)return Oa(b,"return"in d?d["return"]:function(b){return{value:b,done:!0}},c,b.a["return"]);b.a["return"](c);return Qa(b)}
function Oa(b,c,d,e){try{var f=c.call(b.a.c,d);if(!(f instanceof Object))throw new TypeError("Iterator result "+f+" is not an object");if(!f.done)return b.a.g=!1,f;var g=f.value}catch(h){return b.a.c=null,Aa(b.a,h),Qa(b)}b.a.c=null;e.call(b.a,g);return Qa(b)}
function Qa(b){for(;b.a.j;)try{var c=b.b(b.a);if(c)return b.a.g=!1,{value:c.value,done:!1}}catch(d){b.a.s=void 0,Aa(b.a,d)}b.a.g=!1;if(b.a.a){c=b.a.a;b.a.a=null;if(c.je)throw c.Yd;return{value:c["return"],done:!0}}return{value:void 0,done:!0}}
function Ra(b){this.next=function(c){za(b.a);b.a.c?c=Oa(b,b.a.c.next,c,b.a.h):(b.a.h(c),c=Qa(b));return c};this["throw"]=function(c){za(b.a);b.a.c?c=Oa(b,b.a.c["throw"],c,b.a.h):(Aa(b.a,c),c=Qa(b));return c};this["return"]=function(c){return Na(b,c)};ha();this[Symbol.iterator]=function(){return this}}function x(b,c){Ra.prototype=b.prototype;return new Ra(new Ma(c))}function Sa(b){for(var c,d=[];!(c=b.next()).done;)d.push(c.value);return d}
function Ta(b,c){ha();b instanceof String&&(b+="");var d=0,e={next:function(){if(d<b.length){var f=d++;return{value:c(f,b[f]),done:!1}}e.next=function(){return{done:!0,value:void 0}};return e.next()}};e[Symbol.iterator]=function(){return e};return e}ma("Array.prototype.keys",function(b){return b?b:function(){return Ta(this,function(b){return b})}});function Ua(b,c){return Object.prototype.hasOwnProperty.call(b,c)}
ma("WeakMap",function(b){function c(b){this.a=(g+=Math.random()+1).toString();if(b){da();ha();b=t(b);for(var c;!(c=b.next()).done;)c=c.value,this.set(c[0],c[1])}}function d(b){Ua(b,f)||aa(b,f,{value:{}})}function e(b){var c=Object[b];c&&(Object[b]=function(b){d(b);return c(b)})}if(function(){if(!b||!Object.seal)return!1;try{var c=Object.seal({}),d=Object.seal({}),e=new b([[c,2],[d,3]]);if(2!=e.get(c)||3!=e.get(d))return!1;e["delete"](c);e.set(d,4);return!e.has(c)&&4==e.get(d)}catch(n){return!1}}())return b;
var f="$jscomp_hidden_"+Math.random();e("freeze");e("preventExtensions");e("seal");var g=0;c.prototype.set=function(b,c){d(b);if(!Ua(b,f))throw Error("WeakMap key fail: "+b);b[f][this.a]=c;return this};c.prototype.get=function(b){return Ua(b,f)?b[f][this.a]:void 0};c.prototype.has=function(b){return Ua(b,f)&&Ua(b[f],this.a)};c.prototype["delete"]=function(b){return Ua(b,f)&&Ua(b[f],this.a)?delete b[f][this.a]:!1};return c});
ma("Map",function(b){function c(){var b={};return b.Ja=b.next=b.head=b}function d(b,c){var d=b.a;return ka(function(){if(d){for(;d.head!=b.a;)d=d.Ja;for(;d.next!=d.head;)return d=d.next,{done:!1,value:c(d)};d=null}return{done:!0,value:void 0}})}function e(b,c){var d=c&&typeof c;"object"==d||"function"==d?g.has(c)?d=g.get(c):(d=""+ ++h,g.set(c,d)):d="p_"+c;var e=b.b[d];if(e&&Ua(b.b,d))for(var f=0;f<e.length;f++){var k=e[f];if(c!==c&&k.key!==k.key||c===k.key)return{id:d,list:e,index:f,ba:k}}return{id:d,
list:e,index:-1,ba:void 0}}function f(b){this.b={};this.a=c();this.size=0;if(b){b=t(b);for(var d;!(d=b.next()).done;)d=d.value,this.set(d[0],d[1])}}if(function(){if(!b||"function"!=typeof b||!b.prototype.entries||"function"!=typeof Object.seal)return!1;try{var c=Object.seal({x:4}),d=new b(t([[c,"s"]]));if("s"!=d.get(c)||1!=d.size||d.get({x:4})||d.set({x:4},"t")!=d||2!=d.size)return!1;var e=d.entries(),f=e.next();if(f.done||f.value[0]!=c||"s"!=f.value[1])return!1;f=e.next();return f.done||4!=f.value[0].x||
"t"!=f.value[1]||!e.next().done?!1:!0}catch(q){return!1}}())return b;da();ha();var g=new WeakMap;f.prototype.set=function(b,c){var d=e(this,b);d.list||(d.list=this.b[d.id]=[]);d.ba?d.ba.value=c:(d.ba={next:this.a,Ja:this.a.Ja,head:this.a,key:b,value:c},d.list.push(d.ba),this.a.Ja.next=d.ba,this.a.Ja=d.ba,this.size++);return this};f.prototype["delete"]=function(b){b=e(this,b);return b.ba&&b.list?(b.list.splice(b.index,1),b.list.length||delete this.b[b.id],b.ba.Ja.next=b.ba.next,b.ba.next.Ja=b.ba.Ja,
b.ba.head=null,this.size--,!0):!1};f.prototype.clear=function(){this.b={};this.a=this.a.Ja=c();this.size=0};f.prototype.has=function(b){return!!e(this,b).ba};f.prototype.get=function(b){return(b=e(this,b).ba)&&b.value};f.prototype.entries=function(){return d(this,function(b){return[b.key,b.value]})};f.prototype.keys=function(){return d(this,function(b){return b.key})};f.prototype.values=function(){return d(this,function(b){return b.value})};f.prototype.forEach=function(b,c){for(var d=this.entries(),
e;!(e=d.next()).done;)e=e.value,b.call(c,e[1],e[0],this)};f.prototype[Symbol.iterator]=f.prototype.entries;var h=0;return f});
ma("Set",function(b){function c(b){this.a=new Map;if(b){b=t(b);for(var c;!(c=b.next()).done;)this.add(c.value)}this.size=this.a.size}if(function(){if(!b||"function"!=typeof b||!b.prototype.entries||"function"!=typeof Object.seal)return!1;try{var c=Object.seal({x:4}),e=new b(t([c]));if(!e.has(c)||1!=e.size||e.add(c)!=e||1!=e.size||e.add({x:4})!=e||2!=e.size)return!1;var f=e.entries(),g=f.next();if(g.done||g.value[0]!=c||g.value[1]!=c)return!1;g=f.next();return g.done||g.value[0]==c||4!=g.value[0].x||
g.value[1]!=g.value[0]?!1:f.next().done}catch(h){return!1}}())return b;da();ha();c.prototype.add=function(b){this.a.set(b,b);this.size=this.a.size;return this};c.prototype["delete"]=function(b){b=this.a["delete"](b);this.size=this.a.size;return b};c.prototype.clear=function(){this.a.clear();this.size=0};c.prototype.has=function(b){return this.a.has(b)};c.prototype.entries=function(){return this.a.entries()};c.prototype.values=function(){return this.a.values()};c.prototype.keys=c.prototype.values;
c.prototype[Symbol.iterator]=c.prototype.values;c.prototype.forEach=function(b,c){var d=this;this.a.forEach(function(e){return b.call(c,e,e,d)})};return c});function Va(b,c,d){b instanceof String&&(b=String(b));for(var e=b.length,f=0;f<e;f++){var g=b[f];if(c.call(d,g,f,b))return{ge:f,Ke:g}}return{ge:-1,Ke:void 0}}ma("Array.prototype.findIndex",function(b){return b?b:function(b,d){return Va(this,b,d).ge}});
ma("Object.is",function(b){return b?b:function(b,d){return b===d?0!==b||1/b===1/d:b!==b&&d!==d}});ma("Array.prototype.includes",function(b){return b?b:function(b,d){var c=this;c instanceof String&&(c=String(c));var f=c.length,g=d||0;for(0>g&&(g=Math.max(g+f,0));g<f;g++){var h=c[g];if(h===b||Object.is(h,b))return!0}return!1}});
function Wa(b,c,d){if(null==b)throw new TypeError("The 'this' value for String.prototype."+d+" must not be null or undefined");if(c instanceof RegExp)throw new TypeError("First argument to String.prototype."+d+" must not be a regular expression");return b+""}ma("String.prototype.includes",function(b){return b?b:function(b,d){return-1!==Wa(this,b,"includes").indexOf(b,d||0)}});
ma("Array.from",function(b){return b?b:function(b,d,e){ha();d=null!=d?d:function(b){return b};var c=[],g=b[Symbol.iterator];if("function"==typeof g)for(b=g.call(b);!(g=b.next()).done;)c.push(d.call(e,g.value));else{g=b.length;for(var h=0;h<g;h++)c.push(d.call(e,b[h]))}return c}});ma("String.prototype.startsWith",function(b){return b?b:function(b,d){for(var c=Wa(this,b,"startsWith"),f=c.length,g=b.length,h=Math.max(0,Math.min(d|0,c.length)),k=0;k<g&&h<f;)if(c[h++]!=b[k++])return!1;return k>=g}});
ma("Array.prototype.find",function(b){return b?b:function(b,d){return Va(this,b,d).Ke}});var Xa="function"==typeof Object.assign?Object.assign:function(b,c){for(var d=1;d<arguments.length;d++){var e=arguments[d];if(e)for(var f in e)Ua(e,f)&&(b[f]=e[f])}return b};ma("Object.assign",function(b){return b||Xa});var ab=this;ab.a=!0;
function A(b,c){var d=b.split("."),e=ab;d[0]in e||!e.execScript||e.execScript("var "+d[0]);for(var f;d.length&&(f=d.shift());)d.length||void 0===c?e[f]?e=e[f]:e=e[f]={}:e[f]=c}function bb(b,c){function d(){}d.prototype=c.prototype;b.Hg=c.prototype;b.prototype=new d;b.prototype.constructor=b;b.Sg=function(b,d,g){return c.prototype[d].apply(b,Array.prototype.slice.call(arguments,2))}};/*

 Copyright 2016 Google Inc.

 Licensed under the Apache License, Version 2.0 (the "License");
 you may not use this file except in compliance with the License.
 You may obtain a copy of the License at

     http://www.apache.org/licenses/LICENSE-2.0

 Unless required by applicable law or agreed to in writing, software
 distributed under the License is distributed on an "AS IS" BASIS,
 WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 See the License for the specific language governing permissions and
 limitations under the License.
*/
function cb(b){this.c=Math.exp(Math.log(.5)/b);this.b=this.a=0}function db(b,c,d){var e=Math.pow(b.c,c);d=d*(1-e)+e*b.a;isNaN(d)||(b.a=d,b.b+=c)}function eb(b){return b.a/(1-Math.pow(b.c,b.b))};function fb(){this.b=new cb(2);this.c=new cb(5);this.a=0}fb.prototype.getBandwidthEstimate=function(b){return 128E3>this.a?b:Math.min(eb(this.b),eb(this.c))};var B={mb:0,jc:function(){},Y:function(){},error:function(){},m:function(){},info:function(){},debug:function(){},F:function(){},J:function(){}};window.console&&window.console.log.bind&&(B.Y=console.warn.bind(console),B.jc=console.error.bind(console),1<=B.mb&&(B.error=console.error.bind(console)),2<=B.mb&&(B.m=console.warn.bind(console)),3<=B.mb&&(B.info=console.info.bind(console)),4<=B.mb&&(B.debug=console.log.bind(console)),5<=B.mb&&(B.F=console.debug.bind(console)),6<=B.mb&&(B.J=console.debug.bind(console)));function D(b,c,d,e){for(var f=[],g=3;g<arguments.length;++g)f[g-3]=arguments[g];this.severity=b;this.category=c;this.code=d;this.data=f;this.handled=!1}A("shaka.util.Error",D);D.prototype.toString=function(){return"shaka.util.Error "+JSON.stringify(this,null,"  ")};D.Severity={RECOVERABLE:1,CRITICAL:2};D.Category={NETWORK:1,TEXT:2,MEDIA:3,MANIFEST:4,STREAMING:5,DRM:6,PLAYER:7,CAST:8,STORAGE:9};
D.Code={UNSUPPORTED_SCHEME:1E3,BAD_HTTP_STATUS:1001,HTTP_ERROR:1002,TIMEOUT:1003,MALFORMED_DATA_URI:1004,REQUEST_FILTER_ERROR:1006,RESPONSE_FILTER_ERROR:1007,MALFORMED_TEST_URI:1008,UNEXPECTED_TEST_REQUEST:1009,INVALID_TEXT_HEADER:2E3,INVALID_TEXT_CUE:2001,UNABLE_TO_DETECT_ENCODING:2003,BAD_ENCODING:2004,INVALID_XML:2005,INVALID_MP4_TTML:2007,INVALID_MP4_VTT:2008,UNABLE_TO_EXTRACT_CUE_START_TIME:2009,BUFFER_READ_OUT_OF_BOUNDS:3E3,JS_INTEGER_OVERFLOW:3001,EBML_OVERFLOW:3002,EBML_BAD_FLOATING_POINT_SIZE:3003,
MP4_SIDX_WRONG_BOX_TYPE:3004,MP4_SIDX_INVALID_TIMESCALE:3005,MP4_SIDX_TYPE_NOT_SUPPORTED:3006,WEBM_CUES_ELEMENT_MISSING:3007,WEBM_EBML_HEADER_ELEMENT_MISSING:3008,WEBM_SEGMENT_ELEMENT_MISSING:3009,WEBM_INFO_ELEMENT_MISSING:3010,WEBM_DURATION_ELEMENT_MISSING:3011,WEBM_CUE_TRACK_POSITIONS_ELEMENT_MISSING:3012,WEBM_CUE_TIME_ELEMENT_MISSING:3013,MEDIA_SOURCE_OPERATION_FAILED:3014,MEDIA_SOURCE_OPERATION_THREW:3015,VIDEO_ERROR:3016,QUOTA_EXCEEDED_ERROR:3017,TRANSMUXING_FAILED:3018,UNABLE_TO_GUESS_MANIFEST_TYPE:4E3,
DASH_INVALID_XML:4001,DASH_NO_SEGMENT_INFO:4002,DASH_EMPTY_ADAPTATION_SET:4003,DASH_EMPTY_PERIOD:4004,DASH_WEBM_MISSING_INIT:4005,DASH_UNSUPPORTED_CONTAINER:4006,DASH_PSSH_BAD_ENCODING:4007,DASH_NO_COMMON_KEY_SYSTEM:4008,DASH_MULTIPLE_KEY_IDS_NOT_SUPPORTED:4009,DASH_CONFLICTING_KEY_IDS:4010,UNPLAYABLE_PERIOD:4011,RESTRICTIONS_CANNOT_BE_MET:4012,NO_PERIODS:4014,HLS_PLAYLIST_HEADER_MISSING:4015,INVALID_HLS_TAG:4016,HLS_INVALID_PLAYLIST_HIERARCHY:4017,DASH_DUPLICATE_REPRESENTATION_ID:4018,HLS_MULTIPLE_MEDIA_INIT_SECTIONS_FOUND:4020,
HLS_COULD_NOT_GUESS_MIME_TYPE:4021,HLS_MASTER_PLAYLIST_NOT_PROVIDED:4022,HLS_REQUIRED_ATTRIBUTE_MISSING:4023,HLS_REQUIRED_TAG_MISSING:4024,HLS_COULD_NOT_GUESS_CODECS:4025,HLS_KEYFORMATS_NOT_SUPPORTED:4026,DASH_UNSUPPORTED_XLINK_ACTUATE:4027,DASH_XLINK_DEPTH_LIMIT:4028,HLS_COULD_NOT_PARSE_SEGMENT_START_TIME:4030,CONTENT_UNSUPPORTED_BY_BROWSER:4032,CANNOT_ADD_EXTERNAL_TEXT_TO_LIVE_STREAM:4033,HLS_AES_128_ENCRYPTION_NOT_SUPPORTED:4034,HLS_INTERNAL_SKIP_STREAM:4035,INVALID_STREAMS_CHOSEN:5005,NO_RECOGNIZED_KEY_SYSTEMS:6E3,
REQUESTED_KEY_SYSTEM_CONFIG_UNAVAILABLE:6001,FAILED_TO_CREATE_CDM:6002,FAILED_TO_ATTACH_TO_VIDEO:6003,INVALID_SERVER_CERTIFICATE:6004,FAILED_TO_CREATE_SESSION:6005,FAILED_TO_GENERATE_LICENSE_REQUEST:6006,LICENSE_REQUEST_FAILED:6007,LICENSE_RESPONSE_REJECTED:6008,ENCRYPTED_CONTENT_WITHOUT_DRM_INFO:6010,NO_LICENSE_SERVER_GIVEN:6012,OFFLINE_SESSION_REMOVED:6013,EXPIRED:6014,SERVER_CERTIFICATE_REQUIRED:6015,INIT_DATA_TRANSFORM_ERROR:6016,LOAD_INTERRUPTED:7E3,OPERATION_ABORTED:7001,NO_VIDEO_ELEMENT:7002,
CAST_API_UNAVAILABLE:8E3,NO_CAST_RECEIVERS:8001,ALREADY_CASTING:8002,UNEXPECTED_CAST_ERROR:8003,CAST_CANCELED_BY_USER:8004,CAST_CONNECTION_TIMED_OUT:8005,CAST_RECEIVER_APP_UNAVAILABLE:8006,STORAGE_NOT_SUPPORTED:9E3,INDEXED_DB_ERROR:9001,DEPRECATED_OPERATION_ABORTED:9002,REQUESTED_ITEM_NOT_FOUND:9003,MALFORMED_OFFLINE_URI:9004,CANNOT_STORE_LIVE_OFFLINE:9005,STORE_ALREADY_IN_PROGRESS:9006,NO_INIT_DATA_FOR_OFFLINE:9007,LOCAL_PLAYER_INSTANCE_REQUIRED:9008,NEW_KEY_OPERATION_NOT_SUPPORTED:9011,KEY_NOT_FOUND:9012,
MISSING_STORAGE_CELL:9013};/*
 @license
 Copyright 2008 The Closure Library Authors
 SPDX-License-Identifier: Apache-2.0
*/
var gb=/^(?:([^:/?#.]+):)?(?:\/\/(?:([^/?#]*)@)?([^/#?]*?)(?::([0-9]+))?(?=[/#?]|$))?([^?#]+)?(?:\?([^#]*))?(?:#(.*))?$/;/*
 @license
 Copyright 2006 The Closure Library Authors
 SPDX-License-Identifier: Apache-2.0
*/
function hb(b){var c;b instanceof hb?(ib(this,b.xa),this.jb=b.jb,this.wa=b.wa,jb(this,b.Jb),this.la=b.la,kb(this,b.a.clone()),this.Xa=b.Xa):b&&(c=String(b).match(gb))?(ib(this,c[1]||"",!0),this.jb=ob(c[2]||""),this.wa=ob(c[3]||"",!0),jb(this,c[4]),this.la=ob(c[5]||"",!0),kb(this,c[6]||"",!0),this.Xa=ob(c[7]||"")):this.a=new pb(null)}m=hb.prototype;m.xa="";m.jb="";m.wa="";m.Jb=null;m.la="";m.Xa="";
m.toString=function(){var b=[],c=this.xa;c&&b.push(qb(c,rb,!0),":");if(c=this.wa){b.push("//");var d=this.jb;d&&b.push(qb(d,rb,!0),"@");b.push(encodeURIComponent(c).replace(/%25([0-9a-fA-F]{2})/g,"%$1"));c=this.Jb;null!=c&&b.push(":",String(c))}if(c=this.la)this.wa&&"/"!=c.charAt(0)&&b.push("/"),b.push(qb(c,"/"==c.charAt(0)?sb:tb,!0));(c=this.a.toString())&&b.push("?",c);(c=this.Xa)&&b.push("#",qb(c,ub));return b.join("")};
m.resolve=function(b){var c=this.clone();"data"===c.xa&&(c=new hb);var d=!!b.xa;d?ib(c,b.xa):d=!!b.jb;d?c.jb=b.jb:d=!!b.wa;d?c.wa=b.wa:d=null!=b.Jb;var e=b.la;if(d)jb(c,b.Jb);else if(d=!!b.la){if("/"!=e.charAt(0))if(this.wa&&!this.la)e="/"+e;else{var f=c.la.lastIndexOf("/");-1!=f&&(e=c.la.substr(0,f+1)+e)}if(".."==e||"."==e)e="";else if(-1!=e.indexOf("./")||-1!=e.indexOf("/.")){f=0==e.lastIndexOf("/",0);e=e.split("/");for(var g=[],h=0;h<e.length;){var k=e[h++];"."==k?f&&h==e.length&&g.push(""):".."==
k?((1<g.length||1==g.length&&""!=g[0])&&g.pop(),f&&h==e.length&&g.push("")):(g.push(k),f=!0)}e=g.join("/")}}d?c.la=e:d=""!==b.a.toString();d?kb(c,b.a.clone()):d=!!b.Xa;d&&(c.Xa=b.Xa);return c};m.clone=function(){return new hb(this)};function ib(b,c,d){b.xa=d?ob(c,!0):c;b.xa&&(b.xa=b.xa.replace(/:$/,""))}function jb(b,c){if(c){c=Number(c);if(isNaN(c)||0>c)throw Error("Bad port number "+c);b.Jb=c}else b.Jb=null}function kb(b,c,d){c instanceof pb?b.a=c:(d||(c=qb(c,vb)),b.a=new pb(c))}
function ob(b,c){return b?c?decodeURI(b):decodeURIComponent(b):""}function qb(b,c,d){return"string"==typeof b?(b=encodeURI(b).replace(c,wb),d&&(b=b.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),b):null}function wb(b){b=b.charCodeAt(0);return"%"+(b>>4&15).toString(16)+(b&15).toString(16)}var rb=/[#\/\?@]/g,tb=/[#\?:]/g,sb=/[#\?]/g,vb=/[#\?@]/g,ub=/#/g;function pb(b){this.a=b||null}m=pb.prototype;m.ja=null;m.nc=null;
m.add=function(b,c){if(!this.ja&&(this.ja={},this.nc=0,this.a))for(var d=this.a.split("&"),e=0;e<d.length;e++){var f=d[e].indexOf("="),g=null;if(0<=f){var h=d[e].substring(0,f);g=d[e].substring(f+1)}else h=d[e];h=decodeURIComponent(h.replace(/\+/g," "));g=g||"";this.add(h,decodeURIComponent(g.replace(/\+/g," ")))}this.a=null;(d=this.ja.hasOwnProperty(b)&&this.ja[b])||(this.ja[b]=d=[]);d.push(c);this.nc++;return this};
m.toString=function(){if(this.a)return this.a;if(!this.ja)return"";var b=[],c;for(c in this.ja)for(var d=encodeURIComponent(c),e=this.ja[c],f=0;f<e.length;f++){var g=d;""!==e[f]&&(g+="="+encodeURIComponent(e[f]));b.push(g)}return this.a=b.join("&")};m.clone=function(){var b=new pb;b.a=this.a;if(this.ja){var c={},d;for(d in this.ja)c[d]=this.ja[d].concat();b.ja=c;b.nc=this.nc}return b};var xb={Ze:function(b,c){return b.reduce(function(b,c,f){return c["catch"](b.bind(null,f))}.bind(null,c),Promise.reject())},Oc:function(b,c){return b.concat(c)},wc:function(){},Na:function(b){return null!=b}};function yb(b,c){if(0==c.length)return b;var d=c.map(function(b){return new hb(b)});return b.map(function(b){return new hb(b)}).map(function(b){return d.map(b.resolve.bind(b))}).reduce(xb.Oc,[]).map(function(b){return b.toString()})}function zb(b,c){return{keySystem:b,licenseServerUri:"",distinctiveIdentifierRequired:!1,persistentStateRequired:!1,audioRobustness:"",videoRobustness:"",serverCertificate:null,initData:c||[],keyIds:[]}}
var Ab={Ua:"video",Nb:"audio",va:"text",Qg:"image",Og:"application"},Fb=1/15;function E(){var b,c,d=new Promise(function(d,f){b=d;c=f});d.resolve=b;d.reject=c;return d}E.prototype.resolve=function(){};E.prototype.reject=function(){};function Gb(b){if(!b)return"";b=new Uint8Array(b);239==b[0]&&187==b[1]&&191==b[2]&&(b=b.subarray(3));b=Hb(b);b=escape(b);try{return decodeURIComponent(b)}catch(c){throw new D(2,2,2004);}}A("shaka.util.StringUtils.fromUTF8",Gb);
function Ib(b,c,d){if(!b)return"";if(!d&&0!=b.byteLength%2)throw B.error("Data has an incorrect length, must be even."),new D(2,2,2004);if(b instanceof ArrayBuffer)var e=b;else d=new Uint8Array(b.byteLength),d.set(new Uint8Array(b)),e=d.buffer;b=Math.floor(b.byteLength/2);d=new Uint16Array(b);e=new DataView(e);for(var f=0;f<b;f++)d[f]=e.getUint16(2*f,c);return Hb(d)}A("shaka.util.StringUtils.fromUTF16",Ib);
function Jb(b){var c=new Uint8Array(b);if(239==c[0]&&187==c[1]&&191==c[2])return Gb(c);if(254==c[0]&&255==c[1])return Ib(c.subarray(2),!1);if(255==c[0]&&254==c[1])return Ib(c.subarray(2),!0);var d=function(b,c){return b.byteLength<=c||32<=b[c]&&126>=b[c]}.bind(null,c);B.debug("Unable to find byte-order-mark, making an educated guess.");if(0==c[0]&&0==c[2])return Ib(b,!1);if(0==c[1]&&0==c[3])return Ib(b,!0);if(d(0)&&d(1)&&d(2)&&d(3))return Gb(b);throw new D(2,2,2003);}
A("shaka.util.StringUtils.fromBytesAutoDetect",Jb);function Kb(b){b=encodeURIComponent(b);b=unescape(b);for(var c=new Uint8Array(b.length),d=0;d<b.length;++d)c[d]=b.charCodeAt(d);return c.buffer}A("shaka.util.StringUtils.toUTF8",Kb);function Lb(b,c){for(var d=new Uint8Array(2*b.length),e=new DataView(d.buffer),f=0;f<b.length;++f)e.setUint16(2*f,b.charCodeAt(f),c);return d.buffer}A("shaka.util.StringUtils.toUTF16",Lb);
function Hb(b){if(!Mb)for(var c=function(b){try{var c=new Uint8Array(b);return 0<String.fromCharCode.apply(null,c).length}catch(g){return!1}},d={size:65536};0<d.size;d={size:d.size},d.size/=2)if(c(d.size)){Mb=function(b){return function(c){for(var d="",e=0;e<c.length;e+=b.size)d+=String.fromCharCode.apply(null,c.subarray(e,e+b.size));return d}}(d);break}return Mb(b)}var Mb=null;A("shaka.util.StringUtils.resetFromCharCode",function(){Mb=null});var G={Hc:function(b,c){var d=Hb(b);c=void 0==c?!0:c;d=window.btoa(d).replace(/\+/g,"-").replace(/\//g,"_");return c?d:d.replace(/=*$/,"")}};A("shaka.util.Uint8ArrayUtils.toBase64",G.Hc);G.Fa=function(b){b=window.atob(b.replace(/-/g,"+").replace(/_/g,"/"));for(var c=new Uint8Array(b.length),d=0;d<b.length;++d)c[d]=b.charCodeAt(d);return c};A("shaka.util.Uint8ArrayUtils.fromBase64",G.Fa);
G.Yc=function(b){for(var c=new Uint8Array(b.length/2),d=0;d<b.length;d+=2)c[d/2]=window.parseInt(b.substr(d,2),16);return c};A("shaka.util.Uint8ArrayUtils.fromHex",G.Yc);G.Ic=function(b){for(var c="",d=0;d<b.length;++d){var e=b[d].toString(16);1==e.length&&(e="0"+e);c+=e}return c};A("shaka.util.Uint8ArrayUtils.toHex",G.Ic);G.Da=function(b,c){if(!b&&!c)return!0;if(!b||!c||b.length!=c.length)return!1;for(var d=0;d<b.length;++d)if(b[d]!=c[d])return!1;return!0};A("shaka.util.Uint8ArrayUtils.equal",G.Da);
G.concat=function(b){for(var c=[],d=0;d<arguments.length;++d)c[d]=arguments[d];for(var e=d=0;e<c.length;++e)d+=c[e].length;d=new Uint8Array(d);for(var f=e=0;f<c.length;++f)d.set(c[f],e),e+=c[f].length;return d};A("shaka.util.Uint8ArrayUtils.concat",G.concat);function Nb(){this.a=new muxjs.mp4.Transmuxer({keepOriginalTimestamps:!0});this.b=null;this.g=[];this.c=[];this.f=!1;this.a.on("data",this.i.bind(this));this.a.on("done",this.h.bind(this))}Nb.prototype.destroy=function(){this.a.dispose();this.a=null;return Promise.resolve()};function Ob(b,c){return window.muxjs&&"mp2t"==b.toLowerCase().split(";")[0].split("/")[1]?c?MediaSource.isTypeSupported(Pb(c,b)):MediaSource.isTypeSupported(Pb("audio",b))||MediaSource.isTypeSupported(Pb("video",b)):!1}
function Pb(b,c){var d=c.replace(/mp2t/i,"mp4");"audio"==b&&(d=d.replace("video","audio"));var e=/avc1\.(66|77|100)\.(\d+)/.exec(d);if(e){var f="avc1.",g=e[1],h=Number(e[2]);f=("66"==g?f+"4200":"77"==g?f+"4d00":f+"6400")+(h>>4).toString(16);f+=(h&15).toString(16);d=d.replace(e[0],f)}return d}function Qb(b,c){b.f=!0;b.b=new E;b.g=[];b.c=[];var d=new Uint8Array(c);b.a.push(d);b.a.flush();b.f&&b.b.reject(new D(2,3,3018));return b.b}
Nb.prototype.i=function(b){this.c=b.captions;var c=new Uint8Array(b.data.byteLength+b.initSegment.byteLength);c.set(b.initSegment,0);c.set(b.data,b.initSegment.byteLength);this.g.push(c)};Nb.prototype.h=function(){var b={data:G.concat.apply(null,this.g),captions:this.c};this.b.resolve(b);this.f=!1};function Rb(b){this.b=b;this.a=null}Rb.prototype.R=function(b){var c=this;this.stop();var d=!0,e=null;this.a=function(){window.clearTimeout(e);d=!1};e=window.setTimeout(function(){d&&c.b()},1E3*b);return this};Rb.prototype.stop=function(){this.a&&(this.a(),this.a=null)};function I(b){this.b=b;this.a=null}A("shaka.util.Timer",I);I.prototype.Gc=function(){this.stop();this.b();return this};I.prototype.tickNow=I.prototype.Gc;I.prototype.R=function(b){var c=this;this.stop();this.a=(new Rb(function(){c.b()})).R(b);return this};I.prototype.tickAfter=I.prototype.R;I.prototype.Ka=function(b){var c=this;this.stop();this.a=(new Rb(function(){c.a.R(b);c.b()})).R(b);return this};I.prototype.tickEvery=I.prototype.Ka;I.prototype.stop=function(){this.a&&(this.a.stop(),this.a=null)};
I.prototype.stop=I.prototype.stop;function Sb(b,c){var d=Tb();this.i=null==b.maxAttempts?d.maxAttempts:b.maxAttempts;this.f=null==b.baseDelay?d.baseDelay:b.baseDelay;this.h=null==b.fuzzFactor?d.fuzzFactor:b.fuzzFactor;this.g=null==b.backoffFactor?d.backoffFactor:b.backoffFactor;this.a=0;this.b=this.f;if(this.c=void 0===c?!1:c)this.a=1}
function Ub(b){return u(function d(){var e,f;return x(d,function(d){switch(d.j){case 1:if(b.a>=b.i)if(b.c)b.a=1,b.b=b.f;else return d["return"](Promise.reject());e=b.a;b.a++;if(0==e)return d["return"]();f=b.b*(1+(2*Math.random()-1)*b.h);return v(d,new Promise(function(b){(new I(b)).R(f/1E3)}),2);case 2:b.b*=b.g,w(d)}})})}function Tb(){return{maxAttempts:2,baseDelay:1E3,backoffFactor:2,fuzzFactor:.5,timeout:0}};function J(b,c){this.promise=b;this.ne=c;this.a=!1}A("shaka.util.AbortableOperation",J);function Vb(b){return new J(Promise.reject(b),function(){return Promise.resolve()})}J.failed=Vb;function Wb(){var b=Promise.reject(new D(2,7,7001));b["catch"](function(){});return new J(b,function(){return Promise.resolve()})}J.aborted=Wb;function Xb(b){return new J(Promise.resolve(b),function(){return Promise.resolve()})}J.completed=Xb;
function Yb(b){return new J(b,function(){return b["catch"](function(){})})}J.notAbortable=Yb;J.prototype.abort=function(){this.a=!0;return this.ne()};J.prototype.abort=J.prototype.abort;function Zb(b){return new J(Promise.all(b.map(function(b){return b.promise})),function(){return Promise.all(b.map(function(b){return b.abort()}))})}J.all=Zb;J.prototype["finally"]=function(b){this.promise.then(function(){return b(!0)},function(){return b(!1)});return this};J.prototype["finally"]=J.prototype["finally"];
J.prototype.Z=function(b,c){function d(d){return function(k){if(f.a&&d)g.reject(h);else{var l=d?b:c;l?e=$b(l,k,g):(d?g.resolve:g.reject)(k)}}}function e(){g.reject(h);return f.abort()}var f=this,g=new E,h=new D(2,7,7001);this.promise.then(d(!0),d(!1));return new J(g,function(){return e()})};J.prototype.chain=J.prototype.Z;
function $b(b,c,d){try{var e=b(c);if(e&&e.promise&&e.abort)return d.resolve(e.promise),function(){return e.abort()};d.resolve(e);return function(){return Promise.resolve(e).then(function(){},function(){})}}catch(f){return d.reject(f),function(){return Promise.resolve()}}};function K(b,c){c=void 0===c?{}:c;for(var d in c)this[d]=c[d];this.defaultPrevented=this.cancelable=this.bubbles=!1;this.timeStamp=window.performance&&window.performance.now?window.performance.now():Date.now();this.type=b;this.isTrusted=!1;this.target=this.currentTarget=null;this.a=!1}A("shaka.util.FakeEvent",K);K.prototype.preventDefault=function(){this.cancelable&&(this.defaultPrevented=!0)};K.prototype.stopImmediatePropagation=function(){this.a=!0};K.prototype.stopPropagation=function(){};function ac(){this.a={}}m=ac.prototype;m.push=function(b,c){this.a.hasOwnProperty(b)?this.a[b].push(c):this.a[b]=[c]};m.get=function(b){return(b=this.a[b])?b.slice():null};m.getAll=function(){var b=[],c;for(c in this.a)b.push.apply(b,this.a[c]);return b};m.remove=function(b,c){var d=this.a[b];if(d)for(var e=0;e<d.length;++e)d[e]==c&&(d.splice(e,1),--e)};m.forEach=function(b){for(var c in this.a)b(c,this.a[c])};m.size=function(){return Object.keys(this.a).length};function bc(){this.Sc=new ac;this.gc=this}bc.prototype.addEventListener=function(b,c){this.Sc.push(b,c)};bc.prototype.removeEventListener=function(b,c){this.Sc.remove(b,c)};bc.prototype.dispatchEvent=function(b){for(var c=this.Sc.get(b.type)||[],d=0;d<c.length;++d){b.target=this.gc;b.currentTarget=this.gc;var e=c[d];try{e.handleEvent?e.handleEvent(b):e.call(this,b)}catch(f){B.error("Uncaught exception in event handler",f,f?f.message:null,f?f.stack:null)}if(b.a)break}return b.defaultPrevented};function cc(b){function c(b){switch(typeof b){case "undefined":case "boolean":case "number":case "string":case "symbol":case "function":return b;default:if(!b||b.buffer&&b.buffer.constructor==ArrayBuffer)return b;if(d.has(b))return null;var e=b.constructor==Array;if(b.constructor!=Object&&!e)return null;d.add(b);var g=e?[]:{},h;for(h in b)g[h]=c(b[h]);e&&(g.length=b.length);return g}}var d=new Set;return c(b)};function ec(b,c){return"number"===typeof b&&"number"===typeof c&&isNaN(b)&&isNaN(c)?!0:b===c}function fc(b,c){var d=b.indexOf(c);-1<d&&b.splice(d,1)}function gc(b,c){var d=0;b.forEach(function(b){d+=c(b)?1:0});return d}
function hc(b,c,d){d||(d=ec);if(b.length!=c.length)return!1;c=c.slice();var e={};b=t(b);for(var f=b.next();!f.done;e={item:e.item},f=b.next()){e.item=f.value;f=c.findIndex(function(b){return function(c){return d(b.item,c)}}(e));if(-1==f)return!1;c[f]=c[c.length-1];c.pop()}return 0==c.length};function ic(){this.a=[]}function jc(b,c){b.a.push(c["finally"](function(){fc(b.a,c)}))}ic.prototype.destroy=function(){var b=[];this.a.forEach(function(c){c.promise["catch"](function(){});b.push(c.abort())});this.a=[];return Promise.all(b)};function L(b){bc.call(this);this.f=!1;this.g=new ic;this.a=new Set;this.b=new Set;this.c=b||null}bb(L,bc);A("shaka.net.NetworkingEngine",L);L.RequestType={MANIFEST:0,SEGMENT:1,LICENSE:2,APP:3,TIMING:4};L.PluginPriority={FALLBACK:1,PREFERRED:2,APPLICATION:3};var kc={};function lc(b,c,d){d=d||3;var e=kc[b];if(!e||d>=e.priority)kc[b]={priority:d,hg:c}}L.registerScheme=lc;L.unregisterScheme=function(b){delete kc[b]};L.prototype.jg=function(b){this.a.add(b)};L.prototype.registerRequestFilter=L.prototype.jg;
L.prototype.Jg=function(b){this.a["delete"](b)};L.prototype.unregisterRequestFilter=L.prototype.Jg;L.prototype.Xe=function(){this.a.clear()};L.prototype.clearAllRequestFilters=L.prototype.Xe;L.prototype.kg=function(b){this.b.add(b)};L.prototype.registerResponseFilter=L.prototype.kg;L.prototype.Kg=function(b){this.b["delete"](b)};L.prototype.unregisterResponseFilter=L.prototype.Kg;L.prototype.Ye=function(){this.b.clear()};L.prototype.clearAllResponseFilters=L.prototype.Ye;
L.defaultRetryParameters=function(){return Tb()};function mc(b,c){return{uris:b,method:"GET",body:null,headers:{},allowCrossSiteCredentials:!1,retryParameters:c,licenseRequestType:null,sessionId:null}}L.makeRequest=mc;L.prototype.destroy=function(){this.f=!0;this.a.clear();this.b.clear();return this.g.destroy()};L.prototype.destroy=L.prototype.destroy;
L.prototype.request=function(b,c){var d=this,e=new nc;if(this.f){var f=Promise.reject(new D(2,7,7001));f["catch"](function(){});return new oc(f,function(){return Promise.resolve()},e)}c.method=c.method||"GET";c.headers=c.headers||{};c.retryParameters=c.retryParameters?cc(c.retryParameters):Tb();c.uris=cc(c.uris);f=pc(this,b,c);var g=f.Z(function(){return qc(d,b,c,new Sb(c.retryParameters,!1),0,null,e)}),h=g.Z(function(c){return rc(d,b,c)}),k=Date.now(),l=0;f.promise.then(function(){l=Date.now()-k},
function(){});var n=0;g.promise.then(function(){n=Date.now()},function(){});f=h.Z(function(c){var e=Date.now()-n,f=c.response;f.timeMs+=l;f.timeMs+=e;c.If||!d.c||f.fromCache||1!=b||d.c(f.timeMs,f.data.byteLength);return f},function(b){b&&(b.severity=2);throw b;});f=new oc(f.promise,f.ne,e);jc(this.g,f);return f};L.prototype.request=L.prototype.request;
function pc(b,c,d){var e=Xb(void 0),f={};b=t(b.a);for(var g=b.next();!g.done;f={Ad:f.Ad},g=b.next())f.Ad=g.value,e=e.Z(function(b){return function(){return b.Ad(c,d)}}(f));return e.Z(void 0,function(b){if(b&&7001==b.code)throw b;throw new D(2,1,1006,b);})}
function qc(b,c,d,e,f,g,h){var k=new hb(d.uris[f]),l=k.xa,n=!1;l||(l=location.protocol,l=l.slice(0,-1),ib(k,l),d.uris[f]=k.toString());l=l.toLowerCase();var p=(l=kc[l])?l.hg:null;if(!p)return Vb(new D(2,1,1E3,k));var q;return Yb(Ub(e)).Z(function(){if(b.f)return Wb();q=Date.now();return p(d.uris[f],d,c,function(d,e,f){b.c&&1==c&&(b.c(d,e),n=!0,h.a=f)})}).Z(function(b){void 0==b.timeMs&&(b.timeMs=Date.now()-q);return{response:b,If:n}},function(k){if(k&&7001==k.code)throw k;if(b.f)return Wb();if(k&&
1==k.severity)return b.dispatchEvent(new K("retry",{error:k instanceof D?k:null})),f=(f+1)%d.uris.length,qc(b,c,d,e,f,k,h);throw k||g;})}function rc(b,c,d){var e=Xb(void 0);b=t(b.b);for(var f=b.next();!f.done;f=b.next())e=e.Z(f.value.bind(null,c,d.response));return e.Z(function(){return d},function(b){if(b&&7001==b.code)throw b;var c=2;b instanceof D&&(c=b.severity);throw new D(c,1,1007,b);})}function nc(){this.a=0}L.NumBytesRemainingClass=nc;function oc(b,c,d){J.call(this,b,c);this.b=d}xa(oc,J);
L.PendingRequest=oc;oc.all=Zb;oc.notAbortable=Yb;oc.completed=Xb;oc.aborted=Wb;oc.failed=Vb;function sc(){}A("shaka.util.IReleasable",sc);sc.prototype.release=function(){};function M(){this.a=new ac}A("shaka.util.EventManager",M);M.prototype.release=function(){this.hb();this.a=null};M.prototype.release=M.prototype.release;M.prototype.B=function(b,c,d,e){this.a&&(b=new tc(b,c,d,e),this.a.push(c,b))};M.prototype.listen=M.prototype.B;M.prototype.ua=function(b,c,d,e){function f(e){g.pa(b,c,f);d(e)}var g=this;this.B(b,c,f,e)};M.prototype.listenOnce=M.prototype.ua;
M.prototype.pa=function(b,c,d){if(this.a){var e=this.a.get(c)||[];e=t(e);for(var f=e.next();!f.done;f=e.next())f=f.value,f.target!=b||d!=f.listener&&d||(f.pa(),this.a.remove(c,f))}};M.prototype.unlisten=M.prototype.pa;M.prototype.hb=function(){if(this.a){var b=this.a.getAll();b=t(b);for(var c=b.next();!c.done;c=b.next())c.value.pa();this.a.a={}}};M.prototype.removeAll=M.prototype.hb;
function tc(b,c,d,e){this.target=b;this.type=c;this.listener=d;this.a=uc(b,e);this.target.addEventListener(c,d,this.a)}tc.prototype.pa=function(){this.target.removeEventListener(this.type,this.listener,this.a);this.listener=this.target=null;this.a=!1};tc.prototype.unlisten=tc.prototype.pa;function uc(b,c){if(void 0==c)return!1;if("boolean"==typeof c)return c;var d=new Set(["passive","capture"]);Object.keys(c).filter(function(b){return!d.has(b)});return vc(b)?c:c.capture||!1}
function vc(b){var c=wc;if(void 0==c){c=!1;try{var d={},e={get:function(){c=!0;return!1}};Object.defineProperty(d,"passive",e);Object.defineProperty(d,"capture",e);e=function(){};b.addEventListener("test",e,d);b.removeEventListener("test",e,d)}catch(f){c=!1}wc=c}return c||!1}var wc=void 0;function xc(b){b=Jb(b);return(new hb(b)).wa}A("shaka.util.FairPlayUtils.defaultGetContentId",xc);function yc(b,c,d){function e(b){(new DataView(f.buffer)).setUint32(g,b.byteLength,!0);g+=4;f.set(b,g);g+=b.byteLength}if(!d||!d.byteLength)throw new D(2,6,6015);c="string"==typeof c?new Uint8Array(Lb(c,!0)):new Uint8Array(c);b=Jb(b);b=Lb(b,!0);var f=new Uint8Array(12+b.byteLength+c.byteLength+d.byteLength),g=0;e(new Uint8Array(b));e(c);e(new Uint8Array(d));return f}
A("shaka.util.FairPlayUtils.initDataTransform",yc);function zc(b,c){for(var d=[],e=t(b),f=e.next();!f.done;f=e.next())d.push(c(f.value));return d}function Ac(b,c){for(var d=t(b),e=d.next();!e.done;e=d.next())if(!c(e.value))return!1;return!0};function Bc(b){var c=new Map;Object.keys(b).forEach(function(d){c.set(d,b[d])});return c}function Cc(b){var c={};b.forEach(function(b,e){c[e]=b});return c};function Dc(b,c){var d=b;c&&(d+='; codecs="'+c+'"');return d}function Ec(b){var c=[b.mimeType];Fc.forEach(function(d,e){var f=b[e];f&&c.push(d+'="'+f+'"')});return c.join(";")}function Gc(b){b=b.split(".");var c=b[0];b.pop();return[c,b.join(".")]}var Fc=(new Map).set("codecs","codecs").set("frameRate","framerate").set("bandwidth","bitrate").set("width","width").set("height","height").set("channelsCount","channels");function Hc(){return window.MediaSource&&MediaSource.isTypeSupported?!0:!1}function Ic(b){return""!=Jc().canPlayType(b)}function Kc(){return Lc("Tizen")}function Mc(){return!!navigator.vendor&&navigator.vendor.includes("Apple")&&!Kc()}function Nc(){if(!Mc())return null;var b=navigator.userAgent.match(/Version\/(\d+)/);return b?parseInt(b[1],10):(b=navigator.userAgent.match(/OS (\d+)(?:_\d+)?/))?parseInt(b[1],10):null}function Lc(b){return(navigator.userAgent||"").includes(b)}
function Jc(){if(Oc)return Oc;Pc||(Pc=new I(function(){Oc=null}));(Oc=document.getElementsByTagName("video")[0]||document.getElementsByTagName("audio")[0])||(Oc=document.createElement("video"));Pc.R(1);return Oc}var Pc=null,Oc=null;function Qc(b,c){var d=this;c=void 0===c?1:c;this.D=b;this.u=new Set;this.h=this.i=null;this.V=!1;this.K=0;this.a=null;this.l=new M;this.b=new Map;this.w=[];this.o=new E;this.f=null;this.g=function(c){d.o.reject(c);b.onError(c)};this.sa=new Map;this.$=new Map;this.T=new I(function(){return Rc(d)});this.c=!1;this.qa=new E;this.G=!1;this.H=[];this.ra=!1;this.ea=(new I(function(){Sc(d)})).Ka(c);this.o["catch"](function(){})}m=Qc.prototype;
m.destroy=function(){var b=this;return u(function d(){return x(d,function(d){switch(d.j){case 1:if(b.c)return v(d,b.qa,0);b.c=!0;return v(d,Tc(b),4);case 4:b.qa.resolve(),d.C(0)}})})};
function Tc(b){return u(function d(){return x(d,function(d){switch(d.j){case 1:return b.l.release(),b.l=null,b.o.reject(),b.ea.stop(),b.ea=null,b.T.stop(),b.T=null,v(d,Uc(b),2);case 2:if(!b.h){d.C(3);break}Ba(d,4);return v(d,b.h.setMediaKeys(null),6);case 6:Fa(d,5);break;case 4:Ga(d);case 5:b.h=null;case 3:b.a=null,b.u.clear(),b.i=null,b.w=[],b.f=null,b.g=null,b.D=null,w(d)}})})}m.configure=function(b){this.f=b};function Vc(b,c,d){b.w=[];b.G=d;return Wc(b,c)}
function Xc(b,c,d){b.w=d;b.G=0<d.length;return Wc(b,c)}function Yc(b,c,d,e,f,g){var h=new Map;h.set(c,{audioCapabilities:f,videoCapabilities:g,distinctiveIdentifier:"optional",persistentState:"required",sessionTypes:["persistent-license"],label:c,drmInfos:[{keySystem:c,licenseServerUri:d,distinctiveIdentifierRequired:!1,persistentStateRequired:!0,audioRobustness:"",videoRobustness:"",serverCertificate:e,initData:null,keyIds:null}]});return Zc(b,h)}
function Wc(b,c){var d=$c(b);if(d)for(var e=t(c),f=e.next();!f.done;f=e.next())f.value.drmInfos=[d];d=c.some(function(b){return 0<b.drmInfos.length});d||(f=Bc(b.f.servers),ad(c,f));e=t(c);for(f=e.next();!f.done;f=e.next()){f=t(f.value.drmInfos);for(var g=f.next();!g.done;g=f.next())bd(g.value,Bc(b.f.servers),Bc(b.f.advanced||{}))}f=cd(b,c);if(!f.size)return b.V=!0,Promise.resolve();f=Zc(b,f);return d?f:f["catch"](function(){})}
m.Qb=function(b){var c=this;if(!this.i)return this.l.ua(b,"encrypted",function(){c.g(new D(2,6,6010))}),Promise.resolve();this.h=b;this.l.ua(this.h,"play",function(){for(var b=0;b<c.H.length;b++)dd(c,c.H[b]);c.ra=!0;c.H=[]});"webkitCurrentPlaybackTargetIsWireless"in this.h&&this.l.B(this.h,"webkitcurrentplaybacktargetiswirelesschanged",function(){return Uc(c)});b=this.h.setMediaKeys(this.i);b=b["catch"](function(b){return Promise.reject(new D(2,6,6003,b.message))});var d=ed(this);return Promise.all([b,
d]).then(function(){if(c.c)return Promise.reject();fd(c);c.a.initData.length||c.w.length||c.l.B(c.h,"encrypted",function(b){return gd(c,b.initDataType,new Uint8Array(b.initData))})})["catch"](function(b){if(!c.c)return Promise.reject(b)})};
function ed(b){return u(function d(){var e,f;return x(d,function(d){switch(d.j){case 1:if(!(b.i&&b.a&&b.a.serverCertificate&&b.a.serverCertificate.length)){d.C(0);break}Ba(d,3);return v(d,b.i.setServerCertificate(b.a.serverCertificate),5);case 5:(e=d.s)||B.m("Server certificates are not supported by the key system.  The server certificate has been ignored.");Fa(d,0);break;case 3:return f=Ga(d),d["return"](Promise.reject(new D(2,6,6004,f.message)))}})})}
function hd(b,c){return u(function e(){var f,g,h;return x(e,function(e){switch(e.j){case 1:return v(e,id(b,c),2);case 2:f=e.s;if(!f)return B.J("Ignoring attempt to remove missing session",c),e["return"]();g=[];if(h=b.b.get(f))h.Ca=new E,g.push(h.Ca);B.J("Attempting to remove session",c);g.push(f.remove());return v(e,Promise.all(g),0)}})})}
function fd(b){var c=b.a?b.a.initData:[];c.forEach(function(c){return gd(b,c.initDataType,c.initData)});b.w.forEach(function(c){return id(b,c)});c.length||b.w.length||b.o.resolve();return b.o}function gd(b,c,d){var e=b.b.values();e=t(e);for(var f=e.next();!f.done;f=e.next())if(G.Da(d,f.value.initData)&&!Lc("Tizen 2")){B.debug("Ignoring duplicate init data.");return}jd(b,c,d)}function kd(b){return b?b.keySystem:""}
function ld(b,c){if(navigator.userAgent.match(/Edge\//))return!0;c=c.toLowerCase();if(Kc()&&c.includes('codecs="ac-3"')){var d=c.replace("ac-3","ec-3");return b.u.has(c)||b.u.has(d)}return b.u.has(c)}function md(b){b=b.b.keys();b=zc(b,function(b){return b.sessionId});return Array.from(b)}m.Tb=function(){var b=Infinity,c=this.b.keys();c=t(c);for(var d=c.next();!d.done;d=c.next())d=d.value,isNaN(d.expiration)||(b=Math.min(b,d.expiration));return b};
function cd(b,c){for(var d=new Set,e=t(c),f=e.next();!f.done;f=e.next()){var g=t(f.value.drmInfos);for(f=g.next();!f.done;f=g.next())d.add(f.value)}e=t(d);for(f=e.next();!f.done;f=e.next())bd(f.value,Bc(b.f.servers),Bc(b.f.advanced||{}));g=b.G?"required":"optional";var h=b.G?["persistent-license"]:["temporary"];e=new Map;d=t(d);for(f=d.next();!f.done;f=d.next())f=f.value,e.set(f.keySystem,{audioCapabilities:[],videoCapabilities:[],distinctiveIdentifier:"optional",persistentState:g,sessionTypes:h,
label:f.keySystem,drmInfos:[]});d=t(c);for(f=d.next();!f.done;f=d.next()){f=f.value;g=f.audio;h=f.video;var k=g?nd(g):"",l=h?nd(h):"",n=t(f.drmInfos);for(f=n.next();!f.done;f=n.next()){f=f.value;var p=e.get(f.keySystem);p.drmInfos.push(f);f.distinctiveIdentifierRequired&&(p.distinctiveIdentifier="required");f.persistentStateRequired&&(p.persistentState="required");g&&(p.audioCapabilities.push({robustness:f.audioRobustness||"",contentType:k}),"ac-3"==g.codecs.toLowerCase()&&Kc()&&p.audioCapabilities.push({robustness:f.audioRobustness||
"",contentType:Dc(g.mimeType,"ec-3")}));h&&p.videoCapabilities.push({robustness:f.videoRobustness||"",contentType:l})}}return e}function nd(b){var c=Dc(b.mimeType,b.codecs);return Ob(c)?Pb(b.type,c):c}
function Zc(b,c){if(1==c.size&&c.has(""))return Promise.reject(new D(2,6,6E3));for(var d=t(c.values()),e=d.next();!e.done;e=d.next())e=e.value,0==e.audioCapabilities.length&&delete e.audioCapabilities,0==e.videoCapabilities.length&&delete e.videoCapabilities;var f=d=new E;[!0,!1].forEach(function(b){var d=this;c.forEach(function(c,e){c.drmInfos.some(function(b){return!!b.licenseServerUri})==b&&(f=f["catch"](function(){if(!this.c)return navigator.requestMediaKeySystemAccess(e,[c])}.bind(d)))})}.bind(b));
f=f["catch"](function(){return Promise.reject(new D(2,6,6001))});f=f.then(function(b){if(this.c)return Promise.reject();this.u.clear();var d=b.getConfiguration(),e=d.videoCapabilities||[],f=t(d.audioCapabilities||[]);for(d=f.next();!d.done;d=f.next())this.u.add(d.value.contentType.toLowerCase());e=t(e);for(d=e.next();!d.done;d=e.next())this.u.add(d.value.contentType.toLowerCase());e=b.keySystem;d=c.get(b.keySystem);f=[];var g=[],p=[],q=[];od(d.drmInfos,f,g,p,q);1<g.length&&B.m("Multiple unique server certificates found! Only the first will be used.");
1<f.length&&B.m("Multiple unique license server URIs found! Only the first will be used.");this.a={keySystem:e,licenseServerUri:f[0],distinctiveIdentifierRequired:"required"==d.distinctiveIdentifier,persistentStateRequired:"required"==d.persistentState,audioRobustness:(d.audioCapabilities?d.audioCapabilities[0].robustness:"")||"",videoRobustness:(d.videoCapabilities?d.videoCapabilities[0].robustness:"")||"",serverCertificate:g[0],initData:p,keyIds:q};return this.a.licenseServerUri?b.createMediaKeys():
Promise.reject(new D(2,6,6012,this.a.keySystem))}.bind(b)).then(function(b){if(this.c)return Promise.reject();B.info("Created MediaKeys object for key system",this.a.keySystem);this.i=b;this.V=!0}.bind(b))["catch"](function(b){if(!this.c)return this.a=null,this.u.clear(),b instanceof D?Promise.reject(b):Promise.reject(new D(2,6,6002,b.message))}.bind(b));d.reject();return f}
function $c(b){b=Bc(b.f.clearKeys);if(0==b.size)return null;var c=[],d=[];b.forEach(function(b,e){var f=G.Yc(e),g=G.Yc(b);f={kty:"oct",kid:G.Hc(f,!1),k:G.Hc(g,!1)};c.push(f);d.push(f.kid)});b=JSON.stringify({keys:c});var e=JSON.stringify({kids:d});e=[{initData:new Uint8Array(Kb(e)),initDataType:"keyids"}];return{keySystem:"org.w3.clearkey",licenseServerUri:"data:application/json;base64,"+window.btoa(b),distinctiveIdentifierRequired:!1,persistentStateRequired:!1,audioRobustness:"",videoRobustness:"",
serverCertificate:null,initData:e,keyIds:[]}}
function id(b,c){try{B.F("Attempting to load an offline session",c);var d=b.i.createSession("persistent-license")}catch(g){var e=new D(2,6,6005,g.message);b.g(e);return Promise.reject(e)}b.l.B(d,"message",b.te.bind(b));b.l.B(d,"keystatuseschange",b.re.bind(b));var f={initData:null,loaded:!1,rd:Infinity,Ca:null};b.b.set(d,f);return d.load(c).then(function(b){if(this.c)return Promise.reject();B.J("Loaded offline session",c,b);if(b)return f.loaded=!0,pd(this)&&this.o.resolve(),d;this.b["delete"](d);
this.g(new D(2,6,6013))}.bind(b),function(b){this.c||(this.b["delete"](d),this.g(new D(2,6,6005,b.message)))}.bind(b))}
function jd(b,c,d){try{if(b.G){B.F("Creating new persistent session");var e=b.i.createSession("persistent-license")}else B.F("Creating new temporary session"),e=b.i.createSession()}catch(f){b.g(new D(2,6,6005,f.message));return}b.l.B(e,"message",b.te.bind(b));b.l.B(e,"keystatuseschange",b.re.bind(b));b.b.set(e,{initData:d,loaded:!1,rd:Infinity,Ca:null});try{d=b.f.initDataTransform(d,b.a)}catch(f){c=f;f instanceof D||(c=new D(2,6,6016,f));b.g(c);return}e.generateRequest(c,d)["catch"](function(c){if(!b.c){b.b["delete"](e);
if(c.errorCode&&c.errorCode.systemCode){var d=c.errorCode.systemCode;0>d&&(d+=Math.pow(2,32));d="0x"+d.toString(16)}b.g(new D(2,6,6006,c.message,c,d))}})}function qd(b,c){if(kd(c).startsWith("com.apple.fps")){var d=c.serverCertificate,e=xc(b);b=yc(b,e,d)}return b}m.te=function(b){this.h&&this.f.delayLicenseRequestUntilPlayed&&this.h.paused&&!this.ra?this.H.push(b):dd(this,b)};
function dd(b,c){var d=c.target;B.F("Sending license request for session",d.sessionId,"of type",c.messageType);var e=b.b.get(d),f=b.a.licenseServerUri,g=b.f.advanced[b.a.keySystem];"individualization-request"==c.messageType&&g&&g.individualizationServer&&(f=g.individualizationServer);f=mc([f],b.f.retryParameters);f.body=c.message;f.method="POST";f.licenseRequestType=c.messageType;f.sessionId=d.sessionId;"com.microsoft.playready"!=b.a.keySystem&&"com.chromecast.playready"!=b.a.keySystem||rd(f);b.a.keySystem.startsWith("com.apple.fps")&&
b.f.fairPlayTransform&&sd(f);var h=Date.now();b.D.Db.request(2,f).promise.then(function(b){if(this.c)return Promise.reject();this.a.keySystem.startsWith("com.apple.fps")&&this.f.fairPlayTransform&&td(b);this.K+=(Date.now()-h)/1E3;B.F("Updating session",d.sessionId);return d.update(b.data).then(function(){var b=this;this.D.onEvent(new K("drmsessionupdate"));e&&(e.Ca&&e.Ca.resolve(),(new I(function(){e.loaded=!0;pd(b)&&b.o.resolve()})).R(ud))}.bind(this))}.bind(b),function(b){this.c||(b=new D(2,6,6007,
b),this.g(b),e&&e.Ca&&e.Ca.reject(b))}.bind(b))["catch"](function(b){this.c||(b=new D(2,6,6008,b.message),this.g(b),e&&e.Ca&&e.Ca.reject(b))}.bind(b))}
function rd(b){var c=Ib(b.body,!0,!0);if(c.includes("PlayReadyKeyMessage")){B.debug("Unwrapping PlayReady request.");c=(new DOMParser).parseFromString(c,"application/xml");for(var d=c.getElementsByTagName("HttpHeader"),e=0;e<d.length;++e)b.headers[d[e].getElementsByTagName("name")[0].textContent]=d[e].getElementsByTagName("value")[0].textContent;b.body=G.Fa(c.getElementsByTagName("Challenge")[0].textContent).buffer}else B.debug("PlayReady request is already unwrapped."),b.headers["Content-Type"]=
"text/xml; charset=utf-8"}function sd(b){var c=new Uint8Array(b.body);c="spc="+G.Hc(c);b.headers["Content-Type"]="application/x-www-form-urlencoded";b.body=Kb(c)}function td(b){try{var c=Gb(b.data)}catch(d){return}c=c.trim();"<ckc>"===c.substr(0,5)&&"</ckc>"===c.substr(-6)&&(c=c.slice(5,-6));try{c=JSON.parse(c).ckc}catch(d){}b.data=G.Fa(c).buffer}
m.re=function(b){b=b.target;B.J("Key status changed for session",b.sessionId);var c=this.b.get(b),d=!1;b.keyStatuses.forEach(function(b,e){if("string"==typeof e){var f=e;e=b;b=f}if("com.microsoft.playready"==this.a.keySystem&&16==e.byteLength&&(Lc("Trident/")||navigator.userAgent.match(/Edge?\//))){f=new DataView(e);var g=f.getUint32(0,!0),l=f.getUint16(4,!0),n=f.getUint16(6,!0);f.setUint32(0,g,!1);f.setUint16(4,l,!1);f.setUint16(6,n,!1)}"com.microsoft.playready"==this.a.keySystem&&"status-pending"==
b&&(b="usable");"status-pending"!=b&&(c.loaded=!0);"expired"==b&&(d=!0);f=G.Ic(new Uint8Array(e));this.sa.set(f,b)}.bind(this));var e=b.expiration-Date.now();(0>e||d&&1E3>e)&&c&&!c.Ca&&(B.debug("Session has expired",b.sessionId),this.b["delete"](b),b.close()["catch"](function(){}));pd(this)&&(this.o.resolve(),this.T.R(vd))};
function Rc(b){var c=b.sa,d=b.$;d.clear();c.forEach(function(b,c){return d.set(c,b)});c=Array.from(d.values());c.length&&c.every(function(b){return"expired"==b})&&b.g(new D(2,6,6014));b.D.yc(Cc(d))}
function wd(){function b(b){return u(function h(){var c,f,n;return x(h,function(h){switch(h.j){case 1:return Ba(h,2),v(h,navigator.requestMediaKeySystemAccess(b,d),4);case 4:return c=h.s,n=(f=c.getConfiguration().sessionTypes)?f.includes("persistent-license"):!1,Lc("Tizen 3")&&(n=!1),e.set(b,{persistentState:n}),v(h,c.createMediaKeys(),5);case 5:Fa(h,0);break;case 2:Ga(h),e.set(b,null),w(h)}})})}var c=[{contentType:'video/mp4; codecs="avc1.42E01E"'},{contentType:'video/webm; codecs="vp8"'}],d=[{videoCapabilities:c,
persistentState:"required",sessionTypes:["persistent-license"]},{videoCapabilities:c}],e=new Map;c="org.w3.clearkey com.widevine.alpha com.microsoft.playready com.apple.fps.3_0 com.apple.fps.2_0 com.apple.fps.1_0 com.apple.fps com.adobe.primetime".split(" ").map(function(c){return b(c)});return Promise.all(c).then(function(){return Cc(e)})}
function xd(b,c){var d=c.audio,e=c.video;if(d&&d.encrypted&&(d=nd(d),!ld(b,d))||e&&e.encrypted&&(e=nd(e),!ld(b,e)))return!1;var f=kd(b.a);return 0==c.drmInfos.length||c.drmInfos.some(function(b){return b.keySystem==f})}
function yd(b,c){if(!b.length)return c;if(!c.length)return b;for(var d=[],e=0;e<b.length;e++)for(var f=0;f<c.length;f++)if(b[e].keySystem==c[f].keySystem){var g=b[e];f=c[f];var h=[];h=h.concat(g.initData||[]);h=h.concat(f.initData||[]);var k=[];k=k.concat(g.keyIds);k=k.concat(f.keyIds);d.push({keySystem:g.keySystem,licenseServerUri:g.licenseServerUri||f.licenseServerUri,distinctiveIdentifierRequired:g.distinctiveIdentifierRequired||f.distinctiveIdentifierRequired,persistentStateRequired:g.persistentStateRequired||
f.persistentStateRequired,videoRobustness:g.videoRobustness||f.videoRobustness,audioRobustness:g.audioRobustness||f.audioRobustness,serverCertificate:g.serverCertificate||f.serverCertificate,initData:h,keyIds:k});break}return d}
function zd(b){return u(function d(){var e;return x(d,function(d){switch(d.j){case 1:return e=new Promise(function(b,d){(new I(d)).R(Ad)}),Ba(d,2),v(d,Promise.race([Promise.all([b.close(),b.closed]),e]),4);case 4:Fa(d,0);break;case 2:Ga(d),B.m("Timeout waiting for session close"),w(d)}})})}
function Uc(b){return u(function d(){var e;return x(d,function(d){switch(d.j){case 1:return e=Array.from(b.b.keys()),b.b.clear(),v(d,Promise.all(e.map(function(b){return u(function k(){return x(k,function(d){switch(d.j){case 1:return B.F("Closing session",b.sessionId),Ba(d,2),v(d,zd(b),4);case 4:Fa(d,0);break;case 2:Ga(d),w(d)}})})})),0)}})})}function Sc(b){b.b.forEach(function(c,d){var e=c.rd,f=d.expiration;isNaN(f)&&(f=Infinity);f!=e&&(b.D.onExpirationUpdated(d.sessionId,f),c.rd=f)})}
function pd(b){b=b.b.values();return Ac(b,function(b){return b.loaded})}function ad(b,c){var d=[];c.forEach(function(b,c){d.push({keySystem:c,licenseServerUri:b,distinctiveIdentifierRequired:!1,persistentStateRequired:!1,audioRobustness:"",videoRobustness:"",serverCertificate:null,initData:[],keyIds:[]})});for(var e=t(b),f=e.next();!f.done;f=e.next())f.value.drmInfos=d}
function od(b,c,d,e,f){b.forEach(function(b){c.includes(b.licenseServerUri)||c.push(b.licenseServerUri);b.serverCertificate&&(d.some(function(c){return G.Da(c,b.serverCertificate)})||d.push(b.serverCertificate));b.initData&&b.initData.forEach(function(b){e.some(function(c){return c.keyId&&c.keyId==b.keyId?!0:c.initDataType==b.initDataType&&G.Da(c.initData,b.initData)})||e.push(b)});if(b.keyIds)for(var g=0;g<b.keyIds.length;++g)f.includes(b.keyIds[g])||f.push(b.keyIds[g])})}
function bd(b,c,d){if(b.keySystem&&("org.w3.clearkey"!=b.keySystem||!b.licenseServerUri)){c.size&&(c=c.get(b.keySystem)||"",b.licenseServerUri=c);b.keyIds||(b.keyIds=[]);if(d=d.get(b.keySystem))b.distinctiveIdentifierRequired||(b.distinctiveIdentifierRequired=d.distinctiveIdentifierRequired),b.persistentStateRequired||(b.persistentStateRequired=d.persistentStateRequired),b.videoRobustness||(b.videoRobustness=d.videoRobustness),b.audioRobustness||(b.audioRobustness=d.audioRobustness),b.serverCertificate||
(b.serverCertificate=d.serverCertificate);window.cast&&window.cast.__platform__&&"com.microsoft.playready"==b.keySystem&&(b.keySystem="com.chromecast.playready")}}var Ad=1,ud=5,vd=.5;function Bd(){this.a=new muxjs.mp4.CaptionParser;this.g=[];this.f={}}Bd.prototype.init=function(b){var c=muxjs.mp4.probe;b=new Uint8Array(b);this.g=c.videoTrackIds(b);this.f=c.timescale(b);this.a.init()};Bd.prototype.b=function(b,c){var d=new Uint8Array(b);(d=this.a.parse(d,this.g,this.f))&&d.captions&&c(d.captions);this.a.clearParsedCaptions()};Bd.prototype.c=function(){this.a.resetCaptionStream()};function Cd(){}Cd.prototype.init=function(){};Cd.prototype.b=function(){};Cd.prototype.c=function(){};function Dd(b){return!b||1==b.length&&1E-6>b.end(0)-b.start(0)?null:b.length?b.end(b.length-1):null}function Ed(b,c,d){d=void 0===d?0:d;return!b||!b.length||1==b.length&&1E-6>b.end(0)-b.start(0)||c>b.end(b.length-1)?!1:c+d>=b.start(0)}function Fd(b,c){if(!b||!b.length||1==b.length&&1E-6>b.end(0)-b.start(0))return 0;for(var d=0,e=b.length-1;0<=e&&b.end(e)>c;--e)d+=b.end(e)-Math.max(b.start(e),c);return d}
function Gd(b){if(!b)return[];for(var c=[],d=0;d<b.length;d++)c.push({start:b.start(d),end:b.end(d)});return c};function Hd(b,c,d){this.startTime=b;this.direction=Id;this.endTime=c;this.payload=d;this.region=new Jd;this.position=null;this.positionAlign=Kd;this.size=0;this.textAlign=Md;this.writingMode=Nd;this.lineInterpretation=Od;this.line=null;this.lineHeight="";this.lineAlign=Pd;this.displayAlign=Qd;this.fontSize=this.backgroundImage=this.backgroundColor=this.color="";this.fontWeight=Rd;this.fontStyle=Sd;this.fontFamily="";this.textDecoration=[];this.wrapLine=!0;this.id="";this.nestedCues=[];this.spacer=
!1}A("shaka.text.Cue",Hd);Hd.prototype.clone=function(){var b=new Hd(0,0,""),c;for(c in this)b[c]=this[c],b[c]&&b[c].constructor==Array&&(b[c]=b[c].slice());return b};var Kd="auto";Hd.positionAlign={LEFT:"line-left",RIGHT:"line-right",CENTER:"center",AUTO:Kd};var Md="center",Td={LEFT:"left",RIGHT:"right",CENTER:Md,START:"start",END:"end"};Hd.textAlign=Td;var Qd="after",Ud={BEFORE:"before",CENTER:"center",AFTER:Qd};Hd.displayAlign=Ud;var Id="ltr";Hd.direction={HORIZONTAL_LEFT_TO_RIGHT:Id,HORIZONTAL_RIGHT_TO_LEFT:"rtl"};
var Nd="horizontal-tb";Hd.writingMode={HORIZONTAL_TOP_TO_BOTTOM:Nd,VERTICAL_LEFT_TO_RIGHT:"vertical-lr",VERTICAL_RIGHT_TO_LEFT:"vertical-rl"};var Od=0;Hd.lineInterpretation={LINE_NUMBER:Od,PERCENTAGE:1};var Pd="start",Vd={CENTER:"center",START:Pd,END:"end"};Hd.lineAlign=Vd;var Rd=400;Hd.fontWeight={NORMAL:Rd,BOLD:700};var Sd="normal",Wd={NORMAL:Sd,ITALIC:"italic",OBLIQUE:"oblique"};Hd.fontStyle=Wd;Hd.textDecoration={UNDERLINE:"underline",LINE_THROUGH:"lineThrough",OVERLINE:"overline"};
function Jd(){this.id="";this.regionAnchorY=this.regionAnchorX=this.viewportAnchorY=this.viewportAnchorX=0;this.height=this.width=100;this.viewportAnchorUnits=this.widthUnits=this.heightUnits=Xd;this.scroll=Yd}A("shaka.text.CueRegion",Jd);var Xd=1;Jd.units={PX:0,PERCENTAGE:Xd,LINES:2};var Yd="";Jd.scrollMode={NONE:Yd,UP:"up"};function Zd(b){this.g=null;this.c=b;this.f=this.o=0;this.h=Infinity;this.b=this.a=null;this.l="";this.i=new Map}var $d={};A("shaka.text.TextEngine.registerParser",function(b,c){$d[b]=c});A("shaka.text.TextEngine.unregisterParser",function(b){delete $d[b]});function ae(b){return $d[b]||window.muxjs&&"application/cea-608"==b?!0:!1}Zd.prototype.destroy=function(){this.c=this.g=null;this.i.clear();return Promise.resolve()};function be(b,c){"application/cea-608"!=c&&(b.g=new $d[c])}
Zd.prototype.sc=function(b){var c={periodStart:0,segmentStart:null,segmentEnd:0};try{return this.g.parseMedia(new Uint8Array(b),c)[0].startTime}catch(d){throw new D(2,2,2009,d);}};
function ce(b,c,d,e){return Promise.resolve().then(function(){if(this.g&&this.c)if(null==d||null==e)this.g.parseInit(new Uint8Array(c));else{var b={periodStart:this.o,segmentStart:d,segmentEnd:e};b=this.g.parseMedia(new Uint8Array(c),b).filter(function(b){return b.startTime>=this.f&&b.startTime<this.h}.bind(this));this.c.append(b);null==this.a&&(this.a=Math.max(d,this.f));this.b=Math.min(e,this.h)}}.bind(b))}
Zd.prototype.remove=function(b,c){return Promise.resolve().then(function(){!this.c||!this.c.remove(b,c)||null==this.a||c<=this.a||b>=this.b||(b<=this.a&&c>=this.b?this.a=this.b=null:b<=this.a&&c<this.b?this.a=c:b>this.a&&c>=this.b&&(this.b=b))}.bind(this))};function de(b,c,d){b.l=c;if(c=b.i.get(c))for(var e=t(c.keys()),f=e.next();!f.done;f=e.next())(f=c.get(f.value).filter(function(b){return b.endTime<=d}))&&b.c.append(f)}
function ee(b,c,d,e,f){var g=d+" "+e,h=new Map;c=t(c);for(var k=c.next();!k.done;k=c.next()){var l=k.value;k=l.stream;h.has(k)||h.set(k,new Map);h.get(k).has(g)||h.get(k).set(g,[]);l.startTime+=f;l.endTime+=f;l.startTime>=b.f&&l.startTime<b.h&&(l=new Hd(l.startTime,l.endTime,l.text),h.get(k).get(g).push(l),k==b.l&&b.c.append([l]))}f=t(h.keys());for(g=f.next();!g.done;g=f.next())for(g=g.value,b.i.has(g)||b.i.set(g,new Map),c=t(h.get(g).keys()),k=c.next();!k.done;k=c.next())k=k.value,l=h.get(g).get(k),
b.i.get(g).set(k,l);b.a=null==b.a?Math.max(d,b.f):Math.min(b.a,Math.max(d,b.f));b.b=Math.max(b.b,Math.min(e,b.h))};function fe(b,c,d){this.f=b;this.g=d;this.b={};this.a=null;this.c={};this.i=new M;this.w=!1;this.l={};this.o=c;this.u=new E;this.h=ge(this,this.u);this.D=""}var he=window.URL.createObjectURL;function ge(b,c){var d=new MediaSource;b.i.ua(d,"sourceopen",function(){URL.revokeObjectURL(b.D);c.resolve()});b.D=he(d);b.f.src=b.D;return d}function ie(b){var c=Dc(b.mimeType,b.codecs),d=Ec(b);return ae(c)||MediaSource.isTypeSupported(d)||Ob(c,b.type)}m=fe.prototype;
m.destroy=function(){var b=this;this.w=!0;var c=[],d;for(d in this.c){var e=this.c[d],f=e[0];this.c[d]=e.slice(0,1);f&&c.push(f.p["catch"](xb.wc));for(f=1;f<e.length;++f)e[f].p.reject()}this.a&&c.push(this.a.destroy());this.g&&c.push(this.g.destroy());for(var g in this.l)c.push(this.l[g].destroy());return Promise.all(c).then(function(){b.i&&(b.i.release(),b.i=null);b.f&&(b.f.removeAttribute("src"),b.f.load(),b.f=null);b.h=null;b.a=null;b.g=null;b.b={};b.l={};b.o=null;b.c={}})};
m.init=function(b,c){var d=this;return u(function f(){var g;return x(f,function(f){switch(f.j){case 1:return g=Ab,v(f,d.u,2);case 2:b.forEach(function(b,f){var h=Dc(b.mimeType,b.codecs);f==g.va?je(d,h):(!c&&MediaSource.isTypeSupported(h)||!Ob(h,f)||(d.l[f]=new Nb,h=Pb(f,h)),h=d.h.addSourceBuffer(h),d.i.B(h,"error",d.zg.bind(d,f)),d.i.B(h,"updateend",d.Gb.bind(d,f)),d.b[f]=h,d.c[f]=[])}),w(f)}})})};function je(b,c){b.a||(b.a=new Zd(b.g));be(b.a,c)}
function ke(b){return b.h?"ended"==b.h.readyState:!0}function le(b,c){if("text"==c)var d=b.a.a;else d=me(b,c),d=!d||1==d.length&&1E-6>d.end(0)-d.start(0)?null:1==d.length&&0>d.start(0)?0:d.length?d.start(0):null;return d}function ne(b,c){return"text"==c?b.a.b:Dd(me(b,c))}function oe(b,c,d){if("text"==c)return b=b.a,null==b.b||b.b<d?0:b.b-Math.max(d,b.a);b=me(b,c);return Fd(b,d)}
m.$c=function(b){b.total=Gd(this.f.buffered);b.audio=Gd(me(this,"audio"));b.video=Gd(me(this,"video"));b.text=[];if(this.a){var c=this.a.a,d=this.a.b;null!=c&&null!=d&&b.text.push({start:c,end:d})}};function me(b,c){try{return b.b[c].buffered}catch(d){return c in b.b&&B.error("failed to get buffered range for "+c,d),null}}
function pe(b,c,d,e,f,g){if("text"==c)return ce(b.a,d,e,f);if(b.l[c])return Qb(b.l[c],d).then(function(b){this.a||je(this,"text/vtt");b.captions&&b.captions.length&&ee(this.a,b.captions,e,f,this.b.video.timestampOffset);return qe(this,c,this.Ge.bind(this,c,b.data.buffer))}.bind(b));g&&window.muxjs&&(b.a||je(b,"text/vtt"),null==e&&null==f?b.o.init(d):b.o.b(d,function(c){c.length&&ee(b.a,c,e,f,b.b.video.timestampOffset)}));return qe(b,c,b.Ge.bind(b,c,d))}
function re(b,c){var d=ne(b,"video")||0;de(b.a,c,d)}m.remove=function(b,c,d){return"text"==b?this.a.remove(c,d):qe(this,b,this.He.bind(this,b,c,d))};function se(b,c){if("text"==c){if(!b.a)return Promise.resolve();b.o.c();return b.a.remove(0,Infinity)}return qe(b,c,b.He.bind(b,c,0,b.h.duration))}m.flush=function(b){return"text"==b?Promise.resolve():qe(this,b,this.ff.bind(this,b))};
function te(b,c,d,e,f){return"text"==c?(b.a.o=d,b=b.a,b.f=e,b.h=f,Promise.resolve()):Promise.all([qe(b,c,b.Qe.bind(b,c)),qe(b,c,b.yg.bind(b,c,d)),qe(b,c,b.vg.bind(b,c,e,f))])}m.endOfStream=function(b){return ue(this,function(){ke(this)||(b?this.h.endOfStream(b):this.h.endOfStream())}.bind(this))};m.Ba=function(b){return ue(this,function(){this.h.duration=b}.bind(this))};m.ca=function(){return this.h.duration};m.Ge=function(b,c){this.b[b].appendBuffer(c)};
m.He=function(b,c,d){d<=c?this.Gb(b):this.b[b].remove(c,d)};m.Qe=function(b){var c=this.b[b].appendWindowStart,d=this.b[b].appendWindowEnd;this.b[b].abort();this.b[b].appendWindowStart=c;this.b[b].appendWindowEnd=d;this.Gb(b)};m.ff=function(b){this.f.currentTime-=.001;this.Gb(b)};m.yg=function(b,c){0>c&&(c+=.001);this.b[b].timestampOffset=c;this.Gb(b)};m.vg=function(b,c,d){this.b[b].appendWindowStart=0;this.b[b].appendWindowEnd=d;this.b[b].appendWindowStart=c;this.Gb(b)};
m.zg=function(b){this.c[b][0].p.reject(new D(2,3,3014,this.f.error?this.f.error.code:0))};m.Gb=function(b){var c=this.c[b][0];c&&(c.p.resolve(),ve(this,b))};function qe(b,c,d){if(b.w)return Promise.reject();d={start:d,p:new E};b.c[c].push(d);if(1==b.c[c].length)try{d.start()}catch(e){"QuotaExceededError"==e.name?d.p.reject(new D(2,3,3017,c)):d.p.reject(new D(2,3,3015,e)),ve(b,c)}return d.p}
function ue(b,c){if(b.w)return Promise.reject();var d=[],e;for(e in b.b){var f=new E,g={start:function(b){b.resolve()}.bind(null,f),p:f};b.c[e].push(g);d.push(f);1==b.c[e].length&&g.start()}return Promise.all(d).then(function(){try{c()}catch(l){var b=Promise.reject(new D(2,3,3015,l))}for(var d in this.b)ve(this,d);return b}.bind(b),function(b){throw b;}.bind(b))}function ve(b,c){b.c[c].shift();var d=b.c[c][0];if(d)try{d.start()}catch(e){d.p.reject(new D(2,3,3015,e)),ve(b,c)}};function we(b,c){b=N(b);c=N(c);return b.split("-")[0]==c.split("-")[0]}function xe(b,c){b=N(b);c=N(c);var d=b.split("-"),e=c.split("-");return d[0]==e[0]&&1==d.length&&2==e.length}function N(b){var c=b.split("-");b=c[0]||"";c=c[1]||"";b=b.toLowerCase();b=ye.get(b)||b;return(c=c.toUpperCase())?b+"-"+c:b}function ze(b){return b.language?N(b.language):b.audio&&b.audio.language?N(b.audio.language):b.video&&b.video.language?N(b.video.language):"und"}
function Ae(b,c){for(var d=N(b),e=new Set,f=t(c),g=f.next();!g.done;g=f.next())e.add(N(g.value));f=t(e);for(g=f.next();!g.done;g=f.next())if(g=g.value,g==d)return g;f=t(e);for(g=f.next();!g.done;g=f.next())if(g=g.value,xe(g,d))return g;f=t(e);for(g=f.next();!g.done;g=f.next()){var h=g=g.value,k=d;h=N(h);k=N(k);h=h.split("-");k=k.split("-");if(2==h.length&&2==k.length&&h[0]==k[0])return g}e=t(e);for(g=e.next();!g.done;g=e.next())if(f=g.value,xe(d,f))return f;return null}
var ye=new Map([["aar","aa"],["abk","ab"],["afr","af"],["aka","ak"],["alb","sq"],["amh","am"],["ara","ar"],["arg","an"],["arm","hy"],["asm","as"],["ava","av"],["ave","ae"],["aym","ay"],["aze","az"],["bak","ba"],["bam","bm"],["baq","eu"],["bel","be"],["ben","bn"],["bih","bh"],["bis","bi"],["bod","bo"],["bos","bs"],["bre","br"],["bul","bg"],["bur","my"],["cat","ca"],["ces","cs"],["cha","ch"],["che","ce"],["chi","zh"],["chu","cu"],["chv","cv"],["cor","kw"],["cos","co"],["cre","cr"],["cym","cy"],["cze",
"cs"],["dan","da"],["deu","de"],["div","dv"],["dut","nl"],["dzo","dz"],["ell","el"],["eng","en"],["epo","eo"],["est","et"],["eus","eu"],["ewe","ee"],["fao","fo"],["fas","fa"],["fij","fj"],["fin","fi"],["fra","fr"],["fre","fr"],["fry","fy"],["ful","ff"],["geo","ka"],["ger","de"],["gla","gd"],["gle","ga"],["glg","gl"],["glv","gv"],["gre","el"],["grn","gn"],["guj","gu"],["hat","ht"],["hau","ha"],["heb","he"],["her","hz"],["hin","hi"],["hmo","ho"],["hrv","hr"],["hun","hu"],["hye","hy"],["ibo","ig"],["ice",
"is"],["ido","io"],["iii","ii"],["iku","iu"],["ile","ie"],["ina","ia"],["ind","id"],["ipk","ik"],["isl","is"],["ita","it"],["jav","jv"],["jpn","ja"],["kal","kl"],["kan","kn"],["kas","ks"],["kat","ka"],["kau","kr"],["kaz","kk"],["khm","km"],["kik","ki"],["kin","rw"],["kir","ky"],["kom","kv"],["kon","kg"],["kor","ko"],["kua","kj"],["kur","ku"],["lao","lo"],["lat","la"],["lav","lv"],["lim","li"],["lin","ln"],["lit","lt"],["ltz","lb"],["lub","lu"],["lug","lg"],["mac","mk"],["mah","mh"],["mal","ml"],["mao",
"mi"],["mar","mr"],["may","ms"],["mkd","mk"],["mlg","mg"],["mlt","mt"],["mon","mn"],["mri","mi"],["msa","ms"],["mya","my"],["nau","na"],["nav","nv"],["nbl","nr"],["nde","nd"],["ndo","ng"],["nep","ne"],["nld","nl"],["nno","nn"],["nob","nb"],["nor","no"],["nya","ny"],["oci","oc"],["oji","oj"],["ori","or"],["orm","om"],["oss","os"],["pan","pa"],["per","fa"],["pli","pi"],["pol","pl"],["por","pt"],["pus","ps"],["que","qu"],["roh","rm"],["ron","ro"],["rum","ro"],["run","rn"],["rus","ru"],["sag","sg"],["san",
"sa"],["sin","si"],["slk","sk"],["slo","sk"],["slv","sl"],["sme","se"],["smo","sm"],["sna","sn"],["snd","sd"],["som","so"],["sot","st"],["spa","es"],["sqi","sq"],["srd","sc"],["srp","sr"],["ssw","ss"],["sun","su"],["swa","sw"],["swe","sv"],["tah","ty"],["tam","ta"],["tat","tt"],["tel","te"],["tgk","tg"],["tgl","tl"],["tha","th"],["tib","bo"],["tir","ti"],["ton","to"],["tsn","tn"],["tso","ts"],["tuk","tk"],["tur","tr"],["twi","tw"],["uig","ug"],["ukr","uk"],["urd","ur"],["uzb","uz"],["ven","ve"],["vie",
"vi"],["vol","vo"],["wel","cy"],["wln","wa"],["wol","wo"],["xho","xh"],["yid","yi"],["yor","yo"],["zha","za"],["zho","zh"],["zul","zu"]]);var O={Vd:function(b,c){var d=b.periods.reduce(function(b,c){return b.concat(c.variants)},[]);d=O.$d(d,c);d=O.Gf(d);d=O.df(d);var e=O.ef(d);d=t(b.periods);for(var f=d.next();!f.done;f=d.next())f=f.value,f.variants=f.variants.filter(function(b){if(O.ce(b)==e)return!0;B.debug("Dropping Variant (better codec available)",b);return!1})},Gf:function(b){var c=new ac;b=t(b);for(var d=b.next();!d.done;d=b.next()){d=d.value;var e=O.ce(d);c.push(e,d)}return c},df:function(b){var c=0,d=new Map,e=b.size();b.forEach(function(b,
g){for(var f=t(g),k=f.next();!k.done;k=f.next()){k=k.value;var l=k.video;if(l&&l.width&&l.height){l=l.width*l.height*(l.frameRate||1);d.has(l)||d.set(l,new ac);var n=d.get(l);n.push(b,k);n.size()===e&&(c=Math.max(c,l))}}});return c?d.get(c):b},ef:function(b){var c="",d=Infinity;b.forEach(function(b,f){for(var e=0,h=0,k=t(f),l=k.next();!l.done;l=k.next())e+=l.value.bandwidth||0,++h;e/=h;B.debug("codecs",b,"avg bandwidth",e);e<d&&(c=b,d=e)});return c},ce:function(b){var c="";b.video&&(c=Gc(b.video.codecs)[0]);
var d="";b.audio&&(d=Gc(b.audio.codecs)[0]);return c+"-"+d},ld:function(b,c,d){function e(b,c,d){return b>=c&&b<=d}var f=b.video;return f&&f.width&&f.height&&(!e(f.width,c.minWidth,Math.min(c.maxWidth,d.width))||!e(f.height,c.minHeight,Math.min(c.maxHeight,d.height))||!e(f.width*f.height,c.minPixels,c.maxPixels))||b&&b.video&&b.video.frameRate&&!e(b.video.frameRate,c.minFrameRate,c.maxFrameRate)||!e(b.bandwidth,c.minBandwidth,c.maxBandwidth)?!1:!0},Sd:function(b,c,d){var e=!1;b.forEach(function(b){var f=
b.allowedByApplication;b.allowedByApplication=O.ld(b,c,d);f!=b.allowedByApplication&&(e=!0)});return e},filterNewPeriod:function(b,c,d,e){e.variants=e.variants.filter(function(e){if(b&&b.V&&!xd(b,e))return B.debug("Dropping variant - not compatible with key system",e),!1;var f=e.audio;e=e.video;return f&&!ie(f)?(B.debug("Dropping variant - audio not compatible with platform",O.yb(f)),!1):e&&!ie(e)?(B.debug("Dropping variant - video not compatible with platform",O.yb(e)),!1):f&&c&&!O.Td(f,c)?(B.debug("Droping variant - not compatible with active audio",
"active audio",O.yb(c),"variant.audio",O.yb(f)),!1):e&&d&&!O.Td(e,d)?(B.debug("Droping variant - not compatible with active video","active video",O.yb(d),"variant.video",O.yb(e)),!1):!0});e.textStreams=e.textStreams.filter(function(b){var c=ae(Dc(b.mimeType,b.codecs));c||B.debug("Dropping text stream. Is not supported by the platform.",b);return c})},Td:function(b,c){return b.mimeType!=c.mimeType||b.codecs.split(".")[0]!=c.codecs.split(".")[0]?!1:!0},Qd:function(b){var c=b.audio,d=b.video,e=c?c.codecs:
null,f=d?d.codecs:null,g=[];f&&g.push(f);e&&g.push(e);var h=[];d&&h.push(d.mimeType);c&&h.push(c.mimeType);h=h[0]||null;var k=[];c&&k.push(c.kind);d&&k.push(d.kind);k=k[0]||null;var l=new Set;c&&c.roles.forEach(function(b){return l.add(b)});d&&d.roles.forEach(function(b){return l.add(b)});b={id:b.id,active:!1,type:"variant",bandwidth:b.bandwidth,language:b.language,label:null,kind:k,width:null,height:null,frameRate:null,pixelAspectRatio:null,mimeType:h,codecs:g.join(", "),audioCodec:e,videoCodec:f,
primary:b.primary,roles:Array.from(l),audioRoles:null,videoId:null,audioId:null,channelsCount:null,audioSamplingRate:null,audioBandwidth:null,videoBandwidth:null,originalVideoId:null,originalAudioId:null,originalTextId:null};d&&(b.videoId=d.id,b.originalVideoId=d.originalId,b.width=d.width||null,b.height=d.height||null,b.frameRate=d.frameRate||null,b.pixelAspectRatio=d.pixelAspectRatio||null,b.videoBandwidth=d.bandwidth||null);c&&(b.audioId=c.id,b.originalAudioId=c.originalId,b.channelsCount=c.channelsCount,
b.audioSamplingRate=c.audioSamplingRate,b.audioBandwidth=c.bandwidth||null,b.label=c.label,b.audioRoles=c.roles);return b},Fc:function(b){return{id:b.id,active:!1,type:"text",bandwidth:0,language:b.language,label:b.label,kind:b.kind||null,width:null,height:null,frameRate:null,pixelAspectRatio:null,mimeType:b.mimeType,codecs:b.codecs||null,audioCodec:null,videoCodec:null,primary:b.primary,roles:b.roles,audioRoles:null,videoId:null,audioId:null,channelsCount:null,audioSamplingRate:null,audioBandwidth:null,
videoBandwidth:null,originalVideoId:null,originalAudioId:null,originalTextId:b.originalId}},ed:function(b){b.__shaka_id||(b.__shaka_id=O.Pf++);return b.__shaka_id},Pf:0,Jf:function(b){var c=O.fe(b);c.active="disabled"!=b.mode;c.type="text";c.originalTextId=b.id;"captions"==b.kind&&(c.mimeType="application/cea-608");b.kind&&(c.roles=[b.kind]);return c},ee:function(b){var c=O.fe(b);c.active=b.enabled;c.type="variant";c.originalAudioId=b.id;"main"==b.kind&&(c.primary=!0);b.kind&&(c.roles=[b.kind],c.audioRoles=
[b.kind]);return c},fe:function(b){return{id:O.ed(b),active:!1,type:"",bandwidth:0,language:N(b.language),label:b.label,kind:b.kind,width:null,height:null,frameRate:null,pixelAspectRatio:null,mimeType:null,codecs:null,audioCodec:null,videoCodec:null,primary:!1,roles:[],audioRoles:null,videoId:null,audioId:null,channelsCount:null,audioSamplingRate:null,audioBandwidth:null,videoBandwidth:null,originalVideoId:null,originalAudioId:null,originalTextId:null}},Bb:function(b){return b.allowedByApplication&&
b.allowedByKeySystem},wf:function(b){return b.filter(function(b){return O.Bb(b)})},$d:function(b,c){var d=b.filter(function(b){return b.audio&&b.audio.channelsCount}),e=new Map;d=t(d);for(var f=d.next();!f.done;f=d.next()){f=f.value;var g=f.audio.channelsCount;e.has(g)||e.set(g,[]);e.get(g).push(f)}d=Array.from(e.keys());if(0==d.length)return b;f=d.filter(function(b){return b<=c});return f.length?e.get(Math.max.apply(null,f)):e.get(Math.min.apply(null,d))},Sb:function(b,c,d){var e=b,f=b.filter(function(b){return b.primary});
f.length&&(e=f);var g=e.length?e[0].language:"";e=e.filter(function(b){return b.language==g});if(c){var h=Ae(N(c),b.map(function(b){return b.language}));h&&(e=b.filter(function(b){return N(b.language)==h}))}if(d){b=O.Zd(e,d);if(b.length)return b;B.m("No exact match for the text role could be found.")}else if(b=e.filter(function(b){return 0==b.roles.length}),b.length)return b;b=e.map(function(b){return b.roles}).reduce(xb.Oc,[]);return b.length?O.Zd(e,b[0]):e},Zd:function(b,c){return b.filter(function(b){return b.roles.includes(c)})},
de:function(b,c,d){for(var e=0;e<d.length;e++)if(d[e].audio==b&&d[e].video==c)return d[e];return null},Kf:function(b){return"audio"==b.type},Nf:function(b){return"video"==b.type},Ff:function(b){var c=[];b.audio&&c.push(b.audio);b.video&&c.push(b.video);return c},yb:function(b){return O.Kf(b)?"type=audio codecs="+b.codecs+" bandwidth="+b.bandwidth+" channelsCount="+b.channelsCount+" audioSamplingRate="+b.audioSamplingRate:O.Nf(b)?"type=video codecs="+b.codecs+" bandwidth="+b.bandwidth+" frameRate="+
b.frameRate+" width="+b.width+" height="+b.height:"unexpected stream type"}};function P(){this.h=null;this.c=!1;this.b=new fb;this.g=[];this.i=!1;this.a=this.f=null}A("shaka.abr.SimpleAbrManager",P);P.prototype.stop=function(){this.h=null;this.c=!1;this.g=[];this.f=null};P.prototype.stop=P.prototype.stop;P.prototype.init=function(b){this.h=b};P.prototype.init=P.prototype.init;
P.prototype.chooseVariant=function(){var b=Be(this.a.restrictions,this.g),c=this.b.getBandwidthEstimate(this.a.defaultBandwidthEstimate);this.g.length&&!b.length&&(B.m("No variants met the ABR restrictions. Choosing a variant by lowest bandwidth."),b=Be(null,this.g),b=[b[0]]);for(var d=b[0]||null,e=0;e<b.length;++e){var f=b[e],g=f.bandwidth/this.a.bandwidthDowngradeTarget,h=(b[e+1]||{bandwidth:Infinity}).bandwidth/this.a.bandwidthUpgradeTarget;B.J("Bandwidth ranges:",(f.bandwidth/1E6).toFixed(3),
(g/1E6).toFixed(3),(h/1E6).toFixed(3));c>=g&&c<=h&&(d=f)}this.f=Date.now();return d};P.prototype.chooseVariant=P.prototype.chooseVariant;P.prototype.enable=function(){this.c=!0};P.prototype.enable=P.prototype.enable;P.prototype.disable=function(){this.c=!1};P.prototype.disable=P.prototype.disable;
P.prototype.segmentDownloaded=function(b,c){B.J("Segment downloaded:","deltaTimeMs="+b,"numBytes="+c,"lastTimeChosenMs="+this.f,"enabled="+this.c);var d=this.b;if(!(16E3>c)){var e=8E3*c/b,f=b/1E3;d.a+=c;db(d.b,f,e);db(d.c,f,e)}if(null!=this.f&&this.c)a:{B.J("Suggesting Streams...");if(!this.i){if(!(128E3<=this.b.a)){B.J("Still waiting for a good estimate...");break a}this.i=!0}else if(Date.now()-this.f<1E3*this.a.switchInterval){B.J("Still within switch interval...");break a}d=this.chooseVariant();
e=this.b.getBandwidthEstimate(this.a.defaultBandwidthEstimate);B.debug("Calling switch_(), bandwidth="+Math.round(e/1E3)+" kbps");this.h(d)}};P.prototype.segmentDownloaded=P.prototype.segmentDownloaded;P.prototype.getBandwidthEstimate=function(){return this.b.getBandwidthEstimate(this.a.defaultBandwidthEstimate)};P.prototype.getBandwidthEstimate=P.prototype.getBandwidthEstimate;P.prototype.setVariants=function(b){this.g=b};P.prototype.setVariants=P.prototype.setVariants;
P.prototype.configure=function(b){this.a=b};P.prototype.configure=P.prototype.configure;function Be(b,c){b&&(c=c.filter(function(c){return O.ld(c,b,{width:Infinity,height:Infinity})}));return c.sort(function(b,c){return b.bandwidth-c.bandwidth})};function Ce(b,c){this.a=b;this.b=c}Ce.prototype.toString=function(){return"v"+this.a+"."+this.b};function De(b,c){var d=new Ce(2,6),e=Ee,f=e.a,g=d.b-f.b;(0<(d.a-f.a||g)?e.c:e.b)(e.a,d,b,c)}function Fe(b,c,d,e){B.Y([d,"has been deprecated and will be removed in",c,". We are currently at version",b,". Additional information:",e].join(" "))}function Ge(b,c,d,e){B.jc([d,"has been deprecated and has been removed in",c,". We are now at version",b,". Additional information:",e].join(""))}var Ee=null;var He="ended play playing pause pausing ratechange seeked seeking timeupdate volumechange".split(" "),Ie="buffered currentTime duration ended loop muted paused playbackRate seeking videoHeight videoWidth volume".split(" "),Je=["loop","playbackRate"],Ke=["pause","play"],Le="abrstatuschanged adaptation buffering drmsessionupdate emsg error expirationupdated largegap loading manifestparsed onstatechange onstateidle streaming textchanged texttrackvisibility timelineregionadded timelineregionenter timelineregionexit trackschanged unloading variantchanged".split(" "),
Me={getAssetUri:2,getAudioLanguages:4,getAudioLanguagesAndRoles:4,getBufferedInfo:2,getConfiguration:2,getExpiration:2,getPlaybackRate:2,getTextLanguages:4,getTextLanguagesAndRoles:4,getTextTracks:2,getStats:5,getVariantTracks:2,isAudioOnly:10,isBuffering:1,isInProgress:1,isLive:10,isTextTrackVisible:1,keySystem:10,seekRange:1,usingEmbeddedTextTrack:2,getLoadMode:10},Ne={getPlayheadTimeAsDate:1,getPresentationStartTimeAsDate:20},Oe=[["getConfiguration","configure"]],Pe=[["isTextTrackVisible","setTextTrackVisibility"]],
Qe="addTextTrack cancelTrickPlay configure resetConfiguration retryStreaming selectAudioLanguage selectEmbeddedTextTrack selectTextLanguage selectTextTrack selectVariantTrack selectVariantsByLabel setTextTrackVisibility trickPlay".split(" "),Re=["attach","detach","load","unload"];
function Se(b){return JSON.stringify(b,function(b,d){if("function"!=typeof d){if(d instanceof Event||d instanceof K){var c={};for(g in d){var f=d[g];f&&"object"==typeof f?"detail"==g&&(c[g]=f):g in Event||(c[g]=f)}return c}if(d instanceof Error){var g=new Set(["name","message","stack"]);for(c in d)g.add(c);f=t(Object.getOwnPropertyNames(d));for(c=f.next();!c.done;c=f.next())g.add(c.value);f={};g=t(g);for(c=g.next();!c.done;c=g.next())c=c.value,f[c]=d[c];g={__type__:"Error",contents:f}}else if(d instanceof
TimeRanges)for(g={__type__:"TimeRanges",length:d.length,start:[],end:[]},c=0;c<d.length;++c)g.start.push(d.start(c)),g.end.push(d.end(c));else g=d instanceof Uint8Array?{__type__:"Uint8Array",entries:Array.from(d)}:"number"==typeof d?isNaN(d)?"NaN":isFinite(d)?d:0>d?"-Infinity":"Infinity":d;return g}})}
function Te(b){return JSON.parse(b,function(b,d){if("NaN"==d)var c=NaN;else if("-Infinity"==d)c=-Infinity;else if("Infinity"==d)c=Infinity;else if(d&&"object"==typeof d&&"TimeRanges"==d.__type__)c=Ue(d);else if(d&&"object"==typeof d&&"Uint8Array"==d.__type__)c=new Uint8Array(d.entries);else if(d&&"object"==typeof d&&"Error"==d.__type__){c=d.contents;var f=Error(c.message),g;for(g in c)f[g]=c[g];c=f}else c=d;return c})}
function Ue(b){return{length:b.length,start:function(c){return b.start[c]},end:function(c){return b.end[c]}}};function Ve(b,c,d,e,f,g){this.T=b;this.f=new I(c);this.V=d;this.l=!1;this.w=e;this.K=f;this.G=g;this.b=this.h=!1;this.H="";this.i=null;this.o=this.sd.bind(this);this.u=this.Wf.bind(this);this.a={video:{},player:{}};this.D=0;this.c={};this.g=null;We.add(this)}var Xe=!1,Ye=null;m=Ve.prototype;m.destroy=function(){We["delete"](this);Ze(this);Ye&&$e(this);this.f&&(this.f.stop(),this.f=null);this.K=this.w=null;this.b=this.h=!1;this.u=this.o=this.g=this.c=this.a=this.i=null;return Promise.resolve()};
m.ha=function(){return this.b};m.xd=function(){return this.H};
m.init=function(){if(this.T.length)if(window.chrome&&chrome.cast&&chrome.cast.isAvailable){this.h=!0;this.f.Gc();var b=new chrome.cast.SessionRequest(this.T);b=new chrome.cast.ApiConfig(b,af.bind(this),bf.bind(this),"origin_scoped");chrome.cast.initialize(b,function(){B.debug("CastSender: init")},function(b){B.error("CastSender: init error",b)});Xe&&this.f.R(.02);(b=Ye)&&b.status!=chrome.cast.SessionStatus.STOPPED?(B.debug("CastSender: re-using existing connection"),cf(this,b)):Ye=null}else window.__onGCastApiAvailable||
(window.__onGCastApiAvailable=df),window.__onGCastApiAvailable!=df&&B.Y("A global Cast SDK hook is already installed! Shaka Player will be unable to receive a notification when the Cast SDK is ready.")};m.Gd=function(b){this.i=b;this.b&&ef(this,{type:"appData",appData:this.i})};
m.cast=function(b){if(!this.h)return Promise.reject(new D(1,8,8E3));if(!Xe)return Promise.reject(new D(1,8,8001));if(this.b)return Promise.reject(new D(1,8,8002));this.g=new E;chrome.cast.requestSession(this.ud.bind(this,b),this.qe.bind(this));return this.g};m.vb=function(){if(this.b){Ze(this);if(Ye){$e(this);try{Ye.stop(function(){},function(){})}catch(b){}Ye=null}this.sd()}};
m.get=function(b,c){if("video"==b){if(Ke.includes(c))return this.ze.bind(this,b,c)}else if("player"==b){if(Ne[c]&&!this.get("player","isLive")())return function(){};if(Qe.includes(c))return this.ze.bind(this,b,c);if(Re.includes(c))return this.mg.bind(this,b,c);if(Me[c])return this.we.bind(this,b,c)}return this.we(b,c)};m.set=function(b,c,d){this.a[b][c]=d;ef(this,{type:"set",targetName:b,property:c,value:d})};
m.ud=function(b,c){B.debug("CastSender: onSessionInitiated");Ye=c;c.addUpdateListener(this.o);c.addMessageListener("urn:x-cast:com.google.shaka.v2",this.u);this.sd();ef(this,{type:"init",initState:b,appData:this.i});this.g.resolve()};m.qe=function(b){var c=8003;switch(b.code){case "cancel":c=8004;break;case "timeout":c=8005;break;case "receiver_unavailable":c=8006}this.g.reject(new D(2,8,c,b))};m.we=function(b,c){return this.a[b][c]};
m.ze=function(b,c,d){for(var e=[],f=2;f<arguments.length;++f)e[f-2]=arguments[f];ef(this,{type:"call",targetName:b,methodName:c,args:e})};m.mg=function(b,c,d){for(var e=[],f=2;f<arguments.length;++f)e[f-2]=arguments[f];f=new E;var g=this.D.toString();this.D++;this.c[g]=f;try{ef(this,{type:"asyncCall",targetName:b,methodName:c,args:e,id:g})}catch(h){f.reject(h)}return f};function af(b){for(var c=t(We),d=c.next();!d.done;d=c.next())cf(d.value,b)}
function cf(b,c){B.debug("CastSender: onExistingSessionJoined");var d=b.G();b.g=new E;b.l=!0;b.ud(d,c)}function bf(b){for(var c=t(We),d=c.next();!d.done;d=c.next()){d=d.value;var e=b;B.debug("CastSender: receiver status",e);Xe="available"==e;d.f.Gc()}}function $e(b){var c=Ye;c.removeUpdateListener(b.o);c.removeMessageListener("urn:x-cast:com.google.shaka.v2",b.u)}
m.sd=function(){var b=Ye?"connected"==Ye.status:!1;B.debug("CastSender: connection status",b);if(this.b&&!b){this.K();for(var c in this.a)this.a[c]={};Ze(this)}this.H=(this.b=b)?Ye.receiver.friendlyName:"";this.f.Gc()};function Ze(b){for(var c in b.c){var d=b.c[c];delete b.c[c];d.reject(new D(1,7,7E3))}}
m.Wf=function(b,c){var d=Te(c);B.J("CastSender: message",d);switch(d.type){case "event":var e=d.event;this.w(d.targetName,new K(e.type,e));break;case "update":e=d.update;for(var f in e){d=this.a[f]||{};for(var g in e[f])d[g]=e[f][g]}this.l&&(this.V(),this.l=!1);break;case "asyncComplete":if(f=d.id,d=d.error,g=this.c[f],delete this.c[f],g)if(d){f=new D(d.severity,d.category,d.code);for(e in d)f[e]=d[e];g.reject(f)}else g.resolve()}};
function ef(b,c){var d=Se(c),e=Ye;try{e.sendMessage("urn:x-cast:com.google.shaka.v2",d,function(){},B.error)}catch(f){throw B.error("Cast session sendMessage threw",f),d=new D(2,8,8005,f),b.w("player",new K("error",{detail:d})),b.vb(),d;}}var We=new Set;function df(b){if(b){b=t(We);for(var c=b.next();!c.done;c=b.next())c.value.init()}};function Q(b,c,d){var e=this;bc.call(this);this.c=b;this.b=c;this.i=this.g=this.f=this.l=this.h=null;this.u=d;this.o=new Map;this.a=new Ve(d,function(){return ff(e)},function(){return gf(e)},function(b,c){return hf(e,b,c)},function(){return jf(e)},function(){return kf(e)});lf(this)}bb(Q,bc);A("shaka.cast.CastProxy",Q);
Q.prototype.destroy=function(b){b&&this.a.vb();this.i&&(this.i.release(),this.i=null);b=[];this.b&&(b.push(this.b.destroy()),this.b=null);this.a&&(b.push(this.a.destroy()),this.a=null);this.l=this.h=this.c=null;return Promise.all(b)};Q.prototype.destroy=Q.prototype.destroy;Q.prototype.Hf=function(){return this.h};Q.prototype.getVideo=Q.prototype.Hf;Q.prototype.yf=function(){return this.l};Q.prototype.getPlayer=Q.prototype.yf;Q.prototype.Te=function(){return this.a.h&&Xe};Q.prototype.canCast=Q.prototype.Te;
Q.prototype.ha=function(){return this.a.ha()};Q.prototype.isCasting=Q.prototype.ha;Q.prototype.xd=function(){return this.a.xd()};Q.prototype.receiverName=Q.prototype.xd;Q.prototype.cast=function(){var b=kf(this);return this.a.cast(b).then(function(){if(this.b)return this.b.Od()}.bind(this))};Q.prototype.cast=Q.prototype.cast;Q.prototype.Gd=function(b){this.a.Gd(b)};Q.prototype.setAppData=Q.prototype.Gd;
Q.prototype.Gg=function(){var b=this.a;if(b.b){var c=b.G();chrome.cast.requestSession(b.ud.bind(b,c),b.qe.bind(b))}};Q.prototype.suggestDisconnect=Q.prototype.Gg;
Q.prototype.We=function(b){var c=this;return u(function e(){return x(e,function(e){switch(e.j){case 1:if(b==c.u)return e["return"]();c.u=b;c.a.vb();return v(e,c.a.destroy(),2);case 2:c.a=null,c.a=new Ve(b,function(){return ff(c)},function(){return gf(c)},function(b,e){return hf(c,b,e)},function(){return jf(c)},function(){return kf(c)}),c.a.init(),w(e)}})})};Q.prototype.changeReceiverId=Q.prototype.We;Q.prototype.vb=function(){this.a.vb()};Q.prototype.forceDisconnect=Q.prototype.vb;
function lf(b){b.a.init();b.i=new M;He.forEach(function(b){this.i.B(this.c,b,this.G.bind(this))}.bind(b));Le.forEach(function(b){this.i.B(this.b,b,this.w.bind(this))}.bind(b));b.h={};for(var c in b.c)Object.defineProperty(b.h,c,{configurable:!1,enumerable:!0,get:b.D.bind(b,c),set:b.H.bind(b,c)});b.l={};mf(b,function(c){Object.defineProperty(b.l,c,{configurable:!1,enumerable:!0,get:function(){return nf(b,c)}})});of(b);b.f=new bc;b.f.gc=b.h;b.g=new bc;b.g.gc=b.l}
function of(b){var c=new Map;mf(b,function(d,e){if(c.has(e)){var f=c.get(e);d.length<f.length?b.o.set(d,f):b.o.set(f,d)}else c.set(e,d)})}
function mf(b,c){function d(b){return"constructor"==b||"function"!=typeof e[b]?!1:!f.has(b)}var e=b.b,f=new Set;for(g in e)d(g)&&(f.add(g),c(g,e[g]));var g=Object.getPrototypeOf(e);for(var h=Object.getPrototypeOf({});g&&g!=h;){for(var k=t(Object.getOwnPropertyNames(g)),l=k.next();!l.done;l=k.next())l=l.value,d(l)&&(f.add(l),c(l,e[l]));g=Object.getPrototypeOf(g)}}
function kf(b){var c={video:{},player:{},playerAfterLoad:{},manifest:b.b.pc(),startTime:null};b.c.pause();Je.forEach(function(b){c.video[b]=this.c[b]}.bind(b));b.c.ended||(c.startTime=b.c.currentTime);Oe.forEach(function(b){var d=b[1];b=this.b[b[0]]();c.player[d]=b}.bind(b));Pe.forEach(function(b){var d=b[1];b=this.b[b[0]]();c.playerAfterLoad[d]=b}.bind(b));return c}function ff(b){b.dispatchEvent(new K("caststatuschanged"))}function gf(b){b.f.dispatchEvent(new K(b.h.paused?"pause":"play"))}
function jf(b){Oe.forEach(function(b){var c=b[1];b=this.a.get("player",b[0])();this.b[c](b)}.bind(b));var c=b.a.get("player","getAssetUri")(),d=b.a.get("video","ended"),e=Promise.resolve(),f=b.c.autoplay,g=null;d||(g=b.a.get("video","currentTime"));c&&(b.c.autoplay=!1,e=b.b.load(c,g));var h={};Je.forEach(function(b){h[b]=this.a.get("video",b)}.bind(b));e.then(function(){b.c&&(Je.forEach(function(b){this.c[b]=h[b]}.bind(b)),Pe.forEach(function(b){var c=b[1];b=this.a.get("player",b[0])();this.b[c](b)}.bind(b)),
b.c.autoplay=f,c&&b.c.play())},function(c){b.b.dispatchEvent(new K("error",{detail:c}))})}Q.prototype.D=function(b){if("addEventListener"==b)return this.f.addEventListener.bind(this.f);if("removeEventListener"==b)return this.f.removeEventListener.bind(this.f);if(this.a.ha()&&0==Object.keys(this.a.a.video).length){var c=this.c[b];if("function"!=typeof c)return c}return this.a.ha()?this.a.get("video",b):(b=this.c[b],"function"==typeof b&&(b=b.bind(this.c)),b)};
Q.prototype.H=function(b,c){this.a.ha()?this.a.set("video",b,c):this.c[b]=c};Q.prototype.G=function(b){this.a.ha()||this.f.dispatchEvent(new K(b.type,b))};
function nf(b,c){b.o.has(c)&&(c=b.o.get(c));if("addEventListener"==c)return b.g.addEventListener.bind(b.g);if("removeEventListener"==c)return b.g.removeEventListener.bind(b.g);if("getMediaElement"==c)return function(){return this.h}.bind(b);if("getSharedConfiguration"==c)return B.m("Can't share configuration across a network. Returning copy."),b.a.get("player","getConfiguration");if("getNetworkingEngine"==c)return b.a.ha()&&B.m("NOTE: getNetworkingEngine() is always local!"),b.b.Ub.bind(b.b);if(b.a.ha()){if("getManifest"==
c||"drmInfo"==c)return function(){B.Y(c+"() does not work while casting!");return null};if("getManifestUri"==c)return De("getManifestUri",'Please use "getAssetUri" instead.'),nf(b,"getAssetUri");if("attach"==c||"detach"==c)return function(){B.Y(c+"() does not work while casting!");return Promise.resolve()}}return b.a.ha()&&0==Object.keys(b.a.a.video).length&&Me[c]||!b.a.ha()?b.b[c].bind(b.b):b.a.get("player",c)}Q.prototype.w=function(b){this.a.ha()||this.g.dispatchEvent(b)};
function hf(b,c,d){b.a.ha()&&("video"==c?b.f.dispatchEvent(d):"player"==c&&b.g.dispatchEvent(d))};function pf(b,c,d,e){var f=this;bc.call(this);this.a=b;this.b=c;this.c=new M;this.G={video:b,player:c};this.u=d||function(){};this.H=e||function(b){return b};this.w=!1;this.h=!0;this.g=0;this.o=!1;this.l=!0;this.i=this.f=null;this.D=new I(function(){qf(f)});rf(this)}bb(pf,bc);A("shaka.cast.CastReceiver",pf);pf.prototype.isConnected=function(){return this.w};pf.prototype.isConnected=pf.prototype.isConnected;pf.prototype.Mf=function(){return this.h};pf.prototype.isIdle=pf.prototype.Mf;
pf.prototype.destroy=function(){var b=this;return u(function d(){var e,f;return x(d,function(d){switch(d.j){case 1:return b.c&&(b.c.release(),b.c=null),e=[],b.b&&(e.push(b.b.destroy()),b.b=null),b.D&&(b.D.stop(),b.D=null),b.a=null,b.G=null,b.u=null,b.w=!1,b.h=!0,b.f=null,b.i=null,v(d,Promise.all(e),2);case 2:f=cast.receiver.CastReceiverManager.getInstance(),f.stop(),w(d)}})})};pf.prototype.destroy=pf.prototype.destroy;
function rf(b){var c=cast.receiver.CastReceiverManager.getInstance();c.onSenderConnected=b.se.bind(b);c.onSenderDisconnected=b.se.bind(b);c.onSystemVolumeChanged=b.cf.bind(b);b.i=c.getCastMessageBus("urn:x-cast:com.google.cast.media");b.i.onMessage=b.Rf.bind(b);b.f=c.getCastMessageBus("urn:x-cast:com.google.shaka.v2");b.f.onMessage=b.ag.bind(b);c.start();He.forEach(function(b){this.c.B(this.a,b,this.xe.bind(this,"video"))}.bind(b));Le.forEach(function(b){this.c.B(this.b,b,this.xe.bind(this,"player"))}.bind(b));
cast.__platform__&&cast.__platform__.canDisplayType('video/mp4; codecs="avc1.640028"; width=3840; height=2160')?b.b.Hd(3840,2160):b.b.Hd(1920,1080);b.c.B(b.a,"loadeddata",function(){this.o=!0}.bind(b));b.c.B(b.b,"loading",function(){this.h=!1;sf(this)}.bind(b));b.c.B(b.a,"playing",function(){this.h=!1;sf(this)}.bind(b));b.c.B(b.a,"pause",function(){sf(this)}.bind(b));b.c.B(b.b,"unloading",function(){this.h=!0;sf(this)}.bind(b));b.c.B(b.a,"ended",function(){var b=this;(new I(function(){b.a&&b.a.ended&&
(b.h=!0,sf(b))})).R(5)}.bind(b))}m=pf.prototype;m.se=function(){this.g=0;this.l=!0;this.w=0!=cast.receiver.CastReceiverManager.getInstance().getSenders().length;sf(this)};function sf(b){Promise.resolve().then(function(){this.b&&(this.dispatchEvent(new K("caststatuschanged")),tf(this)||uf(this))}.bind(b))}
function vf(b,c,d){for(var e in c.player)b.b[e](c.player[e]);b.u(d);d=Promise.resolve();var f=b.a.autoplay;c.manifest&&(b.a.autoplay=!1,d=b.b.load(c.manifest,c.startTime));d.then(function(){if(b.b){for(var d in c.video)b.a[d]=c.video[d];for(var e in c.playerAfterLoad)b.b[e](c.playerAfterLoad[e]);b.a.autoplay=f;c.manifest&&(b.a.play(),uf(b))}},function(c){b.b.dispatchEvent(new K("error",{detail:c}))})}m.xe=function(b,c){this.b&&(qf(this),wf(this,{type:"event",targetName:b,event:c},this.f))};
function qf(b){b.D.R(.5);var c={video:{},player:{}};Ie.forEach(function(b){c.video[b]=this.a[b]}.bind(b));if(b.b.X())for(var d in Ne)0==b.g%Ne[d]&&(c.player[d]=b.b[d]());for(var e in Me)0==b.g%Me[e]&&(c.player[e]=b.b[e]());if(d=cast.receiver.CastReceiverManager.getInstance().getSystemVolume())c.video.volume=d.level,c.video.muted=d.muted;b.o&&(b.g+=1);wf(b,{type:"update",update:c},b.f);tf(b)}function tf(b){return b.l&&(b.a.duration||b.b.X())?(xf(b),b.l=!1,!0):!1}
function xf(b,c){c=void 0===c?0:c;var d={contentId:b.b.pc(),streamType:b.b.X()?"LIVE":"BUFFERED",contentType:""};b.b.X()||(d.duration=b.a.duration);uf(b,c,d)}m.cf=function(){var b=cast.receiver.CastReceiverManager.getInstance().getSystemVolume();b&&wf(this,{type:"update",update:{video:{volume:b.level,muted:b.muted}}},this.f);wf(this,{type:"event",targetName:"video",event:{type:"volumechange"}},this.f)};
m.ag=function(b){var c=Te(b.data);B.debug("CastReceiver: message",c);switch(c.type){case "init":this.g=0;this.o=!1;this.l=!0;vf(this,c.initState,c.appData);qf(this);break;case "appData":this.u(c.appData);break;case "set":var d=c.targetName,e=c.property;c=c.value;if("video"==d){var f=cast.receiver.CastReceiverManager.getInstance();if("volume"==e){f.setSystemVolumeLevel(c);break}else if("muted"==e){f.setSystemVolumeMuted(c);break}}this.G[d][e]=c;break;case "call":d=this.G[c.targetName];d[c.methodName].apply(d,
c.args);break;case "asyncCall":d=c.targetName;e=c.methodName;"player"==d&&"load"==e&&(this.g=0,this.o=!1);f=c.id;b=b.senderId;var g=this.G[d];c=g[e].apply(g,c.args);"player"==d&&"load"==e&&(c=c.then(function(){this.l=!0}.bind(this)));c.then(this.De.bind(this,b,f,null),this.De.bind(this,b,f))}};
m.Rf=function(b){var c=Te(b.data);B.debug("CastReceiver: message",c);switch(c.type){case "PLAY":this.a.play();uf(this);break;case "PAUSE":this.a.pause();uf(this);break;case "SEEK":b=c.currentTime;var d=c.resumeState;null!=b&&(this.a.currentTime=Number(b));d&&"PLAYBACK_START"==d?(this.a.play(),uf(this)):d&&"PLAYBACK_PAUSE"==d&&(this.a.pause(),uf(this));break;case "STOP":this.b.Od().then(function(){this.b&&uf(this)}.bind(this));break;case "GET_STATUS":xf(this,Number(c.requestId));break;case "VOLUME":d=
c.volume;b=d.level;d=d.muted;var e=this.a.volume,f=this.a.muted;null!=b&&(this.a.volume=Number(b));null!=d&&(this.a.muted=d);e==this.a.volume&&f==this.a.muted||uf(this);break;case "LOAD":this.g=0;this.l=this.o=!1;b=c.media;d=c.currentTime;e=this.H(b.contentId);f=c.autoplay||!0;this.u(b.customData);f&&(this.a.autoplay=!0);this.b.load(e,d).then(function(){this.b&&xf(this)}.bind(this))["catch"](function(b){var d="LOAD_FAILED";7==b.category&&7E3==b.code&&(d="LOAD_CANCELLED");wf(this,{requestId:Number(c.requestId),
type:d},this.i)}.bind(this));break;default:B.m("Unrecognized message type from the generic Chromecast controller!",c.type),wf(this,{requestId:Number(c.requestId),type:"INVALID_REQUEST",reason:"INVALID_COMMAND"},this.i)}};m.De=function(b,c,d){this.b&&wf(this,{type:"asyncComplete",id:c,error:d},this.f,b)};function wf(b,c,d,e){b.w&&(b=Se(c),e?d.getCastChannel(e).send(b):d.broadcast(b))}
function uf(b,c,d){c=void 0===c?0:c;d=void 0===d?null:d;var e=b.a.playbackRate;var f=yf;f=b.h?f.IDLE:b.b.fd()?f.Le:b.a.paused?f.Ne:f.Oe;e={mediaSessionId:0,playbackRate:e,playerState:f,currentTime:b.a.currentTime,supportedMediaCommands:63,volume:{level:b.a.volume,muted:b.a.muted}};d&&(e.media=d);wf(b,{requestId:c,type:"MEDIA_STATUS",status:[e]},b.i)}var yf={IDLE:"IDLE",Oe:"PLAYING",Le:"BUFFERING",Ne:"PAUSED"};function S(b,c){this.N=b;this.b=c==zf;this.a=0}A("shaka.util.DataViewReader",S);var zf=1;S.Endianness={Pg:0,Rg:zf};S.prototype.ya=function(){return this.a<this.N.byteLength};S.prototype.hasMoreData=S.prototype.ya;S.prototype.ga=function(){return this.a};S.prototype.getPosition=S.prototype.ga;S.prototype.mf=function(){return this.N.byteLength};S.prototype.getLength=S.prototype.mf;S.prototype.na=function(){try{var b=this.N.getUint8(this.a);this.a+=1;return b}catch(c){Af()}};S.prototype.readUint8=S.prototype.na;
S.prototype.$b=function(){try{var b=this.N.getUint16(this.a,this.b);this.a+=2;return b}catch(c){Af()}};S.prototype.readUint16=S.prototype.$b;S.prototype.I=function(){try{var b=this.N.getUint32(this.a,this.b);this.a+=4;return b}catch(c){Af()}};S.prototype.readUint32=S.prototype.I;S.prototype.ye=function(){try{var b=this.N.getInt32(this.a,this.b);this.a+=4;return b}catch(c){Af()}};S.prototype.readInt32=S.prototype.ye;
S.prototype.Kb=function(){try{if(this.b){var b=this.N.getUint32(this.a,!0);var c=this.N.getUint32(this.a+4,!0)}else c=this.N.getUint32(this.a,!1),b=this.N.getUint32(this.a+4,!1)}catch(d){Af()}if(2097151<c)throw new D(2,3,3001);this.a+=8;return c*Math.pow(2,32)+b};S.prototype.readUint64=S.prototype.Kb;S.prototype.gb=function(b){this.a+b>this.N.byteLength&&Af();var c=new Uint8Array(this.N.buffer,this.N.byteOffset+this.a,b);this.a+=b;return c};S.prototype.readBytes=S.prototype.gb;
S.prototype.P=function(b){this.a+b>this.N.byteLength&&Af();this.a+=b};S.prototype.skip=S.prototype.P;S.prototype.Ae=function(b){this.a<b&&Af();this.a-=b};S.prototype.rewind=S.prototype.Ae;S.prototype.seek=function(b){(0>b||b>this.N.byteLength)&&Af();this.a=b};S.prototype.seek=S.prototype.seek;S.prototype.wd=function(){for(var b=this.a;this.ya()&&0!=this.N.getUint8(this.a);)this.a+=1;b=new Uint8Array(this.N.buffer,this.N.byteOffset+b,this.a-b);this.a+=1;return Gb(b)};
S.prototype.readTerminatedString=S.prototype.wd;function Af(){throw new D(2,3,3E3);};function T(){this.c=[];this.b=[];this.a=!1}A("shaka.util.Mp4Parser",T);T.prototype.L=function(b,c){var d=Bf(b);this.c[d]=0;this.b[d]=c;return this};T.prototype.box=T.prototype.L;T.prototype.ia=function(b,c){var d=Bf(b);this.c[d]=1;this.b[d]=c;return this};T.prototype.fullBox=T.prototype.ia;T.prototype.stop=function(){this.a=!0};T.prototype.stop=T.prototype.stop;
T.prototype.parse=function(b,c){var d=new Uint8Array(b);d=new S(new DataView(d.buffer,d.byteOffset,d.byteLength),0);for(this.a=!1;d.ya()&&!this.a;)this.Ac(0,d,c)};T.prototype.parse=T.prototype.parse;
T.prototype.Ac=function(b,c,d){var e=c.ga(),f=c.I(),g=c.I(),h=!1;B.J("Parsing MP4 box",Cf(g));switch(f){case 0:f=c.N.byteLength-e;break;case 1:f=c.Kb(),h=!0}var k=this.b[g];if(k){var l=null,n=null;1==this.c[g]&&(n=c.I(),l=n>>>24,n&=16777215);g=e+f;d&&g>c.N.byteLength&&(g=c.N.byteLength);g-=c.ga();c=0<g?c.gb(g):new Uint8Array(0);c=new S(new DataView(c.buffer,c.byteOffset,c.byteLength),0);k({parser:this,partialOkay:d||!1,version:l,flags:n,reader:c,size:f,start:e+b,has64BitSize:h})}else c.P(Math.min(e+
f-c.ga(),c.N.byteLength-c.ga()))};T.prototype.parseNext=T.prototype.Ac;function Df(b){for(var c=Ef(b);b.reader.ya()&&!b.parser.a;)b.parser.Ac(b.start+c,b.reader,b.partialOkay)}T.children=Df;function Ff(b){for(var c=Ef(b),d=b.reader.I();0<d&&!b.parser.a;--d)b.parser.Ac(b.start+c,b.reader,b.partialOkay)}T.sampleDescription=Ff;function Gf(b){return function(c){b(c.reader.gb(c.reader.N.byteLength-c.reader.ga()))}}T.allData=Gf;
function Bf(b){for(var c=0,d=0;d<b.length;d++)c=c<<8|b.charCodeAt(d);return c}function Cf(b){return String.fromCharCode(b>>24&255,b>>16&255,b>>8&255,b&255)}T.typeToString=Cf;function Ef(b){return 8+(b.has64BitSize?8:0)+(null!=b.flags?4:0)}T.headerSize=Ef;function Hf(b){var c=this;this.a=[];this.b=[];this.data=[];(new T).L("moov",Df).ia("pssh",function(b){if(1<b.version)B.m("Unrecognized PSSH version found!");else{var d=b.reader.N;d=new Uint8Array(d.buffer,d.byteOffset-12,b.size);c.data.push(d);c.a.push(G.Ic(b.reader.gb(16)));if(0<b.version){d=b.reader.I();for(var f=0;f<d;++f){var g=G.Ic(b.reader.gb(16));c.b.push(g)}}}}).parse(b);0==this.data.length&&B.m("No pssh box found!")}
function If(b){if(!b)return b;var c=new Hf(b);if(1>=c.data.length)return b;b=[];var d={};c=t(c.data);for(var e=c.next();!e.done;d={tc:d.tc},e=c.next())d.tc=e.value,b.some(function(b){return function(c){return G.Da(c,b.tc)}}(d))||b.push(d.tc);return G.concat.apply(G,b instanceof Array?b:Sa(t(b)))};var U={oc:function(b,c){var d=U.U(b,c);return 1!=d.length?null:d[0]},Wc:function(b,c,d){b=U.ae(b,c,d);return 1!=b.length?null:b[0]},U:function(b,c){return Array.prototype.filter.call(b.childNodes,function(b){return b instanceof Element&&b.tagName==c})},ae:function(b,c,d){return Array.prototype.filter.call(b.childNodes,function(b){return b instanceof Element&&b.localName==d&&b.namespaceURI==c})},getAttributeNS:function(b,c,d){return b.hasAttributeNS(c,d)?b.getAttributeNS(c,d):null},qc:function(b){return Array.prototype.every.call(b.childNodes,
function(b){return b.nodeType==Node.TEXT_NODE||b.nodeType==Node.CDATA_SECTION_NODE})?b.textContent.trim():null},M:function(b,c,d,e){e=void 0===e?null:e;var f=null;b=b.getAttribute(c);null!=b&&(f=d(b));return null==f?e:f},eg:function(b){if(!b)return null;/^\d+-\d+-\d+T\d+:\d+:\d+(\.\d+)?$/.test(b)&&(b+="Z");b=Date.parse(b);return isNaN(b)?null:Math.floor(b/1E3)},Ia:function(b){if(!b)return null;var c=/^P(?:([0-9]*)Y)?(?:([0-9]*)M)?(?:([0-9]*)D)?(?:T(?:([0-9]*)H)?(?:([0-9]*)M)?(?:([0-9.]*)S)?)?$/.exec(b);
if(!c)return B.m("Invalid duration string:",b),null;b=31536E3*Number(c[1]||null)+2592E3*Number(c[2]||null)+86400*Number(c[3]||null)+3600*Number(c[4]||null)+60*Number(c[5]||null)+Number(c[6]||null);return isFinite(b)?b:null},Cc:function(b){var c=/([0-9]+)-([0-9]+)/.exec(b);if(!c)return null;b=Number(c[1]);if(!isFinite(b))return null;c=Number(c[2]);return isFinite(c)?{start:b,end:c}:null},parseInt:function(b){b=Number(b);return 0===b%1?b:null},Bc:function(b){b=Number(b);return 0===b%1&&0<b?b:null},
Hb:function(b){b=Number(b);return 0===b%1&&0<=b?b:null},parseFloat:function(b){b=Number(b);return isNaN(b)?null:b},af:function(b){var c;b=(c=b.match(/^(\d+)\/(\d+)$/))?Number(c[1])/Number(c[2]):Number(b);return isNaN(b)?null:b},ve:function(b,c){var d=new DOMParser;try{var e=d.parseFromString(b,"text/xml")}catch(g){}if(e&&e.documentElement.tagName==c)var f=e.documentElement;return f&&0<f.getElementsByTagName("parsererror").length?null:f},ue:function(b,c){try{var d=Gb(b);return U.ve(d,c)}catch(e){}}};var Jf=(new Map).set("urn:uuid:1077efec-c0b2-4d02-ace3-3c1e52e2fb4b","org.w3.clearkey").set("urn:uuid:edef8ba9-79d6-4ace-a3c8-27dcd51d21ed","com.widevine.alpha").set("urn:uuid:9a04f079-9840-4286-ab92-e65be0885f95","com.microsoft.playready").set("urn:uuid:79f0049a-4098-8642-ab92-e65be0885f95","com.microsoft.playready").set("urn:uuid:f239e769-efa3-4850-9c16-a903c6932efb","com.adobe.primetime");
function Kf(b,c,d){var e=Lf(b),f=null;b=[];var g=[],h=new Set(e.map(function(b){return b.keyId}));h["delete"](null);if(1<h.size)throw new D(2,4,4010);d||(g=e.filter(function(b){return"urn:mpeg:dash:mp4protection:2011"==b.Be?(f=b.init||f,!1):!0}),g.length&&(b=Mf(f,c,g),0==b.length&&(b=[zb("",f)])));if(e.length&&(d||!g.length))for(b=[],c=t(Jf.values()),d=c.next();!d.done;d=c.next())d=d.value,"org.w3.clearkey"!=d&&b.push(zb(d,f));if(h=Array.from(h)[0]||null)for(c=t(b),d=c.next();!d.done;d=c.next())for(d=
t(d.value.initData),e=d.next();!e.done;e=d.next())e.value.keyId=h;return{Xd:h,Tg:f,drmInfos:b,be:!0}}function Nf(b,c,d,e){var f=Kf(b,c,e);if(d.be){b=1==d.drmInfos.length&&!d.drmInfos[0].keySystem;c=0==f.drmInfos.length;if(0==d.drmInfos.length||b&&!c)d.drmInfos=f.drmInfos;d.be=!1}else if(0<f.drmInfos.length&&(d.drmInfos=d.drmInfos.filter(function(b){return f.drmInfos.some(function(c){return c.keySystem==b.keySystem})}),0==d.drmInfos.length))throw new D(2,4,4008);return f.Xd||d.Xd}
function Of(b){var c=0,d=(new DataView(b)).getUint32(c,!0);c+=4;if(d!==b.byteLength)return B.m("PlayReady Object with invalid length encountered."),[];c+=2;d=[];for(var e=new DataView(b);c<b.byteLength-1;){var f=e.getUint16(c,!0);c+=2;var g=e.getUint16(c,!0);c+=2;var h=new Uint8Array(b,c,g);d.push({type:f,value:h});c+=g}return d}
function Pf(b){b=t(b.getElementsByTagName("DATA"));for(var c=b.next();!c.done;c=b.next()){c=t(c.value.childNodes);for(var d=c.next();!d.done;d=c.next())if(d=d.value,d instanceof Element&&"LA_URL"==d.tagName)return d.textContent}return""}
function Mf(b,c,d){var e=[];d=t(d);for(var f=d.next();!f.done;f=d.next()){f=f.value;var g=Jf.get(f.Be);if(g){var h;if(h=U.Wc(f.node,"urn:microsoft:playready","pro")){h=G.Fa(h.textContent);var k=new Uint8Array([154,4,240,121,152,64,66,134,171,146,230,91,224,136,95,149]),l=h.length,n=k.length+16+l,p=new ArrayBuffer(n),q=new Uint8Array(p);p=new DataView(p);var r=0;p.setUint32(r,n);r+=4;p.setUint32(r,1886614376);r+=4;p.setUint32(r,0);r+=4;q.set(k,r);r+=k.length;p.setUint32(r,l);r+=4;q.set(h,r);h=[{initData:q,
initDataType:"cenc",keyId:f.keyId}]}else h=null;h=zb(g,f.init||b||h);if(g=Qf.get(g))h.licenseServerUri=g(f);e.push(h)}else for(f=c(f.node)||[],f=t(f),g=f.next();!g.done;g=f.next())e.push(g.value)}return e}
var Qf=(new Map).set("com.widevine.alpha",function(b){return(b=U.Wc(b.node,"urn:microsoft","laurl"))?b.getAttribute("licenseUrl")||"":""}).set("com.microsoft.playready",function(b){b=U.Wc(b.node,"urn:microsoft:playready","pro");if(!b)return"";b=G.Fa(b.textContent);b=Of(b.buffer).filter(function(b){return 1===b.type})[0];if(!b)return"";b=Ib(b.value,!0);return(b=U.ve(b,"WRMHEADER"))?Pf(b):""});function Lf(b){var c=[];b=t(b);for(var d=b.next();!d.done;d=b.next())(d=Rf(d.value))&&c.push(d);return c}
function Rf(b){var c=b.getAttribute("schemeIdUri"),d=U.getAttributeNS(b,"urn:mpeg:cenc:2013","default_KID"),e=U.ae(b,"urn:mpeg:cenc:2013","pssh").map(U.qc);if(!c)return B.error("Missing required schemeIdUri attribute on","ContentProtection element",b),null;c=c.toLowerCase();if(d&&(d=d.replace(/-/g,"").toLowerCase(),d.includes(" ")))throw new D(2,4,4009);var f=[];try{f=e.map(function(b){return{initDataType:"cenc",initData:G.Fa(b),keyId:null}})}catch(g){throw new D(2,4,4007);}return{node:b,Be:c,keyId:d,
init:0<f.length?f:null}};function Sf(b,c,d,e,f){var g={RepresentationID:c,Number:d,Bandwidth:e,Time:f};return b.replace(/\$(RepresentationID|Number|Bandwidth|Time)?(?:%0([0-9]+)([diouxX]))?\$/g,function(c,d,e,f){if("$$"==c)return"$";var h=g[d];if(null==h)return B.m("URL template does not have an available substitution for identifier",'"'+d+'":',b),c;"RepresentationID"==d&&e&&(B.m("URL template should not contain a width specifier for identifier",'"RepresentationID":',b),e=void 0);"Time"==d&&(h=Math.round(h));switch(f){case void 0:case "d":case "i":case "u":c=
h.toString();break;case "o":c=h.toString(8);break;case "x":c=h.toString(16);break;case "X":c=h.toString(16).toUpperCase();break;default:c=h.toString()}e=window.parseInt(e,10)||1;return Array(Math.max(0,e-c.length)+1).join("0")+c})}
function Tf(b,c){var d=Uf(b,c,"timescale"),e=1;d&&(e=U.Bc(d)||1);d=Uf(b,c,"duration");(d=U.Bc(d||""))&&(d/=e);var f=Uf(b,c,"startNumber"),g=Number(Uf(b,c,"presentationTimeOffset"))||0,h=U.Hb(f||"");if(null==f||null==h)h=1;var k=Vf(b,c,"SegmentTimeline");f=null;if(k){f=e;var l=b.W.duration||Infinity;k=U.U(k,"S");for(var n=[],p=-g,q=0;q<k.length;++q){var r=k[q],y=U.M(r,"t",U.Hb),C=U.M(r,"d",U.Hb),z=U.M(r,"r",U.parseInt);null!=y&&(y-=g);if(!C){B.m('"S" element must have a duration:','ignoring the remaining "S" elements.',
r);break}y=null!=y?y:p;z=z||0;if(0>z)if(q+1<k.length){z=U.M(k[q+1],"t",U.Hb);if(null==z){B.m('An "S" element cannot have a negative repeat','if the next "S" element does not have a valid start time:','ignoring the remaining "S" elements.',r);break}else if(y>=z){B.m('An "S" element cannot have a negative repeat','if its start time exceeds the next "S" element\'s start time:','ignoring the remaining "S" elements.',r);break}z=Math.ceil((z-y)/C)-1}else{if(Infinity==l){B.m('The last "S" element cannot have a negative repeat',
"if the Period has an infinite duration:",'ignoring the last "S" element.',r);break}else if(y/f>=l){B.m('The last "S" element cannot have a negative repeat',"if its start time exceeds the Period's duration:",'igoring the last "S" element.',r);break}z=Math.ceil((l*f-y)/C)-1}0<n.length&&y!=p&&(Math.abs((y-p)/f)>=Fb&&B.m("SegmentTimeline contains a large gap/overlap:","the content may have errors in it.",r),n[n.length-1].end=y/f);for(r=0;r<=z;++r)p=y+C,n.push({start:y/f,end:p/f,Lg:y}),y=p}f=n}return{timescale:e,
da:d,ib:h,oa:g/e||0,Pd:g,S:f}}function Uf(b,c,d){return[c(b.A),c(b.aa),c(b.ma)].filter(xb.Na).map(function(b){return b.getAttribute(d)}).reduce(function(b,c){return b||c})}function Vf(b,c,d){return[c(b.A),c(b.aa),c(b.ma)].filter(xb.Na).map(function(b){return U.oc(b,d)}).reduce(function(b,c){return b||c})}
function Wf(b,c,d,e,f,g){for(var h=U.getAttributeNS(b,"http://www.w3.org/1999/xlink","href"),k=U.getAttributeNS(b,"http://www.w3.org/1999/xlink","actuate")||"onRequest",l=0;l<b.attributes.length;l++){var n=b.attributes[l];"http://www.w3.org/1999/xlink"==n.namespaceURI&&(b.removeAttributeNS(n.namespaceURI,n.localName),--l)}if(5<=g)return Vb(new D(2,4,4028));if("onLoad"!=k)return Vb(new D(2,4,4027));var p=yb([e],[h]);return f.request(0,mc(p,c)).Z(function(e){e=U.ue(e.data,b.tagName);if(!e)return Vb(new D(2,
4,4001,h));for(;b.childNodes.length;)b.removeChild(b.childNodes[0]);for(;e.childNodes.length;){var k=e.childNodes[0];e.removeChild(k);b.appendChild(k)}for(k=0;k<e.attributes.length;k++){var l=e.attributes[k].nodeName,n=e.getAttribute(l);b.setAttribute(l,n)}return Xf(b,c,d,p[0],f,g+1)})}
function Xf(b,c,d,e,f,g){g=void 0===g?0:g;if(U.getAttributeNS(b,"http://www.w3.org/1999/xlink","href")){var h=Wf(b,c,d,e,f,g);d&&(h=h.Z(void 0,function(){return Xf(b,c,d,e,f,g)}));return h}h=[];for(var k=0;k<b.childNodes.length;k++){var l=b.childNodes[k];l instanceof Element&&("urn:mpeg:dash:resolve-to-zero:2013"==U.getAttributeNS(l,"http://www.w3.org/1999/xlink","href")?(b.removeChild(l),--k):"SegmentTimeline"!=l.tagName&&h.push(Xf(l,c,d,e,f,g)))}return Zb(h).Z(function(){return b})};function Yf(b,c,d){this.c=b;this.b=c;this.a=d}A("shaka.media.InitSegmentReference",Yf);Yf.prototype.Qc=function(){return this.c()};Yf.prototype.createUris=Yf.prototype.Qc;Yf.prototype.bd=function(){return this.b};Yf.prototype.getStartByte=Yf.prototype.bd;Yf.prototype.ad=function(){return this.a};Yf.prototype.getEndByte=Yf.prototype.ad;function V(b,c,d,e,f,g){this.position=b;this.startTime=c;this.endTime=d;this.c=e;this.b=f;this.a=g}A("shaka.media.SegmentReference",V);V.prototype.ga=function(){return this.position};
V.prototype.getPosition=V.prototype.ga;V.prototype.sc=function(){return this.startTime};V.prototype.getStartTime=V.prototype.sc;V.prototype.kf=function(){return this.endTime};V.prototype.getEndTime=V.prototype.kf;V.prototype.Qc=function(){return this.c()};V.prototype.createUris=V.prototype.Qc;V.prototype.bd=function(){return this.b};V.prototype.getStartByte=V.prototype.bd;V.prototype.ad=function(){return this.a};V.prototype.getEndByte=V.prototype.ad;function Zf(b,c,d,e){var f,g=(new T).ia("sidx",function(b){f=$f(c,e,d,b)});b&&g.parse(b);if(f)return f;B.error('Invalid box type, expected "sidx".');throw new D(2,3,3004);}
function $f(b,c,d,e){var f=[];e.reader.P(4);var g=e.reader.I();if(0==g)throw B.error("Invalid timescale."),new D(2,3,3005);if(0==e.version){var h=e.reader.I();var k=e.reader.I()}else h=e.reader.Kb(),k=e.reader.Kb();e.reader.P(2);var l=e.reader.$b();b=b+e.size+k;for(k=0;k<l;k++){var n=e.reader.I(),p=(n&2147483648)>>>31;n&=2147483647;var q=e.reader.I();e.reader.P(4);if(1==p)throw B.error("Heirarchical SIDXs are not supported."),new D(2,3,3006);f.push(new V(f.length,h/g-c,(h+q)/g-c,function(){return d},
b,b+n-1));h+=q;b+=n}e.parser.stop();return f};function ag(b){this.a=b}A("shaka.media.SegmentIndex",ag);ag.prototype.destroy=function(){this.a=null;return Promise.resolve()};ag.prototype.destroy=ag.prototype.destroy;ag.prototype.find=function(b){for(var c=this.a.length-1,d=c;0<=d;--d){var e=this.a[d],f=d<c?this.a[d+1].startTime:e.endTime;if(b>=e.startTime&&b<f)return e.position}return this.a.length&&b<this.a[0].startTime?this.a[0].position:null};ag.prototype.find=ag.prototype.find;
ag.prototype.get=function(b){if(0==this.a.length)return null;b-=this.a[0].position;return 0>b||b>=this.a.length?null:this.a[b]};ag.prototype.get=ag.prototype.get;ag.prototype.offset=function(b){for(var c=0;c<this.a.length;++c)this.a[c].startTime+=b,this.a[c].endTime+=b};ag.prototype.offset=ag.prototype.offset;
ag.prototype.md=function(b){for(var c=[],d=0,e=0;d<this.a.length&&e<b.length;){var f=this.a[d],g=b[e];f.startTime<g.startTime?(c.push(f),d++):(f.startTime>g.startTime?0==d?c.push(g):B.m("Refusing to rewrite original references on update!"):(.1<Math.abs(f.endTime-g.endTime)?c.push(new V(f.position,g.startTime,g.endTime,g.c,g.b,g.a)):c.push(f),d++),e++)}for(;d<this.a.length;)c.push(this.a[d++]);if(c.length)for(d=c[c.length-1].position+1;e<b.length;)f=b[e++],f=new V(d++,f.startTime,f.endTime,f.c,f.b,
f.a),c.push(f);else c=b;this.a=c};ag.prototype.merge=ag.prototype.md;ag.prototype.Tc=function(b){for(var c=0;c<this.a.length;++c)if(this.a[c].endTime>b){this.a.splice(0,c);return}this.a=[]};ag.prototype.evict=ag.prototype.Tc;function bg(b,c){for(;b.a.length;)if(b.a[b.a.length-1].startTime>=c)b.a.pop();else break;for(;b.a.length;)if(0>=b.a[0].endTime)b.a.shift();else break;if(0!=b.a.length){var d=b.a[b.a.length-1];b.a[b.a.length-1]=new V(d.position,d.startTime,c,d.c,d.b,d.a)}};function cg(b){this.b=b;this.a=new S(b,0);dg||(dg=[new Uint8Array([255]),new Uint8Array([127,255]),new Uint8Array([63,255,255]),new Uint8Array([31,255,255,255]),new Uint8Array([15,255,255,255,255]),new Uint8Array([7,255,255,255,255,255]),new Uint8Array([3,255,255,255,255,255,255]),new Uint8Array([1,255,255,255,255,255,255,255])])}var dg;cg.prototype.ya=function(){return this.a.ya()};
function eg(b){var c=fg(b);if(7<c.length)throw new D(2,3,3002);for(var d=0,e=0;e<c.length;e++)d=256*d+c[e];c=d;d=fg(b);a:{e=G.Da;for(var f=0;f<dg.length;f++)if(e(d,dg[f])){e=!0;break a}e=!1}if(e)d=b.b.byteLength-b.a.ga();else{if(8==d.length&&d[1]&224)throw new D(2,3,3001);e=d[0]&(1<<8-d.length)-1;for(f=1;f<d.length;f++)e=256*e+d[f];d=e}d=b.a.ga()+d<=b.b.byteLength?d:b.b.byteLength-b.a.ga();e=new DataView(b.b.buffer,b.b.byteOffset+b.a.ga(),d);b.a.P(d);return new gg(c,e)}
function fg(b){var c=b.a.na(),d;for(d=1;8>=d&&!(c&1<<8-d);d++);if(8<d)throw new D(2,3,3002);var e=new Uint8Array(d);e[0]=c;for(c=1;c<d;c++)e[c]=b.a.na();return e}function gg(b,c){this.id=b;this.a=c}function hg(b){if(8<b.a.byteLength)throw new D(2,3,3002);if(8==b.a.byteLength&&b.a.getUint8(0)&224)throw new D(2,3,3001);for(var c=0,d=0;d<b.a.byteLength;d++){var e=b.a.getUint8(d);c=256*c+e}return c};function ig(){}
ig.prototype.parse=function(b,c,d,e){var f;c=new cg(new DataView(c));if(440786851!=eg(c).id)throw B.error("Not an EBML element."),new D(2,3,3008);var g=eg(c);if(408125543!=g.id)throw B.error("Not a Segment element."),new D(2,3,3009);c=g.a.byteOffset;g=new cg(g.a);for(f=null;g.ya();){var h=eg(g);if(357149030==h.id){f=h;break}}if(!f)throw B.error("Not an Info element."),new D(2,3,3010);g=new cg(f.a);f=1E6;for(h=null;g.ya();){var k=eg(g);if(2807729==k.id)f=hg(k);else if(17545==k.id)if(h=k,4==h.a.byteLength)h=
h.a.getFloat32(0);else if(8==h.a.byteLength)h=h.a.getFloat64(0);else throw new D(2,3,3003);}if(null==h)throw new D(2,3,3011);g=f/1E9;f=h*g;b=eg(new cg(new DataView(b)));if(475249515!=b.id)throw B.error("Not a Cues element."),new D(2,3,3007);return jg(b,c,g,f,d,e)};
function jg(b,c,d,e,f,g){function h(){return f}var k=[];b=new cg(b.a);for(var l=null,n=null;b.ya();){var p=eg(b);if(187==p.id){var q=kg(p);q&&(p=d*q.Mg,q=c+q.lg,null!=l&&k.push(new V(k.length,l-g,p-g,h,n,q-1)),l=p,n=q)}}null!=l&&k.push(new V(k.length,l-g,e-g,h,n,null));return k}
function kg(b){var c=new cg(b.a);b=eg(c);if(179!=b.id)throw B.m("Not a CueTime element."),new D(2,3,3013);b=hg(b);c=eg(c);if(183!=c.id)throw B.m("Not a CueTrackPositions element."),new D(2,3,3012);c=new cg(c.a);for(var d=0;c.ya();){var e=eg(c);if(241==e.id){d=hg(e);break}}return{Mg:b,lg:d}};function lg(b,c){var d=Vf(b,c,"Initialization");if(!d)return null;var e=b.A.ta,f=d.getAttribute("sourceURL");f&&(e=yb(b.A.ta,[f]));f=0;var g=null;if(d=U.M(d,"range",U.Cc))f=d.start,g=d.end;return new Yf(function(){return e},f,g)}
function mg(b,c){var d=Number(Uf(b,ng,"presentationTimeOffset"))||0,e=Uf(b,ng,"timescale"),f=1;e&&(f=U.Bc(e)||1);d=d/f||0;e=lg(b,ng);var g=b.A.contentType;f=b.A.mimeType.split("/")[1];if("text"!=g&&"mp4"!=f&&"webm"!=f)throw B.error("SegmentBase specifies an unsupported container type.",b.A),new D(2,4,4006);if("webm"==f&&!e)throw B.error("SegmentBase does not contain sufficient segment information:","the SegmentBase uses a WebM container,","but does not contain an Initialization element.",b.A),new D(2,
4,4005);g=Vf(b,ng,"RepresentationIndex");var h=Uf(b,ng,"indexRange"),k=b.A.ta;h=U.Cc(h||"");if(g){var l=g.getAttribute("sourceURL");l&&(k=yb(b.A.ta,[l]));h=U.M(g,"range",U.Cc,h)}if(!h)throw B.error("SegmentBase does not contain sufficient segment information:","the SegmentBase does not contain @indexRange","or a RepresentationIndex element.",b.A),new D(2,4,4002);f=og(b,c,e,k,h.start,h.end,f,d);return{createSegmentIndex:f.createSegmentIndex,findSegmentPosition:f.findSegmentPosition,getSegmentReference:f.getSegmentReference,
initSegmentReference:e,oa:d}}function og(b,c,d,e,f,g,h,k){var l=b.presentationTimeline,n=!b.tb||!b.W.hd,p=b.W.start,q=b.W.duration,r=c,y=null;return{createSegmentIndex:function(){var b=[r(e,f,g),"webm"==h?r(d.c(),d.b,d.a):null];r=null;return Promise.all(b).then(function(b){var c=b[0];b=b[1]||null;c="mp4"==h?Zf(c,f,e,k):(new ig).parse(c,b,e,k);l.Eb(c,p);y=new ag(c);n&&bg(y,q)})},findSegmentPosition:function(b){return y.find(b)},getSegmentReference:function(b){return y.get(b)}}}
function ng(b){return b.ac};function pg(b,c){var d=lg(b,qg);var e=rg(b);var f=Tf(b,qg),g=f.ib;0==g&&(B.m("SegmentList@startNumber must be > 0"),g=1);var h=0;f.da?h=f.da*(g-1):f.S&&0<f.S.length&&(h=f.S[0].start);e={da:f.da,startTime:h,ib:g,oa:f.oa,S:f.S,cb:e};if(!e.da&&!e.S&&1<e.cb.length)throw B.m("SegmentList does not contain sufficient segment information:","the SegmentList specifies multiple segments,","but does not specify a segment duration or timeline.",b.A),new D(2,4,4002);if(!e.da&&!b.W.duration&&!e.S&&1==e.cb.length)throw B.m("SegmentList does not contain sufficient segment information:",
"the SegmentList specifies one segment,","but does not specify a segment duration, period duration,","or timeline.",b.A),new D(2,4,4002);if(e.S&&0==e.S.length)throw B.m("SegmentList does not contain sufficient segment information:","the SegmentList has an empty timeline.",b.A),new D(2,4,4002);g=f=null;b.ma.id&&b.A.id&&(g=b.ma.id+","+b.A.id,f=c[g]);h=sg(b.W.duration,e.ib,b.A.ta,e);f?(f.md(h),g=b.presentationTimeline.Wb(),f.Tc(g-b.W.start)):(b.presentationTimeline.Eb(h,b.W.start),f=new ag(h),g&&b.tb&&
(c[g]=f));b.tb&&b.W.hd||bg(f,b.W.duration);return{createSegmentIndex:Promise.resolve.bind(Promise),findSegmentPosition:f.find.bind(f),getSegmentReference:f.get.bind(f),initSegmentReference:d,oa:e.oa}}function qg(b){return b.Qa}
function sg(b,c,d,e){var f=e.cb.length;e.S&&e.S.length!=e.cb.length&&(f=Math.min(e.S.length,e.cb.length),B.m("The number of items in the segment timeline and the number of segment","URLs do not match, truncating",e.cb.length,"to",f));for(var g=[],h=e.startTime,k=0;k<f;k++){var l=e.cb[k],n=yb(d,[l.Of]),p=void 0;p=null!=e.da?h+e.da:e.S?e.S[k].end:h+b;g.push(new V(k+c,h,p,function(b){return b}.bind(null,n),l.start,l.end));h=p}return g}
function rg(b){return[b.A.Qa,b.aa.Qa,b.ma.Qa].filter(xb.Na).map(function(b){return U.U(b,"SegmentURL")}).reduce(function(b,d){return 0<b.length?b:d}).map(function(c){c.getAttribute("indexRange")&&!b.ie&&(b.ie=!0,B.m("We do not support the SegmentURL@indexRange attribute on SegmentList.  We only use the SegmentList@duration attribute or SegmentTimeline, which must be accurate."));var d=c.getAttribute("media");c=U.M(c,"mediaRange",U.Cc,{start:0,end:null});return{Of:d,start:c.start,end:c.end}})};function tg(b,c,d,e){var f=ug(b);var g=Tf(b,vg);var h=Uf(b,vg,"media"),k=Uf(b,vg,"index");g={da:g.da,timescale:g.timescale,ib:g.ib,oa:g.oa,Pd:g.Pd,S:g.S,kd:h,Yb:k};h=g.Yb?1:0;h+=g.S?1:0;h+=g.da?1:0;if(0==h)throw B.error("SegmentTemplate does not contain any segment information:","the SegmentTemplate must contain either an index URL template","a SegmentTimeline, or a segment duration.",b.A),new D(2,4,4002);1!=h&&(B.m("SegmentTemplate containes multiple segment information sources:","the SegmentTemplate should only contain an index URL template,",
"a SegmentTimeline or a segment duration.",b.A),g.Yb?(B.info("Using the index URL template by default."),g.S=null):B.info("Using the SegmentTimeline by default."),g.da=null);if(!g.Yb&&!g.kd)throw B.error("SegmentTemplate does not contain sufficient segment information:","the SegmentTemplate's media URL template is missing.",b.A),new D(2,4,4002);if(g.Yb){d=b.A.mimeType.split("/")[1];if("mp4"!=d&&"webm"!=d)throw B.error("SegmentTemplate specifies an unsupported container type.",b.A),new D(2,4,4006);
if("webm"==d&&!f)throw B.error("SegmentTemplate does not contain sufficient segment information:","the SegmentTemplate uses a WebM container,","but does not contain an initialization URL template.",b.A),new D(2,4,4005);e=Sf(g.Yb,b.A.id,null,b.bandwidth||null,null);e=yb(b.A.ta,[e]);b=og(b,c,f,e,0,null,d,g.oa)}else g.da?(e||(b.presentationTimeline.od(g.da),b.presentationTimeline.pd(b.W.start)),b=wg(b,g)):(h=c=null,b.ma.id&&b.A.id&&(h=b.ma.id+","+b.A.id,c=d[h]),k=xg(b,g),e=!b.tb||!b.W.hd,c?(e&&bg(new ag(k),
b.W.duration),c.md(k),d=b.presentationTimeline.Wb(),c.Tc(d-b.W.start)):(b.presentationTimeline.Eb(k,b.W.start),c=new ag(k),h&&b.tb&&(d[h]=c)),e&&bg(c,b.W.duration),b={createSegmentIndex:Promise.resolve.bind(Promise),findSegmentPosition:c.find.bind(c),getSegmentReference:c.get.bind(c)});return{createSegmentIndex:b.createSegmentIndex,findSegmentPosition:b.findSegmentPosition,getSegmentReference:b.getSegmentReference,initSegmentReference:f,oa:g.oa}}function vg(b){return b.cc}
function wg(b,c){var d=b.W.duration,e=c.da,f=c.ib,g=c.timescale,h=c.kd,k=b.bandwidth||null,l=b.A.id,n=b.A.ta;return{createSegmentIndex:Promise.resolve.bind(Promise),findSegmentPosition:function(b){return 0>b||d&&b>=d?null:Math.floor(b/e)},getSegmentReference:function(b){var c=b*e,p=c+e;d&&(p=Math.min(p,d));return 0>p||d&&c>=d?null:new V(b,c,p,function(){var d=Sf(h,l,b+f,k,c*g);return yb(n,[d])},0,null)}}}
function xg(b,c){for(var d=[],e=0;e<c.S.length;e++){var f=e+c.ib;d.push(new V(f,c.S[e].start,c.S[e].end,function(b,c,d,e,f,p){b=Sf(b,c,f,d,p);return yb(e,[b]).map(function(b){return b.toString()})}.bind(null,c.kd,b.A.id,b.bandwidth||null,b.A.ta,f,c.S[e].Lg+c.Pd),0,null))}return d}function ug(b){var c=Uf(b,vg,"initialization");if(!c)return null;var d=b.A.id,e=b.bandwidth||null,f=b.A.ta;return new Yf(function(){var b=Sf(c,d,null,e,null);return yb(f,[b])},0,null)};var W={Ib:{},Zb:{},zd:function(b,c){W.Zb[b]=c}};A("shaka.media.ManifestParser.registerParserByExtension",W.zd);W.Lb=function(b,c){W.Ib[b]=c};A("shaka.media.ManifestParser.registerParserByMime",W.Lb);
W.ig=function(){var b={};if(Hc()){for(var c in W.Ib)b[c]=!0;for(var d in W.Zb)b[d]=!0}c={mpd:"application/dash+xml",m3u8:"application/x-mpegurl",ism:"application/vnd.ms-sstr+xml"};d=t(["application/dash+xml","application/x-mpegurl","application/vnd.apple.mpegurl","application/vnd.ms-sstr+xml"]);for(var e=d.next();!e.done;e=d.next())e=e.value,b[e]=Hc()?!!W.Ib[e]:Ic(e);for(var f in c)b[f]=Hc()?!!W.Zb[f]:Ic(c[f]);return b};
W.create=function(b,c,d,e){return u(function g(){var h,k;return x(g,function(g){switch(g.j){case 1:return Ba(g,2),v(g,W.lf(b,c,d,e),4);case 4:return h=g.s,g["return"](new h);case 2:throw k=Ga(g),k.severity=2,k;}})})};
W.lf=function(b,c,d,e){return u(function g(){var h,k,l,n,p;return x(g,function(g){switch(g.j){case 1:h=W;if(e){if(k=h.Ib[e.toLowerCase()])return g["return"](k);B.m("Could not determine manifest type using MIME type ",e)}if(l=h.getExtension(b)){if(n=h.Zb[l])return g["return"](n);B.m("Could not determine manifest type for extension ",l)}else B.m("Could not find extension for ",b);if(e){g.C(2);break}return v(g,h.uf(b,c,d),3);case 3:if(e=g.s){if(p=W.Ib[e])return g["return"](p);B.m("Could not determine manifest type using MIME type",
e)}case 2:throw new D(2,4,4E3,b);}})})};W.uf=function(b,c,d){return u(function f(){var g,h,k;return x(f,function(f){switch(f.j){case 1:return g=mc([b],d),g.method="HEAD",v(f,c.request(0,g).promise,2);case 2:return h=f.s,k=h.headers["content-type"],f["return"](k?k.toLowerCase().split(";").shift():"")}})})};W.getExtension=function(b){b=(new hb(b)).la.split("/").pop().split(".");return 1==b.length?"":b.pop().toLowerCase()};
W.isSupported=function(b,c){return Hc()?c in W.Ib||W.getExtension(b)in W.Zb?!0:!1:!1};function X(b,c,d){this.f=b;this.Dc=c;this.h=this.g=Infinity;this.a=1;this.b=this.c=null;this.l=0;this.o=!0;this.i=0;this.u=void 0===d?!0:d}A("shaka.media.PresentationTimeline",X);X.prototype.ca=function(){return this.g};X.prototype.getDuration=X.prototype.ca;X.prototype.sf=function(){return this.a};X.prototype.getMaxSegmentDuration=X.prototype.sf;X.prototype.Ba=function(b){this.g=b};X.prototype.setDuration=X.prototype.Ba;X.prototype.Af=function(){return this.f};
X.prototype.getPresentationStartTime=X.prototype.Af;X.prototype.Ee=function(b){this.l=b};X.prototype.setClockOffset=X.prototype.Ee;X.prototype.dc=function(b){this.o=b};X.prototype.setStatic=X.prototype.dc;X.prototype.Jd=function(b){this.h=b};X.prototype.setSegmentAvailabilityDuration=X.prototype.Jd;X.prototype.wg=function(b){this.Dc=b};X.prototype.setDelay=X.prototype.wg;X.prototype.jf=function(){return this.Dc};X.prototype.getDelay=X.prototype.jf;
X.prototype.Eb=function(b,c){if(0!=b.length){var d=b[b.length-1].endTime+c;this.pd(b[0].startTime+c);this.a=b.reduce(function(b,c){return Math.max(b,c.endTime-c.startTime)},this.a);this.b=Math.max(this.b,d);null!=this.f&&this.u&&(this.f=(Date.now()+this.l)/1E3-this.b-this.a);B.F("notifySegments:","maxSegmentDuration="+this.a)}};X.prototype.notifySegments=X.prototype.Eb;X.prototype.pd=function(b){this.c=null==this.c?b:Math.min(this.c,b)};X.prototype.notifyMinSegmentStartTime=X.prototype.pd;
X.prototype.od=function(b){this.a=Math.max(this.a,b);B.F("notifyNewSegmentDuration:","maxSegmentDuration="+this.a)};X.prototype.notifyMaxSegmentDuration=X.prototype.od;X.prototype.offset=function(b){null!=this.c&&(this.c+=b);null!=this.b&&(this.b+=b)};X.prototype.offset=X.prototype.offset;X.prototype.X=function(){return Infinity==this.g&&!this.o};X.prototype.isLive=X.prototype.X;X.prototype.bb=function(){return Infinity!=this.g&&!this.o};X.prototype.isInProgress=X.prototype.bb;
X.prototype.Wb=function(){if(Infinity==this.h)return this.i;var b=this.xb()-this.h;return Math.max(this.i,b)};X.prototype.getSegmentAvailabilityStart=X.prototype.Wb;X.prototype.Fe=function(b){this.i=b};X.prototype.setUserSeekStart=X.prototype.Fe;X.prototype.xb=function(){return this.X()||this.bb()?Math.min(Math.max(0,(Date.now()+this.l)/1E3-this.a-this.f),this.g):this.g};X.prototype.getSegmentAvailabilityEnd=X.prototype.xb;
X.prototype.Vb=function(b){var c=Math.max(this.c,this.i);if(Infinity==this.h)return Math.ceil(1E3*c)/1E3;var d=this.xb()-this.h;b=Math.min(d+b,this.Ga());return Math.max(c,b)};X.prototype.getSafeSeekRangeStart=X.prototype.Vb;X.prototype.wb=function(){return this.Vb(0)};X.prototype.getSeekRangeStart=X.prototype.wb;X.prototype.Ga=function(){var b=this.X()||this.bb()?this.Dc:0;return Math.max(0,this.xb()-b)};X.prototype.getSeekRangeEnd=X.prototype.Ga;
X.prototype.Je=function(){return null==this.f||null!=this.b&&this.u?!1:!0};X.prototype.usingPresentationStartTime=X.prototype.Je;function yg(b,c,d,e){b=mc(b,e);if(0!=c||null!=d)b.headers.Range=d?"bytes="+c+"-"+d:"bytes="+c+"-";return b};function zg(){var b=this;this.b=this.a=null;this.f=[];this.c=null;this.l=[];this.h=1;this.o={};this.u=0;this.w=new cb(5);this.i=new I(function(){Ag(b)});this.g=new ic}A("shaka.dash.DashParser",zg);m=zg.prototype;m.configure=function(b){this.a=b};m.start=function(b,c){var d=this;return u(function f(){var g;return x(f,function(f){switch(f.j){case 1:return d.f=[b],d.b=c,v(f,Bg(d),2);case 2:g=f.s;d.b&&Cg(d,g);if(!d.b)throw new D(2,7,7001);return f["return"](d.c)}})})};
m.stop=function(){this.a=this.b=null;this.f=[];this.c=null;this.l=[];this.o={};null!=this.i&&(this.i.stop(),this.i=null);return this.g.destroy()};m.update=function(){Bg(this)["catch"](function(b){if(this.b)this.b.onError(b)}.bind(this))};m.onExpirationUpdated=function(){};
function Bg(b){var c=Date.now(),d=b.b.networkingEngine.request(0,mc(b.f,b.a.retryParameters));jc(b.g,d);return d.promise.then(function(c){if(b.b)return c.uri&&!b.f.includes(c.uri)&&b.f.unshift(c.uri),Dg(b,c.data,c.uri)}).then(function(){var d=(Date.now()-c)/1E3;db(b.w,1,d);return d})}function Dg(b,c,d){c=U.ue(c,"MPD");if(!c)throw new D(2,4,4001,d);c=Xf(c,b.a.retryParameters,b.a.dash.xlinkFailGracefully,d,b.b.networkingEngine);jc(b.g,c);return c.promise.then(function(c){return Eg(b,c,d)})}
function Eg(b,c,d){return u(function f(){var g,h,k,l,n,p,q,r,y,C,z,F,H,R,sa,ba,Ya,Ia,la,Za,ea,ta,Ja,Pa,ua,$a,lb;return x(f,function(f){switch(f.j){case 1:l=xb;n=U;p=[d];q=n.U(c,"Location").map(n.qc).filter(l.Na);0<q.length&&(r=yb(p,q),p=b.f=r);y=n.U(c,"BaseURL").map(n.qc);C=yb(p,y);z=b.a.dash.ignoreMinBufferTime;F=0;z||(F=n.M(c,"minBufferTime",n.Ia));b.u=n.M(c,"minimumUpdatePeriod",n.Ia,-1);H=n.M(c,"availabilityStartTime",n.eg);R=n.M(c,"timeShiftBufferDepth",n.Ia);sa=n.M(c,"maxSegmentDuration",n.Ia);
ba=c.getAttribute("type")||"static";Ya=b.a.dash.ignoreSuggestedPresentationDelay;Ia=null;Ya||(Ia=n.M(c,"suggestedPresentationDelay",n.Ia));b.c?la=b.c.presentationTimeline:(Za=Math.max(b.a.dash.defaultPresentationDelay,1.5*F),ea=null!=Ia?Ia:Za,la=new X(H,ea,b.a.dash.autoCorrectDrift));ta={tb:"static"!=ba,presentationTimeline:la,ma:null,W:null,aa:null,A:null,bandwidth:0,ie:!1};for(var Bb=ta,Cb=C,Db=U.M(c,"mediaPresentationDuration",U.Ia),mb=[],Da=0,nb=U.U(c,"Period"),Ea=0;Ea<nb.length;Ea++){var Eb=
nb[Ea];Da=U.M(Eb,"start",U.Ia,Da);var Ka=U.M(Eb,"duration",U.Ia),ja=null;if(Ea!=nb.length-1){var Ld=U.M(nb[Ea+1],"start",U.Ia);null!=Ld&&(ja=Ld-Da)}else null!=Db&&(ja=Db-Da);Ld=Fb;ja&&Ka&&Math.abs(ja-Ka)>Ld&&B.m("There is a gap/overlap between Periods",Eb);null==ja&&(ja=Ka);Eb=Fg(b,Bb,Cb,{start:Da,duration:ja,node:Eb,hd:null==ja||Ea==nb.length-1});mb.push(Eb);Ka=Bb.ma.id;b.l.includes(Ka)||(b.l.push(Ka),b.c&&(b.b.filterNewPeriod(Eb),b.c.periods.push(Eb)));if(null==ja){Ea!=nb.length-1&&B.m("Skipping Period",
Ea+1,"and any subsequent Periods:","Period",Ea+1,"does not have a valid start time.",mb[Ea+1]);Da=null;break}Da+=ja}null==b.c&&b.b.filterAllPeriods(mb);null!=Db?(Da!=Db&&B.m("@mediaPresentationDuration does not match the total duration of all","Periods."),g=mb,h=Db,k=!1):(g=mb,h=Da,k=!0);Ja=h;Pa=g;la.dc("static"==ba);"static"!=ba&&k||la.Ba(Ja||Infinity);(ua=la.X())&&!isNaN(b.a.availabilityWindowOverride)&&(R=b.a.availabilityWindowOverride);null==R&&(R=Infinity);la.Jd(R);la.od(sa||1);if(b.c){f.C(0);
break}b.c={presentationTimeline:la,periods:Pa,offlineSessionIds:[],minBufferTime:F||0};if(!la.Je()){f.C(0);break}$a=n.U(c,"UTCTiming");return v(f,Gg(b,C,$a),4);case 4:lb=f.s;if(!b.b)return f["return"]();la.Ee(lb);w(f)}})})}
function Fg(b,c,d,e){c.ma=Hg(e.node,null,d);c.W=e;c.ma.id||(B.info("No Period ID given for Period with start time "+e.start+",  Assigning a default"),c.ma.id="__shaka_period_"+e.start);U.U(e.node,"EventStream").forEach(b.fg.bind(b,e.start,e.duration));d=U.U(e.node,"AdaptationSet").map(b.dg.bind(b,c)).filter(xb.Na);if(c.tb){c=[];for(var f=t(d),g=f.next();!g.done;g=f.next()){g=t(g.value.og);for(var h=g.next();!h.done;h=g.next())c.push(h.value)}if(c.length!=(new Set(c)).size)throw new D(2,4,4018);}var k=
d.filter(function(b){return!b.Nd});d.filter(function(b){return b.Nd}).forEach(function(b){var c=b.Nd.split(" ");k.forEach(function(d){c.includes(d.id)&&d.streams.forEach(function(c){c.trickModeVideo=b.streams.find(function(b){return Gc(c.codecs)[0]==Gc(b.codecs)[0]})})})});c=Ig(k,"video");f=Ig(k,"audio");if(!c.length&&!f.length)throw new D(2,4,4004);d=b.a.disableAudio;if(!f.length||d)f=[null];d=b.a.disableVideo;if(!c.length||d)c=[null];d=[];for(g=0;g<f.length;g++)for(h=0;h<c.length;h++)Jg(b,f[g],
c[h],d);c=[];if(!b.a.disableText)for(b=Ig(k,"text"),f=0;f<b.length;f++)c.push.apply(c,b[f].streams);return{startTime:e.start,textStreams:c,variants:d}}function Ig(b,c){return b.filter(function(b){return b.contentType==c})}
function Jg(b,c,d,e){if(c||d)if(c&&d){var f=c.drmInfos;var g=d.drmInfos;if(f.length&&g.length?0<yd(f,g).length:1){g=yd(c.drmInfos,d.drmInfos);for(var h=0;h<c.streams.length;h++)for(var k=0;k<d.streams.length;k++)f=(d.streams[k].bandwidth||0)+(c.streams[h].bandwidth||0),f={id:b.h++,language:c.language,primary:c.jd||d.jd,audio:c.streams[h],video:d.streams[k],bandwidth:f,drmInfos:g,allowedByApplication:!0,allowedByKeySystem:!0},e.push(f)}}else for(g=c||d,h=0;h<g.streams.length;h++)f=g.streams[h].bandwidth||
0,f={id:b.h++,language:g.language||"und",primary:g.jd,audio:c?g.streams[h]:null,video:d?g.streams[h]:null,bandwidth:f,drmInfos:g.drmInfos,allowedByApplication:!0,allowedByKeySystem:!0},e.push(f)}
m.dg=function(b,c){b.aa=Hg(c,b.ma,null);if("image"==b.aa.contentType)return B.m("Skipping Image AdaptationSet",b.aa),null;var d=!1,e=U.U(c,"Role"),f=e.map(function(b){return b.getAttribute("value")}).filter(xb.Na),g=void 0,h="text"==b.aa.contentType;h&&(g="subtitle");for(var k=0;k<e.length;k++){var l=e[k].getAttribute("schemeIdUri");if(null==l||"urn:mpeg:dash:role:2011"==l)switch(l=e[k].getAttribute("value"),l){case "main":d=!0;break;case "caption":case "subtitle":g=l}}var n=null,p=!1;U.U(c,"EssentialProperty").forEach(function(b){"http://dashif.org/guidelines/trickmode"==
b.getAttribute("schemeIdUri")?n=b.getAttribute("value"):p=!0});k=U.U(c,"Accessibility");var q=new Map;e={};k=t(k);for(l=k.next();!l.done;e={Rb:e.Rb},l=k.next()){var r=l.value;l=r.getAttribute("schemeIdUri");r=r.getAttribute("value");"urn:scte:dash:cc:cea-608:2015"==l||"urn:scte:dash:cc:cea-708:2015"==l?(e.Rb=1,null!=r?r.split(";").forEach(function(b){return function(c){if(c.includes("=")){c=c.split("=");var d=c[0].startsWith("CC")?c[0]:"CC"+c[0];c=c[1].split(",")[0].split(":").pop()}else d="CC"+b.Rb,
b.Rb+=2;q.set(d,N(c))}}(e)):q.set("CC1","und")):"urn:mpeg:dash:role:2011"==l&&null!=r&&(f.push(r),"captions"==r&&(g="caption"))}if(p)return null;e=U.U(c,"ContentProtection");var y=Kf(e,this.a.dash.customScheme,this.a.dash.ignoreDrmInfo);e=N(c.getAttribute("lang")||"und");k=c.getAttribute("label");(l=U.U(c,"Label"))&&l.length&&(l=l[0],l.textContent&&(k=l.textContent));l=U.U(c,"Representation");f=l.map(this.gg.bind(this,b,y,g,e,k,d,f,q)).filter(function(b){return!!b});if(0==f.length){if(this.a.dash.ignoreEmptyAdaptationSet||
h)return null;throw new D(2,4,4003);}b.aa.contentType&&"application"!=b.aa.contentType||(b.aa.contentType=Kg(f[0].mimeType,f[0].codecs),f.forEach(function(c){c.type=b.aa.contentType}));f.forEach(function(b){y.drmInfos.forEach(function(c){b.keyId&&c.keyIds.push(b.keyId)})});h=l.map(function(b){return b.getAttribute("id")}).filter(xb.Na);return{id:b.aa.id||"__fake__"+this.h++,contentType:b.aa.contentType,language:e,jd:d,streams:f,drmInfos:y.drmInfos,Nd:n,og:h}};
m.gg=function(b,c,d,e,f,g,h,k,l){b.A=Hg(l,b.aa,null);if(!Lg(b.A))return B.m("Skipping Representation",b.A),null;b.bandwidth=U.M(l,"bandwidth",U.Bc)||0;var n=b.A.contentType;n="text"==n||"application"==n;try{var p=this.pg.bind(this);if(b.A.ac)var q=mg(b,p);else if(b.A.Qa)q=pg(b,this.o);else if(b.A.cc)q=tg(b,p,this.o,!!this.c);else{var r=b.A.ta,y=b.W.duration||0;q={createSegmentIndex:Promise.resolve.bind(Promise),findSegmentPosition:function(b){return 0<=b&&b<y?1:null},getSegmentReference:function(b){return 1!=
b?null:new V(1,0,y,function(){return r},0,null)},initSegmentReference:null,oa:0}}}catch(C){if(n&&4002==C.code)return null;throw C;}l=U.U(l,"ContentProtection");l=Nf(l,this.a.dash.customScheme,c,this.a.dash.ignoreDrmInfo);return{id:this.h++,originalId:b.A.id,createSegmentIndex:q.createSegmentIndex,findSegmentPosition:q.findSegmentPosition,getSegmentReference:q.getSegmentReference,initSegmentReference:q.initSegmentReference,presentationTimeOffset:q.oa,mimeType:b.A.mimeType,codecs:b.A.codecs,frameRate:b.A.frameRate,
pixelAspectRatio:b.A.pixelAspectRatio,bandwidth:b.bandwidth,width:b.A.width,height:b.A.height,kind:d,encrypted:0<c.drmInfos.length,keyId:l,language:e,label:f,type:b.aa.contentType,primary:g,trickModeVideo:null,emsgSchemeIdUris:b.A.emsgSchemeIdUris,roles:h,channelsCount:b.A.qd,audioSamplingRate:b.A.audioSamplingRate,closedCaptions:k}};
function Ag(b){u(function d(){var e,f;return x(d,function(d){switch(d.j){case 1:return B.info("Updating manifest..."),e=0,Ba(d,2),v(d,Bg(b),4);case 4:e=d.s;Fa(d,3);break;case 2:f=Ga(d),b.b&&(f.severity=1,b.b.onError(f));case 3:if(!b.b)return d["return"]();Cg(b,e);w(d)}})})}function Cg(b,c){0>b.u||b.i.R(Math.max(3,b.u-c,eb(b.w)))}
function Hg(b,c,d){c=c||{contentType:"",mimeType:"",codecs:"",emsgSchemeIdUris:[],frameRate:void 0,qd:null,audioSamplingRate:null};d=d||c.ta;var e=U.Hb,f=U.af,g=U.U(b,"BaseURL").map(U.qc),h=b.getAttribute("contentType")||c.contentType,k=b.getAttribute("mimeType")||c.mimeType,l=b.getAttribute("codecs")||c.codecs;f=U.M(b,"frameRate",f)||c.frameRate;var n=b.getAttribute("sar")||c.pixelAspectRatio,p=U.U(b,"InbandEventStream"),q=c.emsgSchemeIdUris.slice();p=t(p);for(var r=p.next();!r.done;r=p.next())r=
r.value.getAttribute("schemeIdUri"),q.includes(r)||q.push(r);p=U.U(b,"AudioChannelConfiguration");p=Mg(p)||c.qd;r=U.M(b,"audioSamplingRate",e)||c.audioSamplingRate;h||(h=Kg(k,l));return{ta:yb(d,g),ac:U.oc(b,"SegmentBase")||c.ac,Qa:U.oc(b,"SegmentList")||c.Qa,cc:U.oc(b,"SegmentTemplate")||c.cc,width:U.M(b,"width",e)||c.width,height:U.M(b,"height",e)||c.height,contentType:h,mimeType:k,codecs:l,frameRate:f,pixelAspectRatio:n,emsgSchemeIdUris:q,id:b.getAttribute("id"),qd:p,audioSamplingRate:r}}
function Mg(b){for(var c=0;c<b.length;++c){var d=b[c],e=d.getAttribute("schemeIdUri");if(e&&(d=d.getAttribute("value")))switch(e){case "urn:mpeg:dash:outputChannelPositionList:2012":return d.trim().split(/ +/).length;case "urn:mpeg:dash:23003:3:audio_channel_configuration:2011":case "urn:dts:dash:audio_channel_configuration:2012":var f=parseInt(d,10);if(!f){B.m("Channel parsing failure! Ignoring scheme and value",e,d);continue}return f;case "tag:dolby.com,2014:dash:audio_channel_configuration:2011":case "urn:dolby:dash:audio_channel_configuration:2011":f=
parseInt(d,16);if(!f){B.m("Channel parsing failure! Ignoring scheme and value",e,d);continue}for(b=0;f;)f&1&&++b,f>>=1;return b;default:B.m("Unrecognized audio channel scheme:",e,d)}}return null}
function Lg(b){var c=b.ac?1:0;c+=b.Qa?1:0;c+=b.cc?1:0;if(0==c){if("text"==b.contentType||"application"==b.contentType)return!0;B.m("Representation does not contain a segment information source:","the Representation must contain one of SegmentBase, SegmentList,",'SegmentTemplate, or explicitly indicate that it is "text".',b);return!1}1!=c&&(B.m("Representation contains multiple segment information sources:","the Representation should only contain one of SegmentBase,","SegmentList, or SegmentTemplate.",
b),b.ac?(B.info("Using SegmentBase by default."),b.Qa=null):B.info("Using SegmentList by default."),b.cc=null);return!0}
function Ng(b,c,d,e){c=yb(c,[d]);c=mc(c,b.a.retryParameters);c.method=e;c=b.b.networkingEngine.request(4,c);jc(b.g,c);return c.promise.then(function(b){if("HEAD"==e){if(!b.headers||!b.headers.date)return B.m("UTC timing response is missing","expected date header"),0;b=b.headers.date}else b=Gb(b.data);b=Date.parse(b);return isNaN(b)?(B.m("Unable to parse date from UTC timing response"),0):b-Date.now()})}
function Gg(b,c,d){d=d.map(function(b){return{scheme:b.getAttribute("schemeIdUri"),value:b.getAttribute("value")}});var e=b.a.dash.clockSyncUri;!d.length&&e&&d.push({scheme:"urn:mpeg:dash:utc:http-head:2014",value:e});return xb.Ze(d,function(b){var d=b.scheme;b=b.value;switch(d){case "urn:mpeg:dash:utc:http-head:2014":case "urn:mpeg:dash:utc:http-head:2012":return Ng(this,c,b,"HEAD");case "urn:mpeg:dash:utc:http-xsdate:2014":case "urn:mpeg:dash:utc:http-iso:2014":case "urn:mpeg:dash:utc:http-xsdate:2012":case "urn:mpeg:dash:utc:http-iso:2012":return Ng(this,
c,b,"GET");case "urn:mpeg:dash:utc:direct:2014":case "urn:mpeg:dash:utc:direct:2012":return d=Date.parse(b),isNaN(d)?0:d-Date.now();case "urn:mpeg:dash:utc:http-ntp:2014":case "urn:mpeg:dash:utc:ntp:2014":case "urn:mpeg:dash:utc:sntp:2014":return B.Y("NTP UTCTiming scheme is not supported"),Promise.reject();default:return B.Y("Unrecognized scheme in UTCTiming element",d),Promise.reject()}}.bind(b))["catch"](function(){B.Y("A UTCTiming element should always be given in live manifests! This content may not play on clients with bad clocks!");
return 0})}m.fg=function(b,c,d){var e=U.Hb,f=d.getAttribute("schemeIdUri")||"",g=d.getAttribute("value")||"",h=U.M(d,"timescale",e)||1;U.U(d,"Event").forEach(function(d){var k=U.M(d,"presentationTime",e)||0,n=U.M(d,"duration",e)||0;k=k/h+b;n=k+n/h;null!=c&&(k=Math.min(k,b+c),n=Math.min(n,b+c));d={schemeIdUri:f,value:g,startTime:k,endTime:n,id:d.getAttribute("id")||"",eventElement:d};this.b.onTimelineRegionAdded(d)}.bind(this))};
m.pg=function(b,c,d){b=yg(b,c,d,this.a.retryParameters);b=this.b.networkingEngine.request(1,b);jc(this.g,b);return b.promise.then(function(b){return b.data})};function Kg(b,c){return ae(Dc(b,c))?"text":b.split("/")[0]}W.zd("mpd",zg);W.Lb("application/dash+xml",zg);W.Lb("video/vnd.mpeg.dash.mpd",zg);function Og(b,c,d,e){this.b=b;this.type=c;this.a=d;this.segments=e||null}function Pg(b,c,d,e){this.id=b;this.name=c;this.a=d;this.value=void 0===e?null:e}Pg.prototype.toString=function(){function b(b){return b.name+"="+(isNaN(Number(b.value))?'"'+b.value+'"':b.value)}var c="#"+this.name,d=this.a?this.a.map(b):[];this.value&&d.unshift(this.value);0<d.length&&(c+=":"+d.join(","));return c};function Qg(b,c){this.name=b;this.value=c}
Pg.prototype.getAttribute=function(b){var c=this.a.filter(function(c){return c.name==b});return c.length?c[0]:null};function Rg(b,c,d){return(b=b.getAttribute(c))?b.value:d||null}function Sg(b,c){this.b=c;this.a=b};var Tg={ub:function(b,c){return b.filter(function(b){return b.name==c})},Ya:function(b,c){var d=Tg.ub(b,c);return d.length?d[0]:null},Xc:function(b,c,d){return b.filter(function(b){var e=b.getAttribute("TYPE");b=b.getAttribute("GROUP-ID");return e.value==c&&b.value==d})},Pc:function(b,c){return yb([b],[c])[0]},gd:function(b){return/^#(?!EXT)/m.test(b)}};function Ug(b){this.b=b;this.a=0}function Vg(b){Wg(b,/[ \t]+/gm)}function Wg(b,c){c.lastIndex=b.a;var d=c.exec(b.b);d=null==d?null:{position:d.index,length:d[0].length,rg:d};if(b.a==b.b.length||null==d||d.position!=b.a)return null;b.a+=d.length;return d.rg}function Xg(b){return b.a==b.b.length?null:(b=Wg(b,/[^ \t\n]*/gm))?b[0]:null};function Yg(){this.a=0}
function Zg(b,c,d){c=Gb(c);c=c.replace(/\r\n|\r(?=[^\n]|$)/gm,"\n").trim();var e=c.split(/\n+/m);if(!/^#EXTM3U($|[ \t\n])/m.test(e[0]))throw new D(2,4,4015);c=0;for(var f=1;f<e.length;f++)if(!Tg.gd(e[f])){var g=$g(b,e[f]);--b.a;if(ah.includes(g.name)){c=1;break}else"EXT-X-STREAM-INF"==g.name&&(f+=1)}f=[];for(g=1;g<e.length;)if(Tg.gd(e[g]))g+=1;else{var h=$g(b,e[g]);if(bh.includes(h.name)){if(1!=c)throw new D(2,4,4017);e=e.splice(g,e.length-g);b=ch(b,d,e,f);return new Og(d,c,f,b)}f.push(h);g+=1;"EXT-X-STREAM-INF"==
h.name&&(h.a.push(new Qg("URI",e[g])),g+=1)}return new Og(d,c,f)}function ch(b,c,d,e){var f=[],g=[];d.forEach(function(d){if(/^(#EXT)/.test(d))d=$g(b,d),ah.includes(d.name)?e.push(d):g.push(d);else{if(Tg.gd(d))return[];d=Tg.Pc(c,d.trim());f.push(new Sg(d,g));g=[]}});return f}
function $g(b,c){var d=b.a++,e=c.match(/^#(EXT[^:]*)(?::(.*))?$/);if(!e)throw new D(2,4,4016,c);var f=e[1],g=e[2];e=[];var h;if(g){g=new Ug(g);var k;(k=Wg(g,/^([^,=]+)(?:,|$)/g))&&(h=k[1]);for(var l=/([^=]+)=(?:"([^"]*)"|([^",]*))(?:,|$)/g;k=Wg(g,l);)e.push(new Qg(k[1],k[2]||k[3]))}return new Pg(d,f,e,h)}var ah="EXT-X-TARGETDURATION EXT-X-MEDIA-SEQUENCE EXT-X-DISCONTINUITY-SEQUENCE EXT-X-PLAYLIST-TYPE EXT-X-MAP EXT-X-I-FRAMES-ONLY EXT-X-ENDLIST".split(" "),bh="EXTINF EXT-X-BYTERANGE EXT-X-DISCONTINUITY EXT-X-PROGRAM-DATE-TIME EXT-X-KEY EXT-X-DATERANGE".split(" ");function dh(b){try{var c=dh.parse(b);return Xb({uri:b,vd:b,data:c.data,headers:{"content-type":c.contentType}})}catch(d){return Vb(d)}}A("shaka.net.DataUriPlugin",dh);
dh.parse=function(b){var c=b.split(":");if(2>c.length||"data"!=c[0])throw B.error("Bad data URI, failed to parse scheme"),new D(2,1,1004,b);c=c.slice(1).join(":").split(",");if(2>c.length)throw B.error("Bad data URI, failed to extract encoding and MIME type"),new D(2,1,1004,b);var d=c[0];b=window.decodeURIComponent(c.slice(1).join(","));c=d.split(";");d=c[0];var e=!1;1<c.length&&"base64"==c[c.length-1]&&(e=!0,c.pop());return{data:e?G.Fa(b).buffer:Kb(b),contentType:d}};lc("data",dh);function eh(){var b=this;this.a=this.f=null;this.ea=1;this.G=new Map;this.V=new Set;this.b=new Map;this.c=null;this.w="";this.u=new Yg;this.T=0;this.h=new I(function(){fh(b)});this.g=gh;this.o=null;this.D=0;this.H=Infinity;this.i=new ic;this.K=[];this.l=new Map;this.$=!1}A("shaka.hls.HlsParser",eh);m=eh.prototype;m.configure=function(b){this.a=b};
m.start=function(b,c){var d=this;return u(function f(){var g,h;return x(f,function(f){switch(f.j){case 1:return d.f=c,v(f,hh(d,mc([b],d.a.retryParameters),0),2);case 2:return g=f.s,d.w=g.uri,v(f,ih(d,g.data),3);case 3:return h=d.T,0<h&&d.h.R(h),f["return"](d.o)}})})};m.stop=function(){this.h&&(this.h.stop(),this.h=null);var b=[];this.i&&(b.push(this.i.destroy()),this.i=null);this.a=this.f=null;this.G.clear();this.V.clear();this.b.clear();this.o=null;return Promise.all(b)};
m.update=function(){if(this.g!=jh.Va){for(var b=[],c=t(this.b.values()),d=c.next();!d.done;d=c.next())b.push(kh(this,d.value));return Promise.all(b)}};
function kh(b,c){return u(function e(){var f,g,h,k,l,n,p,q,r,y,C;return x(e,function(e){switch(e.j){case 1:return f=Tg,g=jh,h=c.Re,v(e,hh(b,mc([h],b.a.retryParameters),0),2);case 2:k=e.s;l=Zg(b.u,k.data,k.uri);if(1!=l.type)throw new D(2,4,4017);p=(n=f.Ya(l.a,"EXT-X-MEDIA-SEQUENCE"))?Number(n.value):0;q=c.stream;return v(e,lh(b,c.Jc,l,p,q.mimeType,q.codecs),3);case 3:r=e.s;c.bc.a=r;y=r[r.length-1];if(C=f.Ya(l.a,"EXT-X-ENDLIST"))mh(b,g.Va),b.c.Ba(y.endTime);w(e)}})})}m.onExpirationUpdated=function(){};
function ih(b,c){return u(function e(){var f,g,h,k,l,n,p,q,r,y,C;return x(e,function(e){switch(e.j){case 1:f=Zg(b.u,c,b.w);if(0!=f.type)throw new D(2,4,4022);return v(e,nh(b,f),2);case 2:g=e.s;if(!b.f)throw new D(2,7,7001);if(b.$&&0==g.variants.length)throw B.info("No stream is created, because we don't support AES-128","encryption yet"),new D(2,4,4034);b.f.filterAllPeriods([g]);h=Infinity;k=0;l=Infinity;for(var F=t(b.b.values()),z=F.next();!z.done;z=F.next())n=z.value,h=Math.min(h,n.nd),k=Math.max(k,
n.nd),"text"!=n.stream.type&&(l=Math.min(l,n.duration));b.g!=jh.Va?(b.c=new X(0,3*b.D),b.c.dc(!1)):(b.c=new X(null,0),b.c.dc(!0));oh(b);if(b.g!=jh.Va){b.T=b.H;p=jh;b.g==p.Rd&&(q=b.c.Dc,isNaN(b.a.availabilityWindowOverride)||(q=b.a.availabilityWindowOverride),b.c.Jd(q));for(r=0;95443.7176888889<=k;)r+=95443.7176888889,k-=95443.7176888889;if(r)for(B.debug("Offsetting live streams by",r,"to compensate for rollover"),F=t(b.b.values()),z=F.next();!z.done;z=F.next())y=z.value,95443.7176888889>y.nd?(B.F("Offset applied to",
y.stream.type),y.stream.presentationTimeOffset=-r,y.bc.offset(r)):B.F("Offset NOT applied to",y.stream.type)}else for(b.c.Ba(l),b.c.offset(-h),F=t(b.b.values()),z=F.next();!z.done;z=F.next())C=z.value,C.stream.presentationTimeOffset=h,C.bc.offset(-h),bg(C.bc,l);b.o={presentationTimeline:b.c,periods:[g],offlineSessionIds:[],minBufferTime:0};w(e)}})})}
function nh(b,c){return u(function e(){var f,g,h,k,l,n,p,q,r,y,C,z;return x(e,function(e){switch(e.j){case 1:return f=Tg,g=xb,h=c.a,k=f.ub(c.a,"EXT-X-MEDIA"),l=k.filter(function(b){return"SUBTITLES"==ph(b,"TYPE")}.bind(b)),n=l.map(function(b){var c=this;return u(function ba(){var e;return x(ba,function(f){switch(f.j){case 1:if(c.a.disableText)return f["return"](null);Ba(f,2);return v(f,qh(c,b),4);case 4:return f["return"](f.s);case 2:e=Ga(f);if(c.a.hls.ignoreTextStreamFailures)return f["return"](null);
throw e;}})})}.bind(b)),p=k.filter(function(b){return"CLOSED-CAPTIONS"==ph(b,"TYPE")}),rh(b,p),v(e,Promise.all(n),2);case 2:return q=e.s,r=f.ub(h,"EXT-X-STREAM-INF"),y=r.map(function(b){return sh(this,b,c)}.bind(b)),v(e,Promise.all(y),3);case 3:return C=e.s,z=C.reduce(g.Oc,[]),z=z.filter(function(b){return null!=b}),e["return"]({startTime:0,variants:z,textStreams:q.filter(function(b){return null!=b})})}})})}
function sh(b,c,d){return u(function f(){var g,h,k,l,n,p,q,r,y,C,z,F,H,R,sa,ba,Ya,Ia,la,Za,ea,ta,Ja,Pa,ua,$a,lb,dc,Bb;return x(f,function(f){switch(f.j){case 1:g=Ab;h=Tg;k=[];b.a.disableVideo||k.push("avc1.42E01E");b.a.disableAudio||k.push("mp4a.40.2");l=k.join(",");n=Rg(c,"CODECS",l);p=th(n.split(/\s*,\s*/));q=c.getAttribute("RESOLUTION");y=r=null;C=Rg(c,"FRAME-RATE");z=Number(ph(c,"BANDWIDTH"));q&&(F=q.value.split("x"),r=F[0],y=F[1]);H=h.ub(d.a,"EXT-X-MEDIA");H=H.filter(function(b){return"CLOSED-CAPTIONS"!=
ph(b,"TYPE")});H=H.filter(function(b){var c=Rg(b,"URI")||"";return"SUBTITLES"==(Rg(b,"TYPE")||"")||""!=c});R=Rg(c,"AUDIO");sa=Rg(c,"VIDEO");R?H=h.Xc(H,"AUDIO",R):sa&&(H=h.Xc(H,"VIDEO",sa));if(ba=uh(g.va,p)){if(Ya=Rg(c,"SUBTITLES"))if(Ia=h.Xc(H,"SUBTITLES",Ya),Ia.length&&(la=b.G.get(Ia[0].id)))la.stream.codecs=ba;fc(p,ba)}Za=H.map(function(b){return vh(this,b,p)}.bind(b));ea=[];ta=[];return v(f,Promise.all(Za),2);case 2:Pa=f.s;Pa=Pa.filter(function(b){return null!=b});R?ea=Pa:sa&&(ta=Pa);B.debug("Guessing stream type for",
c.toString());$a=!1;ea.length||ta.length?ea.length?(dc=ph(c,"URI"),Bb=ea[0].Jc,dc==Bb?(B.debug("Guessing audio-only."),ua=g.Nb,$a=!0):(B.debug("Guessing video."),ua=g.Ua)):(B.debug("Guessing audio."),ua=g.Nb):1==p.length?(lb=uh(g.Ua,p),q||C||lb?(B.debug("Guessing video-only."),ua=g.Ua):(B.debug("Guessing audio-only."),ua=g.Nb)):(B.debug("Guessing multiplexed audio+video."),ua=g.Ua,p=[p.join(",")]);if($a){f.C(3);break}return v(f,wh(b,c,p,ua),4);case 4:Ja=f.s;case 3:if(Ja)Ja.stream.type==g.Nb?ea=[Ja]:
ta=[Ja];else if(null===Ja)return B.debug("streamInfo is null"),f["return"]([]);ta&&xh(ta);ea&&xh(ea);return f["return"](yh(b,ea,ta,z,r,y,C))}})})}function xh(b){b.forEach(function(b){if(b){var c=b.stream.codecs.split(",");c=c.filter(function(b){return"mp4a.40.34"!=b});b.stream.codecs=c.join(",")}})}
function yh(b,c,d,e,f,g,h){d.forEach(function(b){if(b=b.stream)b.width=Number(f)||void 0,b.height=Number(g)||void 0,b.frameRate=Number(h)||void 0}.bind(b));var k=b.a?b.a.disableAudio:!1;if(!c.length||k)c=[null];k=b.a?b.a.disableVideo:!1;if(!d.length||k)d=[null];k=[];c=t(c);for(var l=c.next();!l.done;l=c.next()){l=l.value;for(var n=t(d),p=n.next();!p.done;p=n.next()){var q=p.value;p=l?l.stream:null;var r=q?q.stream:null,y=l?l.drmInfos:null,C=q?q.drmInfos:null;q=(q?q.Jc:"")+" - "+(l?l.Jc:"");var z=
void 0;if(p&&r)if(y.length&&C.length?0<yd(y,C).length:1)z=yd(y,C);else{B.m("Incompatible DRM info in HLS variant.  Skipping.");continue}else p?z=y:r&&(z=C);b.V.has(q)?B.debug("Skipping variant which only differs in text streams."):(p=zh(b,p,r,e,z),k.push(p),b.V.add(q))}}return k}function zh(b,c,d,e,f){return{id:b.ea++,language:c?c.language:"und",primary:!!c&&c.primary||!!d&&d.primary,audio:c,video:d,bandwidth:e,drmInfos:f,allowedByApplication:!0,allowedByKeySystem:!0}}
function qh(b,c){return u(function e(){var f;return x(e,function(e){switch(e.j){case 1:return ph(c,"TYPE"),v(e,vh(b,c,[]),2);case 2:return f=e.s,e["return"](f.stream)}})})}function rh(b,c){for(var d=t(c),e=d.next();!e.done;e=d.next()){e=e.value;ph(e,"TYPE");var f=Rg(e,"LANGUAGE")||"und";f=N(f);var g=ph(e,"GROUP-ID");e=ph(e,"INSTREAM-ID");b.l.get(g)||b.l.set(g,new Map);b.l.get(g).set(e,f)}}
function vh(b,c,d){return u(function f(){var g,h,k,l,n,p,q,r,y,C,z;return x(f,function(f){switch(f.j){case 1:g=ph(c,"URI");if(b.b.has(g))return f["return"](b.b.get(g));h=ph(c,"TYPE").toLowerCase();k=Ab;"subtitles"==h&&(h=k.va);l=N(Rg(c,"LANGUAGE","und"));n=Rg(c,"NAME");p=c.getAttribute("DEFAULT");q="YES"==p;r=Rg(c,"CHANNELS");if("audio"==h)if(r){var F=r.split("/")[0];F=parseInt(F,10)}else F=null;else F=null;y=F;C=Rg(c,"CHARACTERISTICS");return v(f,Ah(b,g,d,h,l,q,n,y,null,C),2);case 2:z=f.s;if(b.b.has(g))return f["return"](b.b.get(g));
if(null==z)return f["return"](null);b.G.set(c.id,z);b.b.set(g,z);return f["return"](z)}})})}
function wh(b,c,d,e){return u(function g(){var h,k,l,n,p;return x(g,function(g){switch(g.j){case 1:h=Ab;k=ph(c,"URI");if(b.b.has(k))return g["return"](b.b.get(k));l=Rg(c,"CLOSED-CAPTIONS");n=null;e==h.Ua&&l&&"NONE"!=l&&(n=b.l.get(l));return v(g,Ah(b,k,d,e,"und",!1,null,null,n,null),2);case 2:p=g.s;if(null==p)return g["return"](null);if(b.b.has(k))return g["return"](b.b.get(k));b.b.set(k,p);return g["return"](p)}})})}
function Ah(b,c,d,e,f,g,h,k,l,n){return u(function q(){var r,y,C,z,F,H,R,sa,ba,Ya,Ia,la,Za,ea,ta,Ja,Pa,ua,$a,lb,dc,Bb,Cb,Db,mb,Da,nb,Ea;return x(q,function(q){switch(q.j){case 1:return r=Tg,y=r.Pc(b.w,c),v(q,hh(b,mc([y],b.a.retryParameters),0),2);case 2:C=q.s;y=C.uri;z=Zg(b.u,C.data,y);if(1!=z.type)throw new D(2,4,4017);F=[];z.segments.forEach(function(b){b=r.ub(b.b,"EXT-X-KEY");F.push.apply(F,b)});H=!1;R=[];sa=null;for(var Ka=t(F),ja=Ka.next();!ja.done;ja=Ka.next())if(ba=ja.value,Ya=ph(ba,"METHOD"),
"NONE"!=Ya){H=!0;if("AES-128"==Ya)return B.m("Unsupported HLS Encryption",Ya),b.$=!0,q["return"](null);Ia=ph(ba,"KEYFORMAT");(Za=(la=Bh[Ia])?la(ba):null)?(Za.keyIds.length&&(sa=Za.keyIds[0]),R.push(Za)):B.m("Unsupported HLS KEYFORMAT",Ia)}if(H&&!R.length)throw new D(2,4,4026);Ch(b,z);ea=Dh(e,d);return v(q,Eh(b,e,ea,z),3);case 3:return ta=q.s,Fh.includes(ta)&&(ea=""),Pa=(Ja=r.Ya(z.a,"EXT-X-MEDIA-SEQUENCE"))?Number(Ja.value):0,Ba(q,4),v(q,lh(b,c,z,Pa,ta,ea),6);case 6:ua=q.s;Fa(q,5);break;case 4:$a=
Ga(q);if(4035==$a.code)return B.Y("Skipping unsupported HLS stream",ta,c),q["return"](null);throw $a;case 5:lb=ua[0].startTime;dc=ua[ua.length-1].endTime;Bb=dc-lb;Cb=new ag(ua);Db=Gh(z);mb=void 0;"text"==e&&(mb="subtitle");Da=[];if(n)for(Ka=t(n.split(",")),ja=Ka.next();!ja.done;ja=Ka.next())nb=ja.value,Da.push(nb);Ea={id:b.ea++,originalId:h,createSegmentIndex:Promise.resolve.bind(Promise),findSegmentPosition:Cb.find.bind(Cb),getSegmentReference:Cb.get.bind(Cb),initSegmentReference:Db,presentationTimeOffset:0,
mimeType:ta,codecs:ea,kind:mb,encrypted:H,keyId:sa,language:f,label:h,type:e,primary:g,trickModeVideo:null,emsgSchemeIdUris:null,frameRate:void 0,pixelAspectRatio:void 0,width:void 0,height:void 0,bandwidth:void 0,roles:Da,channelsCount:k,audioSamplingRate:null,closedCaptions:l};return q["return"]({stream:Ea,bc:Cb,drmInfos:R,Jc:c,Re:y,nd:lb,Ug:dc,duration:Bb})}})})}
function Ch(b,c){var d=jh,e=Tg.Ya(c.a,"EXT-X-PLAYLIST-TYPE"),f=Tg.Ya(c.a,"EXT-X-ENDLIST");f=e&&"VOD"==e.value||f;e=e&&"EVENT"==e.value&&!f;e=!f&&!e;f?mh(b,d.Va):(e?mh(b,d.Rd):mh(b,d.Me),d=Hh(c.a,"EXT-X-TARGETDURATION"),d=Number(d.value),b.D=Math.max(d,b.D),b.H=Math.min(d,b.H))}
function Gh(b){var c=Tg.ub(b.a,"EXT-X-MAP");if(!c.length)return null;if(1<c.length)throw new D(2,4,4020);c=c[0];var d=ph(c,"URI"),e=Tg.Pc(b.b,d);b=0;d=null;if(c=Rg(c,"BYTERANGE"))b=c.split("@"),c=Number(b[0]),b=Number(b[1]),d=b+c-1;return new Yf(function(){return[e]},b,d)}
function Ih(b,c,d,e){var f=c.b,g=c.a;c=Hh(f,"EXTINF").value.split(",");c=e+Number(c[0]);var h=0,k=null;if(f=Tg.Ya(f,"EXT-X-BYTERANGE"))h=f.value.split("@"),f=Number(h[0]),h=h[1]?Number(h[1]):b.a+1,k=h+f-1;return new V(d,e,c,function(){return[g]},h,k)}function oh(b){b.c&&(b.K.forEach(function(c){b.c.Eb(c,0)}),b.K=[])}
function lh(b,c,d,e,f,g){return u(function k(){var l,n,p,q,r,y,C,z,F,H,R;return x(k,function(k){switch(k.j){case 1:return l=d.segments,n=[],p=l[0].a,q=Ih(null,l[0],e,0),r=Gh(d),v(k,Jh(b,c,r,q,f,g),2);case 2:y=k.s;B.debug("First segment",p.split("/").pop(),"starts at",y);for(var ba=0;ba<l.length;++ba)C=l[ba],z=n[n.length-1],F=0==ba?y:z.endTime,H=e+ba,R=Ih(z,C,H,F),n.push(R);b.K.push(n);oh(b);return k["return"](n)}})})}
function Kh(b,c){return u(function e(){var f,g,h,k,l,n;return x(e,function(e){switch(e.j){case 1:f=1;g=yg(c.c(),c.b,c.b+2048-1,b.a.retryParameters);h=yg(c.c(),c.b,c.a,b.a.retryParameters);if(b.a.hls.useFullSegmentsForStartTime)return e["return"](hh(b,h,f));Ba(e,2);return v(e,hh(b,g,f),4);case 4:return k=e.s,e["return"](k);case 2:l=Ga(e);if(7001==l.code)throw l;B.Y("Unable to fetch a partial HLS segment! Falling back to a full segment request, which is expensive!  Your server should support Range requests and CORS preflights.",
g.uris[0]);return v(e,hh(b,h,f),5);case 5:return n=e.s,e["return"](n)}})})}
function Jh(b,c,d,e,f,g){return u(function k(){var l,n,p,q,r,y,C,z,F;return x(k,function(k){switch(k.j){case 1:if(b.o){l=b.b.get(c);n=l.bc;if(p=n.get(e.position))return B.F("Found segment start time in previous manifest"),k["return"](p.startTime);B.debug("Unable to find segment start time in previous manifest!")}B.F("Fetching segment to find start time");f=f.toLowerCase();if(Fh.includes(f))throw B.Y("Raw formats are not yet supported.  Skipping "+f),new D(1,4,4035);if("video/webm"==f)throw B.Y("WebM in HLS is not yet supported.  Skipping."),
new D(1,4,4035);if("video/mp4"!=f&&"audio/mp4"!=f){k.C(2);break}q=[Kh(b,e)];d&&q.push(Kh(b,d));return v(k,Promise.all(q),3);case 3:return r=k.s,y=r[0],C=r[1]||r[0],k["return"](Lh(c,y.uri,y.data,C.data));case 2:if("video/mp2t"!=f){k.C(4);break}return v(k,Kh(b,e),5);case 5:return z=k.s,k["return"](Mh(c,z.uri,z.data));case 4:if("application/mp4"!=f&&!f.startsWith("text/")){k.C(6);break}return v(k,Kh(b,e),7);case 7:return F=k.s,k["return"](Nh(f,g,F.data));case 6:throw new D(2,4,4030,c);}})})}
function Lh(b,c,d,e){var f=0;(new T).L("moov",Df).L("trak",Df).L("mdia",Df).ia("mdhd",function(b){b.reader.P(0==b.version?8:16);f=b.reader.I();b.parser.stop()}).parse(e,!0);if(!f)throw B.error("Unable to find timescale in init segment!"),new D(2,4,4030,b,c);var g=0,h=!1;(new T).L("moof",Df).L("traf",Df).ia("tfdt",function(b){g=(0==b.version?b.reader.I():b.reader.Kb())/f;h=!0;b.parser.stop()}).parse(d,!0);if(!h)throw new D(2,4,4030,b,c);return g}
function Mh(b,c,d){function e(){g.seek(h+188);k=g.na();71!=k&&(g.seek(h+192),k=g.na());71!=k&&(g.seek(h+204),k=g.na());71!=k&&f();g.Ae(1)}function f(){throw new D(2,4,4030,b,c);}for(var g=new S(new DataView(d),0),h=0,k=0;;)if(h=g.ga(),k=g.na(),71!=k&&f(),d=g.$b(),8191==(d&8191))e();else if(d&16384)if(d=(g.na()&48)>>4,0!=d&&2!=d||f(),3==d&&(d=g.na(),g.P(d)),1!=g.I()>>8)e();else{g.P(3);d=g.na()>>6;0!=d&&1!=d||f();0==g.na()&&f();d=g.na();var l=g.$b(),n=g.$b();return(1073741824*((d&14)>>1)+((l&65534)<<
14|(n&65534)>>1))/9E4}else e()}function Nh(b,c,d){b=Dc(b,c);if(!ae(b))return 0;c=new Zd(null);be(c,b);return c.sc(d)}function th(b){var c=new Set,d=[];b=t(b);for(var e=b.next();!e.done;e=b.next()){e=e.value;var f=Gc(e)[0];c.has(f)?B.debug("Ignoring duplicate codec"):(d.push(e),c.add(f))}return d}function uh(b,c){for(var d=Oh[b],e=0;e<d.length;e++)for(var f=0;f<c.length;f++)if(d[e].test(c[f].trim()))return c[f].trim();return"text"==b?"":null}
function Dh(b,c){if(1==c.length)return c[0];var d=uh(b,c);if(null!=d)return d;throw new D(2,4,4025,c);}
function Eh(b,c,d,e){return u(function g(){var h,k,l,n,p,q,r,y,C;return x(g,function(g){switch(g.j){case 1:h=Ab;k=e.segments[0].a;l=new hb(k);n=l.la.split(".").pop();p=Ph[c];if(q=p[n])return g["return"](q);if(c==h.va)return d&&"vtt"!=d&&"wvtt"!=d?g["return"]("application/mp4"):g["return"]("text/vtt");r=mc([k],b.a.retryParameters);r.method="HEAD";return v(g,hh(b,r,1),2);case 2:y=g.s;C=y.headers["content-type"];if(!C)throw new D(2,4,4021,n);return g["return"](C.split(";")[0])}})})}
function ph(b,c){var d=b.getAttribute(c);if(!d)throw new D(2,4,4023,c);return d.value}function Hh(b,c){var d=Tg.Ya(b,c);if(!d)throw new D(2,4,4024,c);return d}
var Oh={audio:[/^vorbis$/,/^opus$/,/^flac$/,/^mp4a/,/^[ae]c-3$/],video:[/^avc/,/^hev/,/^hvc/,/^vp0?[89]/,/^av1$/],text:[/^vtt$/,/^wvtt/,/^stpp/]},Fh=["audio/aac","audio/ac3","audio/ec3","audio/mpeg"],Ph={audio:{mp4:"audio/mp4",mp4a:"audio/mp4",m4s:"audio/mp4",m4i:"audio/mp4",m4a:"audio/mp4",m4f:"audio/mp4",cmfa:"audio/mp4",ts:"video/mp2t",aac:"audio/aac",ac3:"audio/ac3",ec3:"audio/ec3",mp3:"audio/mpeg"},video:{mp4:"video/mp4",mp4v:"video/mp4",m4s:"video/mp4",m4i:"video/mp4",m4v:"video/mp4",m4f:"video/mp4",
cmfv:"video/mp4",ts:"video/mp2t"},text:{mp4:"application/mp4",m4s:"application/mp4",m4i:"application/mp4",m4f:"application/mp4",cmft:"application/mp4",vtt:"text/vtt",ttml:"application/ttml+xml"}};function fh(b){u(function d(){var e,f;return x(d,function(d){switch(d.j){case 1:B.info("Updating manifest...");if(!b.f)return d["return"]();Ba(d,2);return v(d,b.update(),4);case 4:e=b.T;b.h.R(e);Fa(d,0);break;case 2:f=Ga(d);if(!b.f)return d["return"]();f.severity=1;b.f.onError(f);b.h.R(.1);w(d)}})})}
function mh(b,c){b.g=c;b.c&&b.c.dc(b.g==jh.Va);b.g!=jh.Va||b.h.stop()}function hh(b,c,d){if(!b.i)throw new D(2,7,7001);c=b.f.networkingEngine.request(d,c);jc(b.i,c);return c.promise}
var Bh={"urn:uuid:edef8ba9-79d6-4ace-a3c8-27dcd51d21ed":function(b){var c=ph(b,"METHOD");De("HLS SAMPLE-AES-CENC","SAMPLE-AES-CENC will no longer be supported, see Issue #1227");var d=["SAMPLE-AES","SAMPLE-AES-CTR","SAMPLE-AES-CENC"];if(!d.includes(c))return B.error("Widevine in HLS is only supported with [",d.join(", "),"], not",c),null;c=ph(b,"URI");c=dh.parse(c);c=new Uint8Array(c.data);c=zb("com.widevine.alpha",[{initDataType:"cenc",initData:c}]);if(b=Rg(b,"KEYID"))c.keyIds=[b.toLowerCase().substr(2)];
return c}},gh="VOD",jh={Va:gh,Me:"EVENT",Rd:"LIVE"};W.zd("m3u8",eh);W.Lb("application/x-mpegurl",eh);W.Lb("application/vnd.apple.mpegurl",eh);function Qh(){this.a=new Map}function Rh(b,c,d){Sh(b,c).text=d}function Sh(b,c){b.a.has(c)||b.a.set(c,new Th);return b.a.get(c)}function Th(){this.text=this.variant=null};function Uh(b,c){this.a=b;this.b=new Set([b]);c=c||[];for(var d=t(c),e=d.next();!e.done;e=d.next())this.add(e.value)}Uh.prototype.add=function(b){if(Vh(this.a,b))return this.b.add(b),!0;B.m("Rejecting variant - not compatible with root.");return!1};
function Vh(b,c){var d;if(!(d=!!b.audio!=!!c.audio||!!b.video!=!!c.video||b.language!=c.language)&&(d=b.audio&&c.audio)){d=b.audio;var e=c.audio;d=!(d.channelsCount==e.channelsCount&&Wh(d,e)&&Xh(d.roles,e.roles))}!d&&(d=b.video&&c.video)&&(d=b.video,e=c.video,d=!(Wh(d,e)&&Xh(d.roles,e.roles)));return d?!1:!0}Uh.prototype.values=function(){return this.b.values()};
function Wh(b,c){if(b.mimeType!=c.mimeType)return!1;var d=b.codecs.split(",").map(function(b){return Gc(b)[0]}),e=c.codecs.split(",").map(function(b){return Gc(b)[0]});if(d.length!=e.length)return!1;d.sort();e.sort();for(var f=0;f<d.length;f++)if(d[f]!=e[f])return!1;return!0}function Xh(b,c){var d=new Set(b),e=new Set(c);d["delete"]("main");e["delete"]("main");if(d.size!=e.size)return!1;d=t(d);for(var f=d.next();!f.done;f=d.next())if(!e.has(f.value))return!1;return!0};function Yh(b){this.a=b;this.b=new Zh(b.language,"",b.audio&&b.audio.channelsCount?b.audio.channelsCount:0,"")}Yh.prototype.create=function(b){var c=this,d=b.filter(function(b){return Vh(c.a,b)});return d.length?new Uh(d[0],d):this.b.create(b)};function Zh(b,c,d,e){this.c=b;this.f=c;this.a=d;this.b=void 0===e?"":e}
Zh.prototype.create=function(b){var c=[];c=$h(b,this.c);var d=b.filter(function(b){return b.primary});c=c.length?c:d.length?d:b;b=ai(c,this.f);b.length?c=b:B.m("No exact match for variant role could be found.");this.a&&(b=O.$d(c,this.a),b.length?c=b:B.m("No exact match for the channel count could be found."));this.b&&(b=bi(c,this.b),b.length?c=b:B.m("No exact match for variant label could be found."));b=new Uh(c[0]);c=t(c);for(d=c.next();!d.done;d=c.next())d=d.value,Vh(b.a,d)&&b.add(d);return b};
function $h(b,c){var d=N(c),e=Ae(d,b.map(function(b){return ze(b)}));return e?b.filter(function(b){return e==ze(b)}):[]}function ai(b,c){return b.filter(function(b){return b.audio?c?b.audio.roles.includes(c):0==b.audio.roles.length:!1})}function bi(b,c){return b.filter(function(b){return b.audio?b.audio.label.toLowerCase()==c.toLowerCase():!1})};function ci(){this.a=di;this.b=(new Map).set(di,2).set(ei,1)}function fi(b,c,d){b.b.set(di,d).set(ei,c)}var ei=0,di=1;function gi(b,c){this.g=b;this.h=hi(b);this.a=b.a.currentTime;this.f=Date.now()/1E3;this.b=!1;this.i=c;this.c=function(){}}gi.prototype.release=function(){this.g=null;this.c=function(){}};function ii(b,c){b.c=c}function ji(b){this.a=b}function hi(b){if(b.a.paused||0==b.a.playbackRate||0==b.a.buffered.length)var c=!1;else a:{c=b.a.buffered;b=b.a.currentTime;for(var d=0;d<c.length;d++){var e=c.start(d),f=c.end(d);if(!(b<e-.1||b>f-.5)){c=!0;break a}}c=!1}return c};function ki(b,c,d,e,f){var g=this;this.a=b;this.w=c;this.u=d;this.l=f;this.f=new M;this.i=!1;this.o=b.readyState;this.c=!1;this.b=e;this.h=!1;this.f.B(b,"waiting",function(){return li(g)});this.g=(new I(function(){li(g)})).Ka(.25)}ki.prototype.release=function(){this.f&&(this.f.release(),this.f=null);null!=this.g&&(this.g.stop(),this.g=null);this.b&&(this.b.release(),this.b=null);this.a=this.w=this.l=null};ki.prototype.td=function(){this.h=!0;li(this)};
function li(b){if(0!=b.a.readyState){if(b.a.seeking){if(!b.i)return}else b.i=!1;if(!b.a.paused||0==b.a.currentTime){b.a.readyState!=b.o&&(b.c=!1,b.o=b.a.readyState);var c;if(!(c=!b.b)){c=b.b;var d=c.g,e=hi(d),f=d.a.currentTime,g=Date.now()/1E3;if(c.a!=f||c.h!=e)c.f=g,c.a=f,c.h=e,c.b=!1;f=g-c.f;if(e=f>=c.i&&e&&!c.b)c.c(c.a,f),c.b=!0,c.a=d.a.currentTime;c=!e}if(c){g=b.u.smallGapLimit;c=b.a.currentTime;d=b.a.buffered;a:{if(d&&d.length&&!(1==d.length&&1E-6>d.end(0)-d.start(0)))for(e=navigator.userAgent.match(/Edge\//)||
Lc("Trident/")||Kc()||Lc("CrKey")?.5:.1,f=0;f<d.length;f++)if(d.start(f)>c&&(0==f||d.end(f-1)-c<=e)){e=f;break a}e=null}if(null!=e&&(0!=e||b.h)){f=d.start(e);var h=b.w.Ga();if(!(f>=h)){h=f-c;g=h<=g;var k=!1;if(!(.001>h)){if(!g&&!b.c){b.c=!0;var l=new K("largegap",{currentTime:c,gapSize:h});l.cancelable=!0;b.l(l);b.u.jumpLargeGaps&&!l.defaultPrevented?k=!0:B.info("Ignoring large gap at",c,"size",h)}if(g||k)0==e?B.info("Jumping forward",h,"seconds because of gap before start time of",f):B.info("Jumping forward",
h,"seconds because of gap starting at",d.end(e-1),"and ending at",f),b.a.currentTime=f}}}}}}};function mi(b){var c=this;this.c=b;this.a=new Set;this.b=(new I(function(){ni(c,!1)})).Ka(.25)}mi.prototype.release=function(){this.b.stop();for(var b=t(this.a),c=b.next();!c.done;c=b.next())c.value.release();this.a.clear()};function ni(b,c){for(var d=t(b.a),e=d.next();!e.done;e=d.next())e.value.g(b.c.currentTime,c)};function oi(b){var c=[];b=t(b);for(var d=b.next();!d.done;d=b.next()){d=t(d.value.variants);for(var e=d.next();!e.done;e=d.next())c.push(e.value)}return c}function pi(b,c){for(var d=null,e=t(b),f=e.next();!f.done;f=e.next())f=f.value,c>=f.startTime&&(d=f);return d};function qi(b){this.c=b;this.a=null;this.b=function(){}}qi.prototype.release=function(){this.a=this.c=null;this.b=function(){}};qi.prototype.g=function(b){var c=this.a,d=this.c.periods;b=pi(d,b)||d[0];c!=b&&this.b(b);this.a=b};function ri(b,c){b.b=c};function si(b){var c=this;this.a=b;this.f=!1;this.c=this.a.rc();this.b=new I(function(){c.a.me(.25*c.c)})}si.prototype.release=function(){this.b&&(this.b.stop(),this.b=null);this.a=null};si.prototype.set=function(b){this.c=b;ti(this)};function ti(b){b.b.stop();var c=b.f?0:b.c;if(0<=c)try{b.a.rc()!=c&&b.a.Id(c);return}catch(d){}b.b.Ka(.25);0!=b.a.rc()&&b.a.Id(0)};/*

 Copyright 2016 Google LLC
 SPDX-License-Identifier: Apache-2.0
*/
function ui(b,c,d,e){c==HTMLMediaElement.HAVE_NOTHING||b.readyState>=c?e():(c=vi.get(c),d.ua(b,c,e))}var vi=new Map([[HTMLMediaElement.HAVE_METADATA,"loadedmetadata"],[HTMLMediaElement.HAVE_CURRENT_DATA,"loadeddata"],[HTMLMediaElement.HAVE_FUTURE_DATA,"canplay"],[HTMLMediaElement.HAVE_ENOUGH_DATA,"canplaythrough"]]);function wi(b,c,d){var e=this;this.a=b;this.g=c;this.f=d;this.h=!1;this.b=new M;this.c=new xi(b);ui(this.a,HTMLMediaElement.HAVE_METADATA,this.b,function(){yi(e,e.f)})}wi.prototype.release=function(){this.b&&(this.b.release(),this.b=null);null!=this.c&&(this.c.release(),this.c=null);this.g=function(){};this.a=null};function zi(b){return b.h?b.a.currentTime:b.f}function Ai(b,c){0<b.a.readyState?Bi(b.c,c):ui(b.a,HTMLMediaElement.HAVE_METADATA,b.b,function(){yi(b,b.f)})}
function yi(b,c){.001>Math.abs(b.a.currentTime-c)?Ci(b):(b.b.ua(b.a,"seeking",function(){Ci(b)}),Bi(b.c,0==b.a.currentTime?c:b.a.currentTime))}function Ci(b){b.h=!0;b.b.B(b.a,"seeking",function(){return b.g()})}function xi(b){var c=this;this.b=b;this.h=10;this.g=this.c=this.f=0;this.a=new I(function(){0>=c.f?(B.m(["Failed to move playhead from",c.c,"to",c.g].join(" ")),c.a.stop()):c.b.currentTime!=c.c?c.a.stop():(c.b.currentTime=c.g,c.f--)})}
xi.prototype.release=function(){this.a&&(this.a.stop(),this.a=null);this.b=null};function Bi(b,c){b.c=b.b.currentTime;b.g=c;b.f=b.h;b.b.currentTime=c;b.a.Ka(.1)};function Di(b){function c(){null==d.c?d.f=!0:(d.b.ua(d.a,"seeking",function(){d.f=!0}),d.a.currentTime=Math.max(0,d.a.currentTime+d.c))}var d=this;this.a=b;this.f=!1;this.c=null;this.b=new M;ui(this.a,HTMLMediaElement.HAVE_CURRENT_DATA,this.b,function(){c()})}Di.prototype.release=function(){this.b&&(this.b.release(),this.b=null);this.a=null};Di.prototype.o=function(b){this.c=this.f?this.c:b};Di.prototype.g=function(){return(this.f?this.a.currentTime:this.c)||0};Di.prototype.u=function(){};
function Ei(b,c,d,e,f,g){var h=this;this.c=b;this.a=c.presentationTimeline;this.D=c.minBufferTime||0;this.h=d;this.w=f;this.l=null;this.f=new ki(b,c.presentationTimeline,d,Fi(b,d),g);this.b=new wi(b,function(){a:{var b=h.f;b.i=!0;b.h=!1;b.c=!1;b=zi(h.b);var c=Gi(h,b);if(.001<Math.abs(c-b)){var d=Date.now()/1E3;if(!h.l||h.l<d-1){h.l=d;Ai(h.b,c);b=void 0;break a}}B.F("Seek to "+b);h.w();b=void 0}return b},Hi(this,e));this.i=(new I(function(){if(0!=h.c.readyState&&!h.c.paused){var b=zi(h.b),c=h.a.wb(),
d=h.a.Ga();3>d-c&&(c=d-3);b<c&&(c=Gi(h,b),B.info("Jumping forward "+(c-b)+" seconds to catch up with the seek range."),h.c.currentTime=c)}})).Ka(.25)}Ei.prototype.release=function(){this.b&&(this.b.release(),this.b=null);this.f&&(this.f.release(),this.f=null);this.i&&(this.i.stop(),this.i=null);this.c=this.b=this.a=this.h=null;this.w=function(){}};Ei.prototype.o=function(b){Ai(this.b,b)};Ei.prototype.g=function(){var b=zi(this.b);return 0<this.c.readyState&&!this.c.paused?Ii(this,b):b};
function Hi(b,c){null==c?c=Infinity>b.a.ca()?b.a.wb():b.a.Ga():0>c&&(c=b.a.Ga()+c);return Ji(b,Ii(b,c))}Ei.prototype.u=function(){this.f.td()};function Ji(b,c){var d=b.a.ca();return c>=d?d-b.h.durationBackoff:c}
function Gi(b,c){var d=Ed.bind(null,b.c.buffered),e=Math.max(b.D,b.h.rebufferingGoal),f=b.h.safeSeekOffset,g=b.a.wb(),h=b.a.Ga(),k=b.a.ca();3>h-g&&(g=h-3);var l=b.a.Vb(e),n=b.a.Vb(f);e=b.a.Vb(e+f);if(c>=k)return B.F("Playhead past duration."),Ji(b,c);if(c>h)return B.F("Playhead past end."),h;if(c<g){if(d(n))return B.F("Playhead before start & start is buffered"),n;B.F("Playhead before start & start is unbuffered");return e}if(c>=l||d(c))return B.F("Playhead in safe region or in buffered region."),
c;B.F("Playhead outside safe region & in unbuffered region.");return e}function Ii(b,c){var d=b.a.wb();if(c<d)return d;d=b.a.Ga();return c>d?d:c}function Fi(b,c){if(!c.stallEnabled)return null;var d=c.stallSkip,e=new gi(new ji(b),c.stallThreshold);ii(e,function(c,e){B.debug("Stall detected at "+c+" for "+e+" seconds.");d?(B.debug("Seeking forward "+d+" seconds to break stall."),b.currentTime+=d):(B.debug("Pausing and unpausing to break stall."),b.pause(),b.play())});return e};function Ki(b){var c=this;this.b=function(){};this.a=new Set;this.f=b;this.c=(new I(function(){for(var b=c.f(),e=t(c.a),f=e.next();!f.done;f=e.next())f=f.value,f.endTime<b.start&&c.a["delete"](f)})).Ka(2)}Ki.prototype.release=function(){this.b=function(){};this.a.clear();this.c.stop()};function Li(b,c){b.b=c};function Mi(b){var c=this;this.h=b;this.f=new Map;this.a=function(){};this.b=function(){};this.c=function(){};this.i=[{lb:null,kb:Ni,ab:function(b,e){return c.a(b,e)}},{lb:Oi,kb:Ni,ab:function(b,e){return c.a(b,e)}},{lb:Pi,kb:Ni,ab:function(b,e){return c.a(b,e)}},{lb:Ni,kb:Oi,ab:function(b,e){return c.b(b,e)}},{lb:Ni,kb:Pi,ab:function(b,e){return c.b(b,e)}},{lb:Oi,kb:Pi,ab:function(b,e){return c.c(b,e)}},{lb:Pi,kb:Oi,ab:function(b,e){return c.c(b,e)}}]}
Mi.prototype.release=function(){this.h=null;this.f.clear();this.a=function(){};this.b=function(){};this.c=function(){}};Mi.prototype.g=function(b,c){for(var d=t(this.h.a),e=d.next();!e.done;e=d.next()){e=e.value;var f=this.f.get(e),g=b<e.startTime?Oi:b>e.endTime?Pi:Ni;this.f.set(e,g);for(var h=t(this.i),k=h.next();!k.done;k=h.next())k=k.value,k.lb==f&&k.kb==g&&k.ab(e,c)}};function Qi(b,c,d,e){b.a=c;b.b=d;b.c=e}var Oi=1,Ni=2,Pi=3;function Ri(b,c){this.a=c;this.c=b;this.g=null;this.l=1;this.w=Promise.resolve();this.h=[];this.i=new Map;this.b=new Map;this.u=!1;this.H=null;this.G=this.f=this.o=!1;this.D=0}Ri.prototype.destroy=function(){var b=this;return u(function d(){var e,f;return x(d,function(d){switch(d.j){case 1:e=[];for(var g=t(b.b.values()),k=g.next();!k.done;k=g.next())f=k.value,Si(f),e.push(Ti(f));return v(d,Promise.all(e),2);case 2:b.b.clear(),b.i.clear(),b.a=null,b.c=null,b.w=null,b.h=null,b.g=null,b.f=!0,w(d)}})})};
Ri.prototype.configure=function(b){this.g=b;this.H=new Sb({maxAttempts:Math.max(b.retryParameters.maxAttempts,2),baseDelay:b.retryParameters.baseDelay,backoffFactor:b.retryParameters.backoffFactor,fuzzFactor:b.retryParameters.fuzzFactor,timeout:0},!0)};
Ri.prototype.start=function(){var b=this;return u(function d(){var e,f,g;return x(d,function(d){switch(d.j){case 1:return e=b.a.Za(),f=Ui(b,e),g=b.a.pe(b.c.periods[f]),g.variant||g.text?v(d,Vi(b,g.variant?g.variant.audio:null,g.variant?g.variant.video:null,g.text,e),2):(B.error("init: no Streams chosen"),d["return"](new D(2,5,5005)));case 2:if(b.f)return d["return"]();B.debug("init: completed initial Stream setup");b.a&&b.a.Tf&&(B.F("init: calling onInitialStreamsSetup()..."),b.a.Tf());w(d)}})})};
function Wi(b){return Xi(b,"audio")}function Yi(b){return Xi(b,"video")}function Xi(b,c){var d=b.b.get(c);return d?d.Pa||d.stream:null}
function Zi(b,c){return u(function e(){var f,g,h,k,l,n,p,q,r,y;return x(e,function(e){switch(e.j){case 1:return f=Ab,v(e,se(b.a.O,f.va),2);case 2:return b.D++,b.G=!1,g=b.D,h=b.a.O,k=new Map,l=new Set,k.set(f.va,c),l.add(c),v(e,h.init(k,!1),3);case 3:return b.f?e["return"]():v(e,$i(b,l),4);case 4:if(b.f)return e["return"]();p=(n=b.a.O.g.isTextVisible())||b.g.alwaysStreamText;b.D!=g||b.b.has(f.va)||b.G||!p||(q=b.a.Za(),r=Ui(b,q),y=aj(c,r,0),b.b.set(f.va,y),bj(b,y,0));w(e)}})})}
function cj(b){b.G=!0;var c=b.b.get("text");c&&(Si(c),Ti(c)["catch"](function(){}),b.b["delete"]("text"))}function dj(b,c){var d=b.b.get("video");if(d){var e=d.stream;if(e)if(B.debug("setTrickPlay",c),c){var f=e.trickModeVideo;f&&!d.Pa&&(B.debug("Engaging trick mode stream",f),ej(b,f,!1,0,!1),d.Pa=e)}else if(e=d.Pa)B.debug("Restoring non-trick-mode stream",e),d.Pa=null,ej(b,e,!0,0,!1)}}
function fj(b,c,d,e){var f=!1;if(c.video){var g=ej(b,c.video,d,e,!1);f=f||g}c.audio&&(b=ej(b,c.audio,d,e,!1),f=f||b);return f}
function ej(b,c,d,e,f){var g=b.b.get(c.type);if(!g&&"text"==c.type&&b.g.ignoreTextStreamFailures)return Zi(b,c),!0;if(!g)return!1;var h=gj(b,c),k=Array.from(b.b.values()).every(function(b){return b.ka==g.ka});if(d&&h!=g.ka&&k)return B.debug("switch: switching to stream in another Period; clearing buffer and changing Periods"),b.b.forEach(function(c){hj(b,c)}),!0;g.Pa&&(B.debug("switch during trick play mode",c),c.trickModeVideo?(g.Pa=c,c=c.trickModeVideo,B.debug("switch found trick play stream",c)):
(g.Pa=null,B.debug("switch found no special trick play stream")));k=b.h[h];if(!k||!k.Mb)return!1;k=b.i.get(c.id);if(!k||!k.Mb)return!1;if(g.stream==c&&!f)return B.debug("switch: Stream "+ij(g)+" already active"),!1;"text"==c.type&&je(b.a.O,Dc(c.mimeType,c.codecs));g.stream=c;g.vc=!0;B.debug("switch: switching to Stream "+ij(g));jj(b,g,h)&&(B.info("Aborting current segment request to switch."),g.fb.abort());d&&(g.Wa?g.Kc=!0:g.Oa?(g.Sa=!0,g.lc=e,g.Kc=!0):(Si(g),kj(b,g,!0,e)["catch"](function(c){if(b.a)b.a.onError(c)})));
return!0}function jj(b,c,d){if(!c.fb)return!1;var e=b.a.Za(),f=ne(b.a.O,c.type),g=lj(b,c,e,f,d);d=g?g.a?g.a-g.b:null:null;g&&!d&&(d=(g.endTime-g.sc())*c.stream.bandwidth/8);if(isNaN(d))return!1;(g=c.stream.initSegmentReference)&&(d+=(g.a?g.a-g.b:null)||0);g=b.a.getBandwidthEstimate();return 8*d/g<f-e-Math.max(b.c.minBufferTime||0,b.g.rebufferingGoal)||c.fb.b.a>d?!0:!1}
function mj(b){function c(c){var f=b.a.O;"text"==c?(c=f.a,c=null==c.a||null==c.b?!1:d>=c.a&&d<c.b):(c=me(f,c),c=Ed(c,d,e));return c}var d=b.a.Za(),e=b.g.smallGapLimit,f=!1,g=Ui(b,d);if(Ac(b.b.values(),function(b){return b.ka==g}))for(var h=t(b.b.keys()),k=h.next();!k.done;k=h.next())k=k.value,c(k)||(hj(b,b.b.get(k)),f=!0);else Ac(b.b.keys(),c)||(B.debug("(all): seeked: unbuffered seek: clearing all buffers"),b.b.forEach(function(c){hj(b,c)}),f=!0);f||B.debug("(all): seeked: buffered seek: presentationTime="+
d)}function hj(b,c){var d=ij(c);c.Wa?B.debug(d,"clear: already clearing the buffer"):c.Sa?B.debug(d,"clear: already waiting"):c.Oa?(B.debug(d,"clear: currently updating"),c.Sa=!0,c.lc=0):null==le(b.a.O,c.type)?(B.debug(d,"clear: nothing buffered"),null==c.La&&bj(b,c,0)):(B.debug(d,"clear: handling right now"),Si(c),kj(b,c,!1,0)["catch"](function(c){if(b.a)b.a.onError(c)}))}
function Vi(b,c,d,e,f){return u(function h(){var k,l,n,p,q,r,y;return x(h,function(h){switch(h.j){case 1:return k=b.a.Za(),l=Ui(b,k),n=Ab,p=new Map,q=new Set,c&&(p.set(n.Nb,c),q.add(c)),d&&(p.set(n.Ua,d),q.add(d)),e&&(p.set(n.va,e),q.add(e)),r=b.a.O,y=b.g.forceTransmuxTS,v(h,r.init(p,y),2);case 2:if(b.f)return h["return"]();nj(b);return v(h,$i(b,q),3);case 3:if(b.f)return h["return"]();p.forEach(function(c,d){if(!b.b.has(d)){var e=aj(c,l,f);b.b.set(d,e);bj(b,e,0)}});w(h)}})})}
function aj(b,c,d){return{stream:b,type:b.type,Cb:null,Ha:null,Pa:null,vc:!0,ka:c,endOfStream:!1,Oa:!1,La:null,Sa:!1,lc:0,Kc:!1,Wa:!1,yd:!1,Xb:!1,Bd:d||0,fb:null}}
function oj(b,c){var d=b.h[c];if(d)return B.debug("(all) Period "+c+" is being or has been set up"),d.promise;B.debug("(all) setting up Period "+c);d={promise:new E,Mb:!1};b.h[c]=d;for(var e=new Set,f=t(b.c.periods[c].variants),g=f.next();!g.done;g=f.next())g=g.value,g.video&&e.add(g.video),g.video&&g.video.trickModeVideo&&e.add(g.video.trickModeVideo),g.audio&&e.add(g.audio);f=t(b.c.periods[c].textStreams);for(g=f.next();!g.done;g=f.next())e.add(g.value);b.w=b.w.then(function(){if(!this.f)return $i(this,
e)}.bind(b)).then(function(){this.f||(this.h[c].promise.resolve(),this.h[c].Mb=!0,B.F("(all) setup Period "+c))}.bind(b))["catch"](function(b){this.f||(this.h[c].promise["catch"](function(){}),this.h[c].promise.reject(),delete this.h[c],B.m("(all) failed to setup Period "+c),this.a.onError(b))}.bind(b));return d.promise}
function $i(b,c){return u(function e(){var f,g,h,k,l,n,p;return x(e,function(e){switch(e.j){case 1:f=[];for(var q=t(c),y=q.next();!y.done;y=q.next())g=y.value,(h=b.i.get(g.id))?(B.debug("(all) Stream "+g.id+" is being or has been set up"),f.push(h.promise)):(B.F("(all) setting up Stream "+g.id),b.i.set(g.id,{promise:new E,Mb:!1}),f.push(g.createSegmentIndex()));Ba(e,2);return v(e,Promise.all(f),4);case 4:if(b.f)return e["return"]();Fa(e,3);break;case 2:k=Ga(e);if(b.f)return e["return"]();e=t(c);for(y=
e.next();!y.done;y=e.next())l=y.value,b.i.get(l.id).promise["catch"](function(){}),b.i.get(l.id).promise.reject(),b.i["delete"](l.id);throw k;case 3:q=t(c);for(y=q.next();!y.done;y=q.next())n=y.value,p=b.i.get(n.id),p.Mb||(p.promise.resolve(),p.Mb=!0,B.F("(all) setup Stream "+n.id));w(e)}})})}function nj(b){var c=b.c.presentationTimeline.ca();Infinity>c?b.a.O.Ba(c):b.a.O.Ba(Math.pow(2,32))}
function pj(b,c){if(!b.f){var d=ij(c);if(!c.Oa&&null!=c.La&&!c.Wa)if(c.La=null,c.Sa)B.debug(d,"skipping update and clearing the buffer"),kj(b,c,c.Kc,c.lc);else{try{var e=qj(b,c);null!=e&&(bj(b,c,e),c.Xb=!1)}catch(f){rj(b,f);return}e=Array.from(b.b.values());sj(b,c);b.u&&e.every(function(b){return b.endOfStream})&&(B.F(d,"calling endOfStream()..."),b.a.O.endOfStream().then(function(){if(!this.f){var b=this.a.O.ca();0!=b&&b<this.c.presentationTimeline.ca()&&this.c.presentationTimeline.Ba(b)}}.bind(b)))}}}
function qj(b,c){if(tj(c))return re(b.a.O,c.stream.originalId||""),null;var d=ij(c),e=b.a.Za(),f=uj(b,c,e);B.J(d,"timeNeeded="+f);var g=gj(b,c.stream),h=Ui(b,f),k=oe(b.a.O,c.type,e);B.J(d,"update_:","presentationTime="+e,"bufferedAhead="+k);var l=Math.max(b.c.minBufferTime||0,b.g.rebufferingGoal,b.g.bufferingGoal)*b.l;if(f>=b.c.presentationTimeline.ca())return B.debug(d,"buffered to end of presentation"),c.endOfStream=!0,"video"==c.type&&(f=b.b.get("text"))&&"application/cea-608"==f.stream.mimeType&&
(f.endOfStream=!0),null;c.endOfStream=!1;c.ka=h;if(h!=g)return B.debug(d,"need Period "+h,"presentationTime="+e,"timeNeeded="+f,"currentPeriodIndex="+g),null;if(k>=l)return B.J(d,"buffering goal met"),.5;d=ne(b.a.O,c.type);d=lj(b,c,e,d,g);if(!d)return 1;var n=Infinity;Array.from(b.b.values()).forEach(function(c){tj(c)||(c=uj(b,c,e),n=Math.min(n,c))});if(f>=n+b.c.presentationTimeline.a)return 1;c.Bd=0;vj(b,c,e,g,d);return null}
function uj(b,c,d){if(!c.Cb||!c.Ha)return Math.max(d,c.Bd);d=gj(b,c.Cb);return b.c.periods[d].startTime+c.Ha.endTime}
function lj(b,c,d,e,f){var g=ij(c);if(c.Ha&&c.stream==c.Cb)return e=c.Ha.position+1,B.J(g,"next position known:","position="+e),wj(b,c,f,e);c.Ha?(B.F(g,"next position unknown: another Stream buffered"),g=gj(b,c.Cb),g=xj(b,c,b.c.periods[g].startTime+c.Ha.endTime,f)):(B.F(g,"next position unknown: nothing buffered"),g=xj(b,c,e||d,f));if(null==g)return null;d=null;null==e&&(d=wj(b,c,f,Math.max(0,g-1)));return d||wj(b,c,f,g)}
function xj(b,c,d,e){var f=ij(c);b=b.c.periods[e];B.debug(f,"looking up segment:","presentationTime="+d,"currentPeriod.startTime="+b.startTime);d=Math.max(0,d-b.startTime);c=c.stream.findSegmentPosition(d);null==c&&B.m(f,"cannot find segment:","currentPeriod.startTime="+b.startTime,"lookupTime="+d);return c}
function wj(b,c,d,e){var f=ij(c);d=b.c.periods[d];c=c.stream.getSegmentReference(e);if(!c)return B.F(f,"segment does not exist:","currentPeriod.startTime="+d.startTime,"position="+e),null;e=b.c.presentationTimeline;b=e.Wb();e=e.xb();return d.startTime+c.endTime<b||d.startTime+c.startTime>e?(B.J(f,"segment is not available:","currentPeriod.startTime="+d.startTime,"reference.startTime="+c.startTime,"reference.endTime="+c.endTime,"availabilityStart="+b,"availabilityEnd="+e),null):c}
function vj(b,c,d,e,f){var g=ij(c),h=b.c.periods[e];B.F(g,"fetchAndAppend_:","presentationTime="+d,"currentPeriod.startTime="+h.startTime,"reference.position="+f.position,"reference.startTime="+f.startTime,"reference.endTime="+f.endTime);var k=c.stream,l=b.c.presentationTimeline.ca(),n=b.c.periods[e+1];e=yj(b,c,e,Math.max(0,h.startTime-.1),n?n.startTime+.01:l);c.Oa=!0;c.vc=!1;B.J(g,"fetching segment");l=zj(b,c,f);Promise.all([e,l]).then(function(b){if(!this.f&&!this.o)return Aj(this,c,d,h,k,f,b[1])}.bind(b)).then(function(){this.f||
this.o||(c.Oa=!1,c.yd=!1,c.Sa||this.a.td(),bj(this,c,0),Bj(this,c,k),B.F(g,"finished fetch and append"))}.bind(b))["catch"](function(b){this.f||this.o||(c.Oa=!1,"text"==c.type&&this.g.ignoreTextStreamFailures?(1001==b.code?B.m(g,"Text stream failed to download. Proceeding without it."):B.m(g,"Text stream failed to parse. Proceeding without it."),this.b["delete"]("text")):7001==b.code?(c.Oa=!1,c.La=null,bj(this,c,0)):3017==b.code?Cj(this,c,b):(B.error(g,"failed fetch and append: code="+b.code),c.Xb=
!0,b.severity=2,rj(this,b)))}.bind(b))}
function Cj(b,c,d){var e=ij(c);if(Array.from(b.b.values()).some(function(b){return b!=c&&b.yd}))B.debug(e,"MediaSource threw QuotaExceededError:","waiting for another stream to recover...");else{var f=Math.round(100*b.l);if(20<f)b.l-=.2;else if(4<f)b.l-=.04;else{B.error(e,"MediaSource threw QuotaExceededError too many times");c.Xb=!0;b.o=!0;b.a.onError(d);return}B.m(e,"MediaSource threw QuotaExceededError:","reducing buffering goals by "+(100-Math.round(100*b.l))+"%");c.yd=!0}bj(b,c,4)}
function yj(b,c,d,e,f){if(!c.vc)return Promise.resolve();var g=ij(c);d=b.c.periods[d].startTime-c.stream.presentationTimeOffset;B.F(g,"setting timestamp offset to "+d);B.F(g,"setting append window start to "+e);B.F(g,"setting append window end to "+f);e=te(b.a.O,c.type,d,e,f);if(!c.stream.initSegmentReference)return e;B.F(g,"fetching init segment");b=zj(b,c,c.stream.initSegmentReference).then(function(b){if(!this.f)return B.F(g,"appending init segment"),pe(this.a.O,c.type,b,null,null,c.stream.closedCaptions&&
0<c.stream.closedCaptions.size)}.bind(b))["catch"](function(b){c.vc=!0;return Promise.reject(b)});return Promise.all([e,b])}
function Aj(b,c,d,e,f,g,h){var k=ij(c),l=f.closedCaptions&&0<f.closedCaptions.size;null!=f.emsgSchemeIdUris&&0<f.emsgSchemeIdUris.length&&(new T).ia("emsg",b.K.bind(b,e,g,f.emsgSchemeIdUris)).parse(h);return Dj(b,c,d).then(function(){if(!this.f)return B.F(k,"appending media segment"),pe(this.a.O,c.type,h,g.startTime+e.startTime,g.endTime+e.startTime,l)}.bind(b)).then(function(){if(!this.f)return B.J(k,"appended media segment"),c.Cb=f,c.Ha=g,Promise.resolve()}.bind(b))}
Ri.prototype.K=function(b,c,d,e){var f=e.reader.wd(),g=e.reader.wd(),h=e.reader.I(),k=e.reader.I(),l=e.reader.I(),n=e.reader.I();e=e.reader.gb(e.reader.N.byteLength-e.reader.ga());b=b.startTime+c.startTime+k/h;if(d.includes(f))if("urn:mpeg:dash:event:2012"==f)this.a.Uf();else this.a.onEvent(new K("emsg",{detail:{startTime:b,endTime:b+l/h,schemeIdUri:f,value:g,timescale:h,presentationTimeDelta:k,eventDuration:l,id:n,messageData:e}}))};
function Dj(b,c,d){var e=ij(c);B.J(e,"checking buffer length");var f=Math.max(b.g.bufferBehind,b.c.presentationTimeline.a),g=le(b.a.O,c.type);if(null==g)return B.J(e,"buffer behind okay because nothing buffered:","presentationTime="+d,"bufferBehind="+f),Promise.resolve();var h=d-g,k=h-f;if(.01>=k)return B.J(e,"buffer behind okay:","presentationTime="+d,"bufferedBehind="+h,"bufferBehind="+f,"underflow="+Math.abs(k)),Promise.resolve();B.F(e,"buffer behind too large:","presentationTime="+d,"bufferedBehind="+
h,"bufferBehind="+f,"overflow="+k);return b.a.O.remove(c.type,g,g+k).then(function(){this.f||B.F(e,"evicted "+k+" seconds")}.bind(b))}
function Bj(b,c,d){if(!b.u){var e=ij(c);c=Array.from(b.b.values());if(1!=c.length||"text"!=c[0].type)b.u=c.every(function(b){return"text"==b.type?!0:!b.Sa&&!b.Wa&&b.Ha});if(b.u){B.debug(e,"startup complete");d=gj(b,d);b.h[d]||oj(b,d).then(function(){this.f||(B.F(e,"calling onCanSwitch()..."),this.a.oe())}.bind(b))["catch"](xb.wc);for(d=0;d<b.c.periods.length;++d)oj(b,d)["catch"](xb.wc);b.a.bg&&(B.F(e,"calling onStartupComplete()..."),b.a.bg())}}}
function sj(b,c){var d=ij(c),e=gj(b,c.stream);if(c.ka!=e){var f=c.ka,g=Array.from(b.b.values());g.every(function(b){return b.ka==f||tj(b)})?g.every(Ej)?(B.debug(d,"all need Period "+f),oj(b,f).then(function(){if(!this.f)if(g.every(function(b){var c=Ej(b),d=gj(this,b.stream);return tj(b)?!0:c&&b.ka==f&&d!=f}.bind(this))){var b=this.c.periods[f];B.F(d,"calling onChooseStreams()...");var c=this.a.pe(b),e=new Map;c.variant&&c.variant.video&&e.set("video",c.variant.video);c.variant&&c.variant.audio&&e.set("audio",
c.variant.audio);c.text&&e.set("text",c.text);c=t(this.b.keys());for(var n=c.next();!n.done;n=c.next())if(n=n.value,!e.has(n)&&"text"!=n){B.error(d,"invalid Streams chosen: missing "+n+" Stream");this.a.onError(new D(2,5,5005));return}c=t(Array.from(e.keys()));for(n=c.next();!n.done;n=c.next())if(n=n.value,!this.b.has(n))if("text"==n)Vi(this,null,null,e.get("text"),b.startTime),e["delete"](n);else{B.error(d,"invalid Streams chosen: unusable "+n+" Stream");this.a.onError(new D(2,5,5005));return}c=
t(Array.from(this.b.keys()));for(n=c.next();!n.done;n=c.next()){n=n.value;var p=this.b.get(n),q=e.get(n);if(q){var r=tj(p);r&&(p.ka=f,p.Bd=b.startTime);ej(this,q,!1,0,!1);r&&tj(p)||bj(this,this.b.get(n),0)}else this.b["delete"](n)}B.F(d,"calling onCanSwitch()...");this.a.oe()}else B.debug(d,"ignoring transition to Period",f,"since another is happening")}.bind(b))["catch"](xb.wc)):B.debug(d,"all MediaStates need Period "+f+", but not all MediaStates are idle"):B.debug(d,"not all MediaStates need Period "+
f)}}function tj(b){return b&&"text"==b.type&&"application/cea-608"==b.stream.mimeType}function Ej(b){return!b.Oa&&null==b.La&&!b.Sa&&!b.Wa}function Ui(b,c){var d=pi(b.c.periods,c+Fb);return d?b.c.periods.indexOf(d):0}
function gj(b,c){for(var d=b.c.periods,e=0;e<d.length;e++){for(var f=d[e],g=new Set,h=t(f.variants),k=h.next();!k.done;k=h.next())k=k.value,k.audio&&g.add(k.audio),k.video&&g.add(k.video),k.video&&k.video.trickModeVideo&&g.add(k.video.trickModeVideo);f=t(f.textStreams);for(h=f.next();!h.done;h=f.next())g.add(h.value);if(g.has(c))return e}return-1}
function zj(b,c,d){var e=yg(d.c(),d.b,d.a,b.g.retryParameters);B.J("fetching: reference=",d);b=b.a.Db.request(1,e);c.fb=b;return b.promise.then(function(b){c.fb=null;return b.data})}
function kj(b,c,d,e){return u(function g(){var h,k,l,n;return x(g,function(g){switch(g.j){case 1:return h=ij(c),c.Sa=!1,c.Kc=!1,c.lc=0,c.Wa=!0,c.Cb=null,c.Ha=null,B.debug(h,"clearing buffer"),e?(l=b.a.Za(),n=b.a.O.ca(),k=b.a.O.remove(c.type,l+e,n)):k=se(b.a.O,c.type).then(function(){if(!this.f&&d)return this.a.O.flush(c.type)}.bind(b)),v(g,k,2);case 2:if(b.f)return g["return"]();B.debug(h,"cleared buffer");c.Wa=!1;c.endOfStream=!1;bj(b,c,0);w(g)}})})}
function bj(b,c,d){var e=ij(c),f=c.type;"text"!=f||b.b.has(f)?(B.J(e,"updating in "+d+" seconds"),c.La=(new Rb(function(){return u(function h(){var d;return x(h,function(e){switch(e.j){case 1:return Ba(e,2),v(e,pj(b,c),4);case 4:Fa(e,0);break;case 2:d=Ga(e);if(b.a)b.a.onError(d);w(e)}})})})).R(d)):B.F(e,"Text stream is unloaded. No update is needed.")}function Si(b){null!=b.La&&(b.La.stop(),b.La=null)}
function Ti(b){return u(function d(){return x(d,function(d){switch(d.j){case 1:if(b.fb)return v(d,b.fb.abort(),0);d.C(0)}})})}function rj(b,c){Ub(b.H).then(function(){this.f||(this.a.onError(c),c.handled||this.g.failureCallback(c))}.bind(b))}function ij(b){return"("+b.type+":"+b.stream.id+")"};function Fj(b,c,d,e,f,g){if(200<=d&&299>=d&&202!=d)return{uri:f||e,vd:e,data:c,headers:b,fromCache:!!b["x-shaka-from-cache"]};f=null;try{f=Jb(c)}catch(h){}B.debug("HTTP error text:",f);throw new D(401==d||403==d?2:1,1,1001,e,d,f,b,g);};function Gj(b,c,d,e){var f=new Gj.b;Bc(c.headers).forEach(function(b,c){f.append(c,b)});var g=new Gj.a,h={Ud:!1,Ie:!1};b=Gj.l(b,d,{body:c.body||void 0,headers:f,method:c.method,signal:g.signal,credentials:c.allowCrossSiteCredentials?"include":void 0},h,e);b=new J(b,function(){h.Ud=!0;g.abort();return Promise.resolve()});if(c=c.retryParameters.timeout){var k=new I(function(){h.Ie=!0;g.abort()});k.R(c/1E3);b["finally"](function(){k.stop()})}return b}A("shaka.net.HttpFetchPlugin",Gj);
Gj.l=function(b,c,d,e,f){return u(function h(){var k,l,n,p,q,r,y,C,z,F,H,R,sa,ba;return x(h,function(h){switch(h.j){case 1:return k=Gj.g,l=Gj.c,r=q=0,y=Date.now(),Ba(h,2),v(h,k(b,d),4);case 4:return n=h.s,C=n.clone().body.getReader(),F=(z=n.headers.get("Content-Length"))?parseInt(z,10):0,H=function(b){function c(){return u(function ea(){var d,e,h;return x(ea,function(k){switch(k.j){case 1:return Ba(k,2),v(k,C.read(),4);case 4:d=k.s;Fa(k,3);break;case 2:return e=Ga(k),B.F("error reading from stream",
e.message),k["return"]();case 3:d.done||(q+=d.value.byteLength);h=Date.now();if(100<h-y||d.done)f(h-y,q-r,F-q),r=q,y=h;d.done?b.close():(b.enqueue(d.value),c());w(k)}})})}c()},new l({start:H}),v(h,n.arrayBuffer(),5);case 5:p=h.s;Fa(h,3);break;case 2:R=Ga(h);if(e.Ud)throw new D(1,1,7001,b,c);if(e.Ie)throw new D(1,1,1003,b,c);throw new D(1,1,1002,b,R,c);case 3:return sa={},ba=n.headers,ba.forEach(function(b,c){sa[c.trim()]=b}),h["return"](Fj(sa,p,n.status,b,n.url,c))}})})};
Gj.isSupported=function(){if(window.ReadableStream)try{new ReadableStream({})}catch(b){return!1}else return!1;return!(!window.fetch||!window.AbortController)};Gj.isSupported=Gj.isSupported;Gj.g=window.fetch;Gj.a=window.AbortController;Gj.c=window.ReadableStream;Gj.b=window.Headers;Gj.isSupported()&&(lc("http",Gj,2),lc("https",Gj,2));function Hj(b,c,d,e){var f=new Hj.f,g=Date.now(),h=0,k=new Promise(function(k,n){f.open(c.method,b,!0);f.responseType="arraybuffer";f.timeout=c.retryParameters.timeout;f.withCredentials=c.allowCrossSiteCredentials;f.onabort=function(){n(new D(1,1,7001,b,d))};f.onload=function(c){c=c.target;var e=c.getAllResponseHeaders().trim().split("\r\n"),f={};e=t(e);for(var g=e.next();!g.done;g=e.next())g=g.value.split(": "),f[g[0].toLowerCase()]=g.slice(1).join(": ");try{var h=Fj(f,c.response,c.status,b,c.responseURL,
d);k(h)}catch(F){n(F)}};f.onerror=function(c){n(new D(1,1,1002,b,c,d))};f.ontimeout=function(){n(new D(1,1,1003,b,d))};f.onprogress=function(b){var c=Date.now();if(100<c-g||b.lengthComputable&&b.loaded==b.total)e(c-g,b.loaded-h,b.total-b.loaded),h=b.loaded,g=c};for(var l in c.headers)f.setRequestHeader(l.toLowerCase(),c.headers[l]);f.send(c.body)});return new J(k,function(){f.abort();return Promise.resolve()})}A("shaka.net.HttpXHRPlugin",Hj);Hj.f=window.XMLHttpRequest;lc("http",Hj,1);
lc("https",Hj,1);function Ij(){this.a=this.f=this.b=0;this.c=new Map;this.g=0}function Jj(b,c){b.b+=c;var d=b.g;b.g++;b.c.set(d,c);return d}Ij.prototype.close=function(b,c){if(this.c.has(b)){var d=this.c.get(b);this.c["delete"](b);this.f+=d;this.a+=c}};function Kj(b,c,d){this.h=b;this.b=new Map;this.c=!1;this.g=c;this.f=d;this.a=new Ij}Kj.prototype.destroy=function(){this.c=!0;return Promise.all(this.b.values()).then(function(){},function(){})};
function Lj(b,c,d,e,f,g){var h=Jj(b.a,e);e=b.b.get(c)||Promise.resolve();b.b.set(c,e.then(function(){return u(function l(){var c,e,q,r,y,C;return x(l,function(l){switch(l.j){case 1:return v(l,Mj(b,d),2);case 2:c=l.s;if(b.c)throw new D(2,9,7001);if(f){e=new Uint8Array(c);q=new Hf(e);for(var n in q.data)r=Number(n),y=q.data[r],C=q.a[r],b.f(y,C)}b.a.close(h,c.byteLength);n=b.a;b.g(0==n.b?0:n.f/n.b,b.a.a);return l["return"](g(c))}})})}))}
function Nj(b){return u(function d(){return x(d,function(d){switch(d.j){case 1:return v(d,Promise.all(b.b.values()),2);case 2:return d["return"](b.a.a)}})})}function Mj(b,c){return u(function e(){var f,g;return x(e,function(e){switch(e.j){case 1:return f=b.h.request(1,c),v(e,f.promise,2);case 2:return g=e.s,e["return"](g.data)}})})};function Oj(b,c){var d=this;this.c=b;this.b=b.objectStore(c);this.a=new E;b.onabort=function(b){b.preventDefault();d.a.reject()};b.onerror=function(b){b.preventDefault();d.a.reject()};b.oncomplete=function(){d.a.resolve()}}Oj.prototype.abort=function(){try{this.c.abort()}catch(b){}return this.a["catch"](function(){})};
function Pj(b,c){return new Promise(function(d,e){var f=b.b.openCursor();f.onerror=e;f.onsuccess=function(b){b=b.target.result;if(!b)return d();c(b.key,b.value,b);b["continue"]()}})}Oj.prototype.store=function(){return this.b};Oj.prototype.promise=function(){return this.a};function Qj(b){this.b=b;this.a=[]}Qj.prototype.destroy=function(){return Promise.all(this.a.map(function(b){return b.abort()}))};function Rj(b,c){return Sj(b,c,"readwrite")}function Sj(b,c,d){d=b.b.transaction([c],d);var e=new Oj(d,c);b.a.push(e);e.promise().then(function(){fc(b.a,e)},function(){fc(b.a,e)});return e};function Tj(b,c,d){this.b=new Qj(b);this.c=c;this.a=d}m=Tj.prototype;m.destroy=function(){return this.b.destroy()};m.hasFixedKeySpace=function(){return!0};m.addSegments=function(){return Uj(this.c)};m.removeSegments=function(b,c){return Vj(this,this.c,b,c)};m.getSegments=function(b){var c=this;return u(function e(){var f;return x(e,function(e){switch(e.j){case 1:return v(e,Wj(c,c.c,b),2);case 2:return f=e.s,e["return"](f.map(function(b){return c.Wd(b)}))}})})};m.addManifests=function(){return Uj(this.a)};
m.updateManifestExpiration=function(b,c){var d=Rj(this.b,this.a),e=d.store();e.get(b).onsuccess=function(d){if(d=d.target.result)d.expiration=c,e.put(d,b)};return d.promise()};m.removeManifests=function(b,c){return Vj(this,this.a,b,c)};m.getManifests=function(b){var c=this;return u(function e(){var f;return x(e,function(e){switch(e.j){case 1:return v(e,Wj(c,c.a,b),2);case 2:return f=e.s,e["return"](f.map(function(b){return c.mc(b)}))}})})};
m.getAllManifests=function(){var b=this;return u(function d(){var e,f;return x(d,function(d){switch(d.j){case 1:return e=Sj(b.b,b.a,"readonly"),f=new Map,v(d,Pj(e,function(d,e){f.set(d,b.mc(e))}),2);case 2:return v(d,e.promise(),3);case 3:return d["return"](f)}})})};m.Wd=function(b){return b};m.mc=function(b){return b};function Uj(b){return Promise.reject(new D(2,9,9011,"Cannot add new value to "+b))}
m.add=function(b,c){var d=this;return u(function f(){var g,h,k,l,n;return x(f,function(f){switch(f.j){case 1:g=Rj(d.b,b);h=g.store();k=[];for(var p=t(c),r=p.next();!r.done;r=p.next())l=r.value,n=h.add(l),n.onsuccess=function(b){k.push(b.target.result)};return v(f,g.promise(),2);case 2:return f["return"](k)}})})};
function Vj(b,c,d,e){b=Rj(b.b,c);c=b.store();var f={};d=t(d);for(var g=d.next();!g.done;f={key:f.key},g=d.next())f.key=g.value,c["delete"](f.key).onsuccess=function(b){return function(){return e(b.key)}}(f);return b.promise()}
function Wj(b,c,d){return u(function f(){var g,h,k,l,n,p,q;return x(f,function(f){switch(f.j){case 1:g=Sj(b.b,c,"readonly");h=g.store();k={};l=[];n={};p=t(d);for(q=p.next();!q.done;n={request:n.request,key:n.key},q=p.next())n.key=q.value,n.request=h.get(n.key),n.request.onsuccess=function(b){return function(){void 0==b.request.result&&l.push(b.key);k[b.key]=b.request.result}}(n);return v(f,g.promise(),2);case 2:if(l.length)throw new D(2,9,9012,"Could not find values for "+l);return f["return"](d.map(function(b){return k[b]}))}})})}
;function Xj(b){this.a=new Qj(b)}Xj.prototype.destroy=function(){return this.a.destroy()};Xj.prototype.getAll=function(){var b=this;return u(function d(){var e,f;return x(d,function(d){switch(d.j){case 1:return e=Sj(b.a,"session-ids","readonly"),f=[],v(d,Pj(e,function(b,d){f.push(d)}),2);case 2:return v(d,e.promise(),3);case 3:return d["return"](f)}})})};Xj.prototype.add=function(b){var c=Rj(this.a,"session-ids"),d=c.store();b=t(b);for(var e=b.next();!e.done;e=b.next())d.add(e.value);return c.promise()};
Xj.prototype.remove=function(b){var c=this;return u(function e(){var f;return x(e,function(e){switch(e.j){case 1:return f=Rj(c.a,"session-ids"),v(e,Pj(f,function(c,e,f){0<=b.indexOf(e.sessionId)&&f["delete"]()}),2);case 2:return v(e,f.promise(),0)}})})};function Yj(){this.a=new Map}Yj.prototype.destroy=function(){for(var b=[],c=t(this.a.values()),d=c.next();!d.done;d=c.next())b.push(d.value.destroy());this.a.clear();return Promise.all(b)};Yj.prototype.init=function(){var b=this;Zj.forEach(function(c,d){var e=c();e?b.a.set(d,e):B.info("Skipping "+d+" as it is not supported on this platform")});for(var c=[],d=t(this.a.values()),e=d.next();!e.done;e=d.next())c.push(e.value.init());return Promise.all(c)};
function ak(b){var c=null;b.a.forEach(function(b,e){b.getCells().forEach(function(b,d){b.hasFixedKeySpace()||c||(c={path:{Aa:e,fa:d},fa:b})})});if(c)return c;throw new D(2,9,9013,"Could not find a cell that supports add-operations");}function bk(b,c){b.a.forEach(function(b,e){b.getCells().forEach(function(b,d){c({Aa:e,fa:d},b)})})}
function ck(b,c,d){b=b.a.get(c);if(!b)throw new D(2,9,9013,"Could not find mechanism with name "+c);c=b.getCells().get(d);if(!c)throw new D(2,9,9013,"Could not find cell with name "+d);return c}function dk(b,c){b.a.forEach(function(b){c(b.getEmeSessionCell())})}function ek(b){var c=Array.from(b.a.keys());if(!c.length)throw new D(2,9,9E3,"No supported storage mechanisms found");return b.a.get(c[0]).getEmeSessionCell()}
Yj.prototype.erase=function(){var b=this;return u(function d(){var e,f,g;return x(d,function(d){switch(d.j){case 1:return e=Array.from(b.a.values()),f=0<e.length,f||(g=Zj,g.forEach(function(b){(b=b())&&e.push(b)})),v(d,Promise.all(e.map(function(b){return b.erase()})),2);case 2:if(f)d.C(0);else return v(d,Promise.all(e.map(function(b){return b.destroy()})),0)}})})};function fk(b,c){Zj.set(b,c)}A("shaka.offline.StorageMuxer.register",fk);A("shaka.offline.StorageMuxer.unregister",function(b){Zj["delete"](b)});
var Zj=new Map;function gk(b){Tj.apply(this,arguments)}xa(gk,Tj);gk.prototype.updateManifestExpiration=function(b,c){var d=Rj(this.b,this.a),e=d.store(),f=new E;e.get(b).onsuccess=function(d){(d=d.target.result)?(d.expiration=c,e.put(d),f.resolve()):f.reject(new D(2,9,9012,"Could not find values for "+b))};return d.promise().then(function(){return f})};
gk.prototype.mc=function(b){return{originalManifestUri:b.originalManifestUri,duration:b.duration,size:b.size,expiration:null==b.expiration?Infinity:b.expiration,periods:b.periods.map(hk),sessionIds:b.sessionIds,drmInfo:b.drmInfo,appMetadata:b.appMetadata}};function hk(b){ik(b);b.streams.forEach(function(){});return{startTime:b.startTime,streams:b.streams.map(jk)}}
function jk(b){var c=b.initSegmentUri?kk(b.initSegmentUri):null;return{id:b.id,originalId:null,primary:b.primary,presentationTimeOffset:b.presentationTimeOffset,contentType:b.contentType,mimeType:b.mimeType,codecs:b.codecs,frameRate:b.frameRate,pixelAspectRatio:void 0,kind:b.kind,language:b.language,label:b.label,width:b.width,height:b.height,initSegmentKey:c,encrypted:b.encrypted,keyId:b.keyId,segments:b.segments.map(lk),variantIds:b.variantIds}}
function lk(b){var c=kk(b.uri);return{startTime:b.startTime,endTime:b.endTime,dataKey:c}}gk.prototype.Wd=function(b){return{data:b.data}};function kk(b){var c;if((c=/^offline:[0-9]+\/[0-9]+\/([0-9]+)$/.exec(b))||(c=/^offline:segment\/([0-9]+)$/.exec(b)))return Number(c[1]);throw new D(2,9,9004,"Could not parse uri "+b);}
function ik(b){var c=b.streams.filter(function(b){return"audio"==b.contentType}),d=b.streams.filter(function(b){return"video"==b.contentType});if(!c.every(function(b){return b.variantIds})||!d.every(function(b){return b.variantIds})){c.forEach(function(b){b.variantIds=[]});d.forEach(function(b){b.variantIds=[]});var e=0;if(d.length&&!c.length){B.debug("Found video-only content. Creating variants for video.");var f=e++;d.forEach(function(b){b.variantIds.push(f)})}if(!d.length&&c.length){B.debug("Found audio-only content. Creating variants for audio.");
var g=e++;c.forEach(function(b){b.variantIds.push(g)})}d.length&&c.length&&(B.debug("Found audio-video content. Creating variants."),c.forEach(function(b){d.forEach(function(c){var d=e++;b.variantIds.push(d);c.variantIds.push(d)})}))}};function mk(b,c,d,e){Tj.call(this,b,c,d);this.f=e}xa(mk,Tj);mk.prototype.hasFixedKeySpace=function(){return this.f};mk.prototype.addSegments=function(b){return this.f?Uj(this.c):this.add(this.c,b)};mk.prototype.addManifests=function(b){return this.f?Uj(this.a):this.add(this.a,b)};mk.prototype.mc=function(b){null==b.expiration&&(b.expiration=Infinity);return b};function nk(){this.g=this.c=this.b=this.a=this.f=null}m=nk.prototype;
m.init=function(){var b=this,c=new E,d=window.indexedDB.open("shaka_offline_db",4);d.onsuccess=function(d){d=d.target.result;b.f=d;var e=d.objectStoreNames;e.contains("manifest")&&e.contains("segment")?(B.debug("Mounting v1 idb storage cell"),e=new gk(d,"segment","manifest")):e=null;b.a=e;e=d.objectStoreNames;e.contains("manifest-v2")&&e.contains("segment-v2")?(B.debug("Mounting v2 idb storage cell"),e=new mk(d,"segment-v2","manifest-v2",!0)):e=null;b.b=e;e=d.objectStoreNames;e.contains("manifest-v3")&&
e.contains("segment-v3")?(B.debug("Mounting v3 idb storage cell"),e=new mk(d,"segment-v3","manifest-v3",!1)):e=null;b.c=e;d.objectStoreNames.contains("session-ids")?(B.debug("Mounting session ID idb storage cell"),d=new Xj(d)):d=null;b.g=d;c.resolve()};d.onupgradeneeded=function(b){b=b.target.result;for(var c=t(["segment-v3","manifest-v3","session-ids"]),d=c.next();!d.done;d=c.next())d=d.value,b.objectStoreNames.contains(d)||b.createObjectStore(d,{autoIncrement:!0})};d.onerror=function(b){c.reject(new D(2,
9,9001,d.error));b.preventDefault()};return c};m.destroy=function(){var b=this;return u(function d(){return x(d,function(d){switch(d.j){case 1:if(!b.a){d.C(2);break}return v(d,b.a.destroy(),2);case 2:if(!b.b){d.C(4);break}return v(d,b.b.destroy(),4);case 4:if(!b.c){d.C(6);break}return v(d,b.c.destroy(),6);case 6:if(!b.g){d.C(8);break}return v(d,b.g.destroy(),8);case 8:b.f&&b.f.close(),w(d)}})})};
m.getCells=function(){var b=new Map;this.a&&b.set("v1",this.a);this.b&&b.set("v2",this.b);this.c&&b.set("v3",this.c);return b};m.getEmeSessionCell=function(){return this.g};
m.erase=function(){var b=this;return u(function d(){return x(d,function(d){switch(d.j){case 1:if(!b.a){d.C(2);break}return v(d,b.a.destroy(),2);case 2:if(!b.b){d.C(4);break}return v(d,b.b.destroy(),4);case 4:if(!b.c){d.C(6);break}return v(d,b.c.destroy(),6);case 6:return b.f&&b.f.close(),v(d,ok(),8);case 8:return b.f=null,b.a=null,b.b=null,b.c=null,v(d,b.init(),0)}})})};
function ok(){var b=new E,c=window.indexedDB.deleteDatabase("shaka_offline_db");c.onblocked=function(){B.m("Deleting","shaka_offline_db","is being blocked")};c.onsuccess=function(){b.resolve()};c.onerror=function(d){b.reject(new D(2,9,9001,c.error));d.preventDefault()};return b}fk("idb",function(){return Lc("CrKey")||!window.indexedDB?null:new nk});function pk(b,c,d,e){this.a=b;this.g=c;this.f=d;this.c=e;this.b=["offline:",b,"/",c,"/",d,"/",e].join("")}pk.prototype.Aa=function(){return this.g};pk.prototype.fa=function(){return this.f};pk.prototype.key=function(){return this.c};pk.prototype.toString=function(){return this.b};
function qk(b){b=/^offline:([a-z]+)\/([^/]+)\/([^/]+)\/([0-9]+)$/.exec(b);if(null==b)return null;var c=b[1];if("manifest"!=c&&"segment"!=c)return null;var d=b[2];if(!d)return null;var e=b[3];return e&&null!=c?new pk(c,d,e,Number(b[4])):null};function rk(b,c){this.b=b;this.a=c}function sk(b,c){var d=new X(null,0);d.Ba(c.duration);var e=c.periods.map(function(c){return tk(b,c,d)}),f=c.drmInfo?[c.drmInfo]:[];c.drmInfo&&e.forEach(function(b){b.variants.forEach(function(b){b.drmInfos=f})});return{presentationTimeline:d,minBufferTime:2,offlineSessionIds:c.sessionIds,periods:e}}
function tk(b,c,d){var e=c.streams.filter(function(b){return"audio"==b.contentType}),f=c.streams.filter(function(b){return"video"==b.contentType});e=uk(b,e,f);f=c.streams.filter(function(b){return"text"==b.contentType}).map(function(c){return vk(b,c)});c.streams.forEach(function(e){e=e.segments.map(function(c,d){return wk(b,d,c)});d.Eb(e,c.startTime)});return{startTime:c.startTime,variants:Array.from(e.values()),textStreams:f}}
function uk(b,c,d){for(var e=new Set,f=t(c),g=f.next();!g.done;g=f.next()){var h=t(g.value.variantIds);for(g=h.next();!g.done;g=h.next())e.add(g.value)}f=t(d);for(g=f.next();!g.done;g=f.next())for(h=t(g.value.variantIds),g=h.next();!g.done;g=h.next())e.add(g.value);f=new Map;e=t(e);for(g=e.next();!g.done;g=e.next())g=g.value,f.set(g,{id:g,language:"",primary:!1,audio:null,video:null,bandwidth:0,drmInfos:[],allowedByApplication:!0,allowedByKeySystem:!0});c=t(c);for(e=c.next();!e.done;e=c.next())for(e=
e.value,g=vk(b,e),h=t(e.variantIds),e=h.next();!e.done;e=h.next())e=f.get(e.value),e.language=g.language,e.primary=e.primary||g.primary,e.audio=g;d=t(d);for(c=d.next();!c.done;c=d.next())for(e=c.value,c=vk(b,e),g=t(e.variantIds),e=g.next();!e.done;e=g.next())e=f.get(e.value),e.primary=e.primary||c.primary,e.video=c;return f}
function vk(b,c){var d=c.segments.map(function(c,d){return wk(b,d,c)}),e=new ag(d);d={id:c.id,originalId:c.originalId,createSegmentIndex:function(){return Promise.resolve()},findSegmentPosition:function(b){return e.find(b)},getSegmentReference:function(b){return e.get(b)},initSegmentReference:null,presentationTimeOffset:c.presentationTimeOffset,mimeType:c.mimeType,codecs:c.codecs,width:c.width||void 0,height:c.height||void 0,frameRate:c.frameRate||void 0,pixelAspectRatio:c.pixelAspectRatio||void 0,
kind:c.kind,encrypted:c.encrypted,keyId:c.keyId,language:c.language,label:c.label||null,type:c.contentType,primary:c.primary,trickModeVideo:null,emsgSchemeIdUris:null,roles:[],channelsCount:null,audioSamplingRate:null,closedCaptions:null};null!=c.initSegmentKey&&(d.initSegmentReference=xk(b,c.initSegmentKey));return d}function wk(b,c,d){var e=new pk("segment",b.b,b.a,d.dataKey);return new V(c,d.startTime,d.endTime,function(){return[e.toString()]},0,null)}
function xk(b,c){var d=new pk("segment",b.b,b.a,c);return new Yf(function(){return[d.toString()]},0,null)};function yk(){this.a=null}m=yk.prototype;m.configure=function(){};
m.start=function(b){var c=this;return u(function e(){var f,g,h,k,l,n;return x(e,function(e){switch(e.j){case 1:f=qk(b);c.a=f;if(null==f||"manifest"!=f.a)return e["return"](Promise.reject(new D(2,1,9004,f)));g=new Yj;Ca(e,2);return v(e,g.init(),4);case 4:return v(e,ck(g,f.Aa(),f.fa()),5);case 5:return h=e.s,v(e,h.getManifests([f.key()]),6);case 6:return k=e.s,l=k[0],n=new rk(f.Aa(),f.fa()),e["return"](sk(n,l));case 2:return Ha(e),v(e,g.destroy(),7);case 7:La(e,0)}})})};m.stop=function(){return Promise.resolve()};
m.update=function(){};
m.onExpirationUpdated=function(b,c){var d=this;return u(function f(){var g,h,k,l,n,p,q,r;return x(f,function(f){switch(f.j){case 1:return g=d.a,h=new Yj,Ba(f,2,3),v(f,h.init(),5);case 5:return v(f,ck(h,g.Aa(),g.fa()),6);case 6:return k=f.s,v(f,k.getManifests([g.key()]),7);case 7:l=f.s;n=l[0];p=n.sessionIds.includes(b);q=void 0==n.expiration||n.expiration>c;if(!p||!q){f.C(3);break}B.debug("Updating expiration for stored content");return v(f,k.updateManifestExpiration(g.key(),c),3);case 3:return Ha(f),
v(f,h.destroy(),10);case 10:La(f,0);break;case 2:r=Ga(f),B.error("There was an error updating",g,r),f.C(3)}})})};W.Lb("application/x-offline-manifest",yk);function zk(b){var c=qk(b);return c&&"manifest"==c.a?zk.h(b):c&&"segment"==c.a?zk.i(c.key(),c):Vb(new D(2,1,9004,b))}A("shaka.offline.OfflineScheme",zk);zk.h=function(b){b={uri:b,vd:b,data:new ArrayBuffer(0),headers:{"content-type":"application/x-offline-manifest"}};return Xb(b)};zk.i=function(b,c){var d=new Yj;return Xb(void 0).Z(function(){return d.init()}).Z(function(){return ck(d,c.Aa(),c.fa())}).Z(function(b){return b.getSegments([c.key()])}).Z(function(b){return{uri:c,vd:c,data:b[0].data,headers:{}}})["finally"](function(){return d.destroy()})};
lc("offline",zk);function Ak(b,c,d){return u(function f(){var g,h,k,l,n,p;return x(f,function(f){switch(f.j){case 1:g=[];for(var q=[],y=t(d),C=y.next();!C.done;C=y.next()){C=C.value;for(var z=!1,F=t(q),H=F.next();!H.done;H=F.next())if(H=H.value,Bk(H.info,C)){H.sessionIds.push(C.sessionId);z=!0;break}z||q.push({info:C,sessionIds:[C.sessionId]})}h=t(q);k=h.next();case 2:if(k.done){f.C(4);break}l=k.value;n=Ck(b,c,l);return v(f,n,5);case 5:p=f.s;g=g.concat(p);k=h.next();f.C(2);break;case 4:return f["return"](g)}})})}
function Ck(b,c,d){return u(function f(){var g,h,k,l;return x(f,function(f){switch(f.j){case 1:return g=new Qc({Db:c,onError:function(){},yc:function(){},onExpirationUpdated:function(){},onEvent:function(){}}),Ba(f,2),g.configure(b),v(f,Yc(g,d.info.keySystem,d.info.licenseUri,d.info.serverCertificate,d.info.audioCapabilities,d.info.videoCapabilities),4);case 4:Fa(f,3);break;case 2:return h=Ga(f),B.m("Error initializing EME",h),v(f,g.destroy(),5);case 5:return f["return"]([]);case 3:return Ba(f,6),
v(f,ed(g),8);case 8:Fa(f,7);break;case 6:return k=Ga(f),B.m("Error setting server certificate",k),v(f,g.destroy(),9);case 9:return f["return"]([]);case 7:return l=[],v(f,Promise.all(d.sessionIds.map(function(b){return u(function r(){var c;return x(r,function(d){switch(d.j){case 1:return Ba(d,2),v(d,hd(g,b),4);case 4:l.push(b);Fa(d,0);break;case 2:c=Ga(d),B.m("Error deleting offline session",c),w(d)}})})})),10);case 10:return v(f,g.destroy(),11);case 11:return f["return"](l)}})})}
function Bk(b,c){function d(b,c){return b.robustness==c.robustness&&b.contentType==c.contentType}return b.keySystem==c.keySystem&&b.licenseUri==c.licenseUri&&hc(b.audioCapabilities,c.audioCapabilities,d)&&hc(b.videoCapabilities,c.videoCapabilities,d)};function Dk(b,c){var d=Ek(),e=this;this.h=c;this.c=b;this.f=d;this.i=null;this.g=[];this.b=this.a=null;this.l=!0;this.o=Promise.resolve().then(function(){return Fk(e)})}Dk.prototype.destroy=function(){var b=this;return u(function d(){var e;return x(d,function(d){switch(d.j){case 1:return b.l=!1,b.b&&b.b.abort(),Gk(b),v(d,b.o,2);case 2:b.a&&b.a.za.eb();for(var f=t(b.g),h=f.next();!h.done;h=f.next())e=h.value,e.za.eb();b.a=null;b.g=[];b.h=null;w(d)}})})};
function Hk(b,c){var d={Fb:function(){},xc:function(){},eb:function(){},onError:function(){},zc:function(){},Wg:function(){}};b.g.push({create:c,za:d});b.b&&b.b.abort();Gk(b);return d}
function Fk(b){return u(function d(){return x(d,function(d){switch(d.j){case 1:if(b.l){if(0==b.g.length||b.a&&!b.a.$a)var e=!1;else{b.a&&(b.a.za.eb(),b.a=null);e=b.g.shift();var g=e.create(b.f);g?(e.za.Fb(),b.a={node:g.node,payload:g.payload,$a:g.$a,za:e.za}):e.za.zc();e=!0}e?e=Promise.resolve():b.a?e=Ik(b):(b.h.Sf(b.c),b.i=new E,e=b.i);return v(d,e,1)}d.C(0)}})})}
function Ik(b){return u(function d(){var e,f;return x(d,function(d){switch(d.j){case 1:return b.c=b.h.vf(b.c,b.f,b.a.node,b.a.payload),Ba(d,2),b.b=b.h.$e(b.c,b.f,b.a.payload),v(d,b.b.promise,4);case 4:b.b=null;b.c==b.a.node&&(b.a.za.xc(),b.a=null);Fa(d,0);break;case 2:e=Ga(d);if(7001==e.code)b.a.za.eb();else b.a.za.onError(e);b.a=null;b.b=null;f=b;return v(d,b.h.handleError(b.f,e),5);case 5:f.c=d.s,w(d)}})})}function Gk(b){b.i&&(b.i.resolve(),b.i=null)};function Jk(b){this.a=null;for(var c=0;c<b.textTracks.length;++c){var d=b.textTracks[c];d.mode="disabled";"Shaka Player TextTrack"==d.label&&(this.a=d)}this.a||(this.a=b.addTextTrack("subtitles","Shaka Player TextTrack"));this.a.mode="hidden"}A("shaka.text.SimpleTextDisplayer",Jk);Jk.prototype.remove=function(b,c){if(!this.a)return!1;Kk(this.a,function(d){return d.startTime<c&&d.endTime>b});return!0};Jk.prototype.remove=Jk.prototype.remove;
Jk.prototype.append=function(b){var c=Lk,d=b.map(function(b){if(b.nestedCues.length){var c=b.nestedCues.map(function(b){return b.spacer?"\n":b.payload+" "}).join("").replace(/ $/m,"");b=b.clone();b.nestedCues=[];b.payload=c}return b}),e=[];b=this.a.cues?Array.from(this.a.cues):[];var f={};d=t(d);for(var g=d.next();!g.done;f={Ab:f.Ab},g=d.next())f.Ab=g.value,b.some(function(b){return function(c){return c.startTime==b.Ab.startTime&&c.endTime==b.Ab.endTime&&c.text==b.Ab.payload?!0:!1}}(f))||(g=c(f.Ab))&&
e.push(g);e.slice().sort(function(b,c){return b.startTime!=c.startTime?b.startTime-c.startTime:b.endTime!=c.endTime?b.endTime-c.startTime:"line"in VTTCue.prototype?e.indexOf(c)-e.indexOf(b):e.indexOf(b)-e.indexOf(c)}).forEach(function(b){this.a.addCue(b)}.bind(this))};Jk.prototype.append=Jk.prototype.append;Jk.prototype.destroy=function(){this.a&&Kk(this.a,function(){return!0});this.a=null;return Promise.resolve()};Jk.prototype.destroy=Jk.prototype.destroy;
Jk.prototype.isTextVisible=function(){return"showing"==this.a.mode};Jk.prototype.isTextVisible=Jk.prototype.isTextVisible;Jk.prototype.setTextVisibility=function(b){this.a.mode=b?"showing":"hidden"};Jk.prototype.setTextVisibility=Jk.prototype.setTextVisibility;
function Lk(b){if(b.startTime>=b.endTime)return B.m("Invalid cue times: "+b.startTime+" - "+b.endTime),null;var c=new VTTCue(b.startTime,b.endTime,b.payload);c.lineAlign=b.lineAlign;c.positionAlign=b.positionAlign;b.size&&(c.size=b.size);try{c.align=b.textAlign}catch(d){}"center"==b.textAlign&&"center"!=c.align&&(c.align="middle");"vertical-lr"==b.writingMode?c.vertical="lr":"vertical-rl"==b.writingMode&&(c.vertical="rl");1==b.lineInterpretation&&(c.snapToLines=!1);null!=b.line&&(c.line=b.line);null!=
b.position&&(c.position=b.position);return c}function Kk(b,c){var d=b.mode;b.mode="showing"==d?"showing":"hidden";for(var e=b.cues,f=e.length-1;0<=f;f--){var g=e[f];g&&c(g)&&b.removeCue(g)}b.mode=d};function Mk(b,c,d,e,f){var g=f in e,h=!0,k;for(k in c){var l=f+"."+k,n=g?e[f]:d[k];g||k in d?void 0===c[k]?void 0===n||g?delete b[k]:b[k]=cc(n):n.constructor==Object&&c[k]&&c[k].constructor==Object?(b[k]||(b[k]=cc(n)),l=Mk(b[k],c[k],n,e,l),h=h&&l):typeof c[k]!=typeof n||null==c[k]||"function"!=typeof c[k]&&c[k].constructor!=n.constructor?(B.jc("Invalid config, wrong type for "+l),h=!1):("function"==typeof d[k]&&d[k].length!=c[k].length&&B.Y("Unexpected number of arguments for "+l),b[k]=c[k]):(B.jc("Invalid config, unrecognized key "+
l),h=!1)}return h}A("shaka.util.ConfigUtils.mergeConfigObjects",Mk);function Nk(b,c){for(var d={},e=d,f=0,g=0;;){f=b.indexOf(".",f);if(0>f)break;if(0==f||"\\"!=b[f-1])g=b.substring(g,f).replace(/\\\./g,"."),e[g]={},e=e[g],g=f+1;f+=1}e[b.substring(g).replace(/\\\./g,".")]=c;return d}A("shaka.util.ConfigUtils.convertToConfigObject",Nk);function Ok(){}A("shaka.util.PlayerConfiguration",Ok);
function Pk(){var b=5E5,c=Infinity;navigator.connection&&(navigator.connection.downlink&&(b=1E6*navigator.connection.downlink),navigator.connection.saveData&&(c=360));var d={retryParameters:Tb(),servers:{},clearKeys:{},advanced:{},delayLicenseRequestUntilPlayed:!1,initDataTransform:qd,fairPlayTransform:!0,updateExpirationTime:1},e={retryParameters:Tb(),availabilityWindowOverride:NaN,disableAudio:!1,disableVideo:!1,disableText:!1,dash:{customScheme:function(b){if(b)return null},clockSyncUri:"",ignoreDrmInfo:!1,
xlinkFailGracefully:!1,defaultPresentationDelay:10,ignoreMinBufferTime:!1,autoCorrectDrift:!0,ignoreSuggestedPresentationDelay:!1,ignoreEmptyAdaptationSet:!1},hls:{ignoreTextStreamFailures:!1,useFullSegmentsForStartTime:!1}},f={retryParameters:Tb(),failureCallback:function(b){B.error("Unhandled streaming error",b);return[b]},rebufferingGoal:2,bufferingGoal:10,bufferBehind:30,ignoreTextStreamFailures:!1,alwaysStreamText:!1,startAtSegmentBoundary:!1,smallGapLimit:.5,jumpLargeGaps:!1,durationBackoff:1,
forceTransmuxTS:!1,safeSeekOffset:5,stallEnabled:!0,stallThreshold:1,stallSkip:.1,useNativeHlsOnSafari:!0};if(Lc("Web0S")||Kc()||Lc("CrKey"))f.stallSkip=0;var g={trackSelectionCallback:function(b){return u(function n(){return x(n,function(c){switch(c.j){case 1:return c["return"](b)}})})},progressCallback:function(b,c){return[b,c]},usePersistentLicense:!0},h={drm:d,manifest:e,streaming:f,offline:g,abrFactory:P,abr:{enabled:!0,defaultBandwidthEstimate:b,switchInterval:8,bandwidthUpgradeTarget:.85,bandwidthDowngradeTarget:.95,
restrictions:{minWidth:0,maxWidth:Infinity,minHeight:0,maxHeight:c,minPixels:0,maxPixels:Infinity,minFrameRate:0,maxFrameRate:Infinity,minBandwidth:0,maxBandwidth:Infinity}},preferredAudioLanguage:"",preferredTextLanguage:"",preferredVariantRole:"",preferredTextRole:"",preferredAudioChannelCount:2,restrictions:{minWidth:0,maxWidth:Infinity,minHeight:0,maxHeight:Infinity,minPixels:0,maxPixels:Infinity,minFrameRate:0,maxFrameRate:Infinity,minBandwidth:0,maxBandwidth:Infinity},playRangeStart:0,playRangeEnd:Infinity,
textDisplayFactory:function(){return null}};g.trackSelectionCallback=function(b){return u(function n(){return x(n,function(c){switch(c.j){case 1:return c["return"](Qk(b,h.preferredAudioLanguage))}})})};return h}function Rk(b,c,d){var e={".drm.servers":"",".drm.clearKeys":"",".drm.advanced":{distinctiveIdentifierRequired:!1,persistentStateRequired:!1,videoRobustness:"",audioRobustness:"",serverCertificate:new Uint8Array(0),individualizationServer:""}};return Mk(b,c,d||Pk(),e,"")}
Ok.mergeConfigObjects=Rk;
function Qk(b,c){var d=b.filter(function(b){return"variant"==b.type}),e=[],f=Ae(c,d.map(function(b){return b.language}));f&&(e=d.filter(function(b){return N(b.language)==f}));0==e.length&&(e=d.filter(function(b){return b.primary}));0==e.length&&(1<(new Set(d.map(function(b){return b.language}))).size&&B.m("Could not choose a good audio track based on language preferences or primary tracks.  An arbitrary language will be stored!"),e=d);var g=e.filter(function(b){return b.height&&480>=b.height});g.length&&
(g.sort(function(b,c){return c.height-b.height}),e=g.filter(function(b){return b.height==g[0].height}));d=[];if(e.length){var h=Math.floor(e.length/2);e.sort(function(b,c){return b.bandwidth-c.bandwidth});d.push(e[h])}e=t(b);for(h=e.next();!h.done;h=e.next())h=h.value,"text"==h.type&&d.push(h);return d};function Sk(){this.a=null;this.b=[]}function Tk(b,c){if(null==b.a)b.a={timestamp:Date.now()/1E3,state:c,duration:0};else{var d=Date.now()/1E3;b.a.duration=d-b.a.timestamp;b.a.state!=c&&(b.b.push(b.a),b.a={timestamp:d,state:c,duration:0})}}function Uk(b,c){var d=0;b.a&&b.a.state==c&&(d+=b.a.duration);for(var e=t(b.b),f=e.next();!f.done;f=e.next())f=f.value,d+=f.state==c?f.duration:0;return d}
function Vk(b){function c(b){return{timestamp:b.timestamp,state:b.state,duration:b.duration}}for(var d=[],e=t(b.b),f=e.next();!f.done;f=e.next())d.push(c(f.value));b.a&&d.push(c(b.a));return d};function Wk(){this.b=this.c=null;this.a=[]};function Xk(){this.f=this.u=this.h=this.b=this.i=this.l=this.o=this.g=this.w=NaN;this.a=new Sk;this.c=new Wk};function Y(b,c){var d=this;bc.call(this);this.i=Yk;this.a=null;this.ob=!1;this.g=new M;this.Lc=this.l=this.Ob=this.c=this.u=this.f=this.ec=this.D=this.fc=this.H=this.qb=this.o=this.G=this.h=this.T=null;this.le=1E9;this.hc=new Set;this.sb=!0;this.sa=null;this.ke=!1;this.he=0;this.ra=null;this.ea=new Qh;this.b=Zk(this);this.ic={width:Infinity,height:Infinity};this.w=null;this.Pb=new Zh(this.b.preferredAudioLanguage,this.b.preferredVariantRole,this.b.preferredAudioChannelCount);this.qa=this.b.preferredTextLanguage;
this.nb=this.b.preferredTextRole;this.Mc=[];c&&c(this);this.T=$k(this);this.g.B(window,"online",function(){d.Cd()});this.K={name:"detach"};this.V={name:"attach"};this.Ma={name:"unload"};this.Zc={name:"manifest-parser"};this.Uc={name:"manifest"};this.pb={name:"media-source"};this.Nc={name:"drm-engine"};this.$={name:"load"};this.dd={name:"src-equals-drm-engine"};this.rb={name:"src-equals"};var e=new Map;e.set(this.V,function(b,c){return Yb(al(d,b,c))});e.set(this.K,function(b){b.v&&(d.g.pa(b.v,"error"),
b.v=null);d.a=null;b=Promise.resolve();return Yb(b)});e.set(this.Ma,function(b){return Yb(bl(d,b))});e.set(this.pb,function(b){b=cl(d,b);return Yb(b)});e.set(this.Zc,function(b,c){var e=dl(d,b,c);return Yb(e)});e.set(this.Uc,function(b){return el(d,b)});e.set(this.Nc,function(b){b=fl(d,b);return Yb(b)});e.set(this.$,function(b,c){return Yb(gl(d,b,c))});e.set(this.dd,function(b){b=hl(d,b);return Yb(b)});e.set(this.rb,function(b,c){return il(d,b,c)});this.Ta=new Dk(this.K,{vf:function(b,c,e,k){var f=
null;b==d.K&&(f=e==d.K?d.K:d.V);b==d.V&&(f=e==d.K||c.v!=k.v?d.K:e==d.V?d.V:e==d.pb||e==d.$?d.pb:e==d.rb?d.dd:null);b==d.pb&&(f=e==d.$&&c.v==k.v?d.Zc:d.Ma);b==d.Zc&&(f=jl(d.$,d.Uc,d.Ma,e,c,k));b==d.Uc&&(f=jl(d.$,d.Nc,d.Ma,e,c,k));b==d.Nc&&(f=jl(d.$,d.$,d.Ma,e,c,k));b==d.dd&&(f=e==d.rb&&c.v==k.v?d.rb:d.Ma);if(b==d.$||b==d.rb)f=d.Ma;b==d.Ma&&(f=k.v&&c.v==k.v?d.V:d.K);return f},$e:function(b,c,h){d.dispatchEvent(new K("onstatechange",{state:b.name}));return e.get(b)(c,h)},handleError:function(b,c){return u(function k(){return x(k,
function(e){switch(e.j){case 1:return B.m("The walker saw an error:"),c instanceof D?B.m("Error Code:",c.code):(B.m("Error Message:",c.message),B.m("Error Stack:",c.stack)),v(e,bl(d,b),2);case 2:return e["return"](b.v?d.V:d.K)}})})},Sf:function(b){d.dispatchEvent(new K("onstateidle",{state:b.name}))}});b&&this.Qb(b,!0)}bb(Y,bc);A("shaka.Player",Y);
Y.prototype.destroy=function(){var b=this;return u(function d(){var e;return x(d,function(d){switch(d.j){case 1:if(b.i==kl)return d["return"]();b.i=kl;e=Hk(b.Ta,function(){return{node:b.K,payload:Ek(),$a:!1}});return v(d,new Promise(function(d){e.Fb=function(){B.info("Preparing to destroy walker...")};e.xc=function(){d();b.dispatchEvent(new K("loaded"))};e.eb=function(){d()};e.onError=function(){d()};e.zc=function(){d()}}),2);case 2:return v(d,b.Ta.destroy(),3);case 3:b.g&&(b.g.release(),b.g=null);
b.Lc=null;b.l=null;b.b=null;if(!b.T){d.C(0);break}return v(d,b.T.destroy(),5);case 5:b.T=null,w(d)}})})};Y.prototype.destroy=Y.prototype.destroy;Y.version="v2.5.21";var ll=["2","5"];Ee=new function(b){this.a=b;this.c=Fe;this.b=Ge}(new Ce(Number(ll[0]),Number(ll[1])));var ml=["output-restricted","internal-error"],nl={};Y.registerSupportPlugin=function(b,c){nl[b]=c};
Y.isBrowserSupported=function(){if(!(window.Promise&&window.Uint8Array&&Array.prototype.forEach))return!1;var b=Nc();return b&&12>b||!(window.MediaKeys&&window.navigator&&window.navigator.requestMediaKeySystemAccess&&window.MediaKeySystemAccess&&window.MediaKeySystemAccess.prototype.getConfiguration)?!1:Hc()?!0:Ic("application/x-mpegurl")};
Y.probeSupport=function(){return wd().then(function(b){for(var c=W.ig(),d={},e=t('video/mp4; codecs="avc1.42E01E",video/mp4; codecs="avc3.42E01E",video/mp4; codecs="hev1.1.6.L93.90",video/mp4; codecs="hvc1.1.6.L93.90",video/mp4; codecs="hev1.2.4.L153.B0"; eotf="smpte2084",video/mp4; codecs="hvc1.2.4.L153.B0"; eotf="smpte2084",video/mp4; codecs="vp9",video/mp4; codecs="vp09.00.10.08",video/mp4; codecs="av01.0.01M.08",audio/mp4; codecs="mp4a.40.2",audio/mp4; codecs="ac-3",audio/mp4; codecs="ec-3",audio/mp4; codecs="opus",audio/mp4; codecs="flac",video/webm; codecs="vp8",video/webm; codecs="vp9",video/webm; codecs="vp09.00.10.08",audio/webm; codecs="vorbis",audio/webm; codecs="opus",video/mp2t; codecs="avc1.42E01E",video/mp2t; codecs="avc3.42E01E",video/mp2t; codecs="hvc1.1.6.L93.90",video/mp2t; codecs="mp4a.40.2",video/mp2t; codecs="ac-3",video/mp2t; codecs="ec-3",text/vtt,application/mp4; codecs="wvtt",application/ttml+xml,application/mp4; codecs="stpp"'.split(",")),f=
e.next();!f.done;f=e.next()){f=f.value;d[f]=Hc()?ae(f)?!0:MediaSource.isTypeSupported(f)||Ob(f):Ic(f);var g=f.split(";")[0];d[g]=d[g]||d[f]}b={manifest:c,media:d,drm:b};for(var h in nl)b[h]=nl[h]();return b})};Y.prototype.Qb=function(b,c){c=void 0===c?!0:c;if(this.i==kl)return Promise.reject(ol());var d=Ek();d.v=b;Hc()||(c=!1);var e=c?this.pb:this.V,f=Hk(this.Ta,function(){return{node:e,payload:d,$a:!1}});f.Fb=function(){return B.info("Starting attach...")};return pl(f)};Y.prototype.attach=Y.prototype.Qb;
Y.prototype.detach=function(){var b=this;if(this.i==kl)return Promise.reject(ol());var c=Hk(this.Ta,function(){return{node:b.K,payload:Ek(),$a:!1}});c.Fb=function(){return B.info("Starting detach...")};return pl(c)};Y.prototype.detach=Y.prototype.detach;
Y.prototype.Od=function(b){var c=this;b=void 0===b?!0:b;if(this.i==kl)return Promise.reject(ol());Hc()||(b=!1);var d=Ek(),e=Hk(this.Ta,function(e){var f=e.v&&b?c.pb:e.v?c.V:c.K;d.v=e.v;return{node:f,payload:d,$a:!1}});e.Fb=function(){return B.info("Starting unload...")};return pl(e)};Y.prototype.unload=Y.prototype.Od;
Y.prototype.load=function(b,c,d){if(this.i==kl)return Promise.reject(ol());this.dispatchEvent(new K("loading"));var e=Ek();e.uri=b;e.Ld=Date.now()/1E3;d&&"string"!=typeof d&&(De("Loading with a manifest parser factory","Please register a manifest parser and for the mime-type."),e.Ea=function(){return new d});d&&"string"==typeof d&&(e.mimeType=d);void 0!==c&&(e.startTime=c);var f=ql(this,e)?this.rb:this.$,g=Hk(this.Ta,function(b){if(null==b.v)return null;e.v=b.v;return{node:f,payload:e,$a:!0}});g.Fb=
function(){return B.info("Starting load of "+b+"...")};return new Promise(function(b,c){g.zc=function(){return c(new D(2,7,7002))};g.xc=function(){return b()};g.eb=function(){return c(ol())};g.onError=function(b){return c(b)}})};Y.prototype.load=Y.prototype.load;
function ql(b,c){if(c.Ea)return!1;if(!Hc())return!0;var d=c.mimeType,e=c.uri||"";d||(d={mp4:"video/mp4",m4v:"video/mp4",m4a:"audio/mp4",webm:"video/webm",weba:"audio/webm",mkv:"video/webm",ts:"video/mp2t",ogv:"video/ogg",ogg:"audio/ogg",mpg:"video/mpeg",mpeg:"video/mpeg",m3u8:"application/x-mpegurl",mp3:"audio/mpeg",aac:"audio/aac",flac:"audio/flac",wav:"audio/wav"}[W.getExtension(e)]);return d?""==(c.v||Jc()).canPlayType(d)?!1:W.isSupported(e,d)?Mc()&&b.b.streaming.useNativeHlsOnSafari:!0:!1}
function al(b,c,d){null==c.v&&(c.v=d.v,b.g.B(c.v,"error",function(){var c=rl(b);c&&b.Ra(c)}));b.a=c.v;return Promise.resolve()}
function bl(b,c){return u(function e(){var f;return x(e,function(e){switch(e.j){case 1:return b.i!=kl&&(b.i=Yk),f=b.Mc.map(function(b){return b()}),b.Mc=[],v(e,Promise.all(f),2);case 2:b.dispatchEvent(new K("unloading"));c.Ea=null;c.mimeType=null;c.startTime=null;c.uri=null;c.v&&(b.g.pa(c.v,"loadedmetadata"),b.g.pa(c.v,"playing"),b.g.pa(c.v,"pause"),b.g.pa(c.v,"ended"),b.g.pa(c.v,"ratechange"));b.qb&&(b.qb.release(),b.qb=null);b.fc&&(b.fc.stop(),b.fc=null);if(!b.u){e.C(3);break}return v(e,b.u.stop(),
4);case 4:b.u=null;case 3:if(!b.l){e.C(5);break}return v(e,b.l.stop(),5);case 5:if(!b.f){e.C(7);break}return v(e,b.f.destroy(),8);case 8:b.f=null;case 7:b.H&&(b.H.release(),b.H=null);b.o&&(b.o.release(),b.o=null);if(!b.G){e.C(9);break}return v(e,b.G.destroy(),10);case 10:b.G=null;case 9:if(!c.v||!c.v.src){e.C(11);break}return v(e,new Promise(function(b){return(new I(b)).R(.1)}),12);case 12:c.v.removeAttribute("src"),c.v.load();case 11:if(!b.h){e.C(13);break}return v(e,b.h.destroy(),14);case 14:b.h=
null;case 13:b.ea.a.clear(),b.Ob=null,b.D=null,b.hc.clear(),b.c=null,b.w=null,b.Rc=null,b.sb=!0,sl(b),w(e)}})})}function cl(b,c){return u(function e(){var f,g,h,k;return x(e,function(e){switch(e.j){case 1:return f=window.muxjs?new Bd:new Cd,g=b.b.textDisplayFactory,h=new g,b.Rc=g,k=new fe(c.v,f,h),v(e,k.u,2);case 2:b.G=k,w(e)}})})}
function dl(b,c,d){return u(function f(){var g,h,k,l;return x(f,function(f){switch(f.j){case 1:c.Ea=d.Ea;c.mimeType=d.mimeType;c.uri=d.uri;g=c.uri;h=b.T;b.Ob=g;if(c.Ea){b.u=c.Ea();f.C(2);break}k=b;return v(f,W.create(g,h,b.b.manifest.retryParameters,c.mimeType),3);case 3:k.u=f.s;case 2:l=cc(b.b.manifest),d.v&&"AUDIO"===d.v.nodeName&&(l.disableVideo=!0),b.u.configure(l),w(f)}})})}
function el(b,c){var d=c.uri,e=b.T;b.ec=new Ki(function(){return b.Ce()});Li(b.ec,function(c){tl(b,"timelineregionadded",c)});var f={networkingEngine:e,filterNewPeriod:function(c){return b.Vc(c)},filterAllPeriods:function(c){return ul(b,c)},onTimelineRegionAdded:function(c){var d=b.ec;a:{var e=t(d.a);for(var f=e.next();!f.done;f=e.next())if(f=f.value,f.schemeIdUri==c.schemeIdUri&&f.id==c.id&&f.startTime==c.startTime&&f.endTime==c.endTime){e=f;break a}e=null}null==e&&(d.a.add(c),d.b(c))},onEvent:function(c){return b.dispatchEvent(c)},
onError:function(c){return b.Ra(c)}};return new J(Promise.resolve().then(function(){return u(function h(){var c;return x(h,function(e){switch(e.j){case 1:return c=b,v(e,b.u.start(d,f),2);case 2:c.c=e.s;b.dispatchEvent(new K("manifestparsed"));if(0==b.c.periods.length)throw new D(2,4,4014);vl(b.c.periods);w(e)}})})}),function(){B.info("Aborting parser step...");return b.u.stop()})}
function fl(b,c){return u(function e(){return x(e,function(e){switch(e.j){case 1:return b.h=wl(b,{Db:b.T,onError:function(c){b.Ra(c)},yc:function(c){xl(b,c)},onExpirationUpdated:function(c,e){yl(b,c,e)},onEvent:function(c){b.dispatchEvent(c)}}),b.h.configure(b.b.drm),v(e,Xc(b.h,oi(b.c.periods),b.c.offlineSessionIds),2);case 2:return v(e,b.h.Qb(c.v),3);case 3:ul(b,b.c.periods),w(e)}})})}
function gl(b,c,d){return u(function f(){var g,h,k,l,n,p,q,r,y,C;return x(f,function(f){switch(f.j){case 1:return c.startTime=d.startTime,g=c.v,h=c.uri,b.Ob=h,b.H=new si({rc:function(){return c.v.playbackRate},Id:function(b){c.v.playbackRate=b},me:function(b){c.v.currentTime+=b}}),b.w=new Xk,k=function(){return zl(b)},l=function(){return Al(b)},b.g.B(g,"playing",k),b.g.B(g,"pause",k),b.g.B(g,"ended",k),b.g.B(g,"ratechange",l),n=b.b.abrFactory,b.l&&b.Lc==n||(b.Lc=n,b.l=new n,b.l.configure(b.b.abr)),
Bl(b,b.c.periods),b.Pb=new Zh(b.b.preferredAudioLanguage,b.b.preferredVariantRole,b.b.preferredAudioChannelCount),b.qa=b.b.preferredTextLanguage,Cl(b.c.presentationTimeline,b.b.playRangeStart,b.b.playRangeEnd),b.l.init(function(c,d,f){d=void 0===d?!1:d;f=void 0===f?0:f;B.debug("switch_");a:{var g=t(b.c.periods);for(var h=g.next();!h.done;h=g.next())if(h=h.value,h.variants.includes(c)){g=h;break a}g=null}Dl(b,g,c,!0);b.f&&fj(b.f,c,d,f)&&El(b)}),b.o=Fl(b,c.startTime),b.qb=Gl(b),p=Math.max(b.c.minBufferTime,
b.b.streaming.rebufferingGoal),Hl(b,p),b.f=Il(b),b.f.configure(b.b.streaming),O.Vd(b.c,b.b.preferredAudioChannelCount),b.i=Jl,b.dispatchEvent(new K("streaming")),v(f,b.f.start(),2);case 2:b.b.streaming.startAtSegmentBoundary&&(q=b.o.g(),r=Kl(b,q),b.o.o(r)),b.c.periods.forEach(b.Vc.bind(b)),Ll(b),El(b),y=Ml(b)||b.c.periods[0],C=y.variants.some(function(b){return b.primary}),b.b.preferredAudioLanguage||C||B.m("No preferred audio language set.  We will choose an arbitrary language initially"),Nl(b,y.variants),
b.g.ua(g,"loadedmetadata",function(){b.w.b=Date.now()/1E3-d.Ld}),w(f)}})})}
function hl(b,c){return u(function e(){var f,g;return x(e,function(e){switch(e.j){case 1:return f=Ab,b.h=wl(b,{Db:b.T,onError:function(c){b.Ra(c)},yc:function(c){xl(b,c)},onExpirationUpdated:function(c,e){yl(b,c,e)},onEvent:function(c){b.dispatchEvent(c)}}),b.h.configure(b.b.drm),g={id:0,language:"und",primary:!1,audio:null,video:{id:0,originalId:null,createSegmentIndex:Promise.resolve.bind(Promise),findSegmentPosition:function(){return null},getSegmentReference:function(){return null},initSegmentReference:null,
presentationTimeOffset:0,mimeType:"video/mp4",codecs:"",encrypted:!0,keyId:null,language:"und",label:null,type:f.Ua,primary:!1,frameRate:void 0,pixelAspectRatio:void 0,trickModeVideo:null,emsgSchemeIdUris:null,roles:[],channelsCount:null,audioSamplingRate:null,closedCaptions:null},bandwidth:100,drmInfos:[],allowedByApplication:!0,allowedByKeySystem:!0},v(e,Xc(b.h,[g],[]),2);case 2:return v(e,b.h.Qb(c.v),0)}})})}
function il(b,c,d){function e(){return zl(b)}c.uri=d.uri;c.startTime=d.startTime;b.Ob=c.uri;b.w=new Xk;b.o=new Di(c.v);null!=c.startTime&&b.o.o(c.startTime);b.H=new si({rc:function(){return c.v.playbackRate},Id:function(b){c.v.playbackRate=b},me:function(b){c.v.currentTime+=b}});Hl(b,b.b.streaming.rebufferingGoal);b.g.B(c.v,"playing",e);b.g.B(c.v,"pause",e);b.g.B(c.v,"ended",e);b.g.B(c.v,"ratechange",function(){return Al(b)});"none"!=b.a.preload&&b.g.ua(c.v,"loadedmetadata",function(){b.w.b=Date.now()/
1E3-d.Ld});b.a.audioTracks&&(b.g.B(b.a.audioTracks,"addtrack",function(){return Ll(b)}),b.g.B(b.a.audioTracks,"removetrack",function(){return Ll(b)}),b.g.B(b.a.audioTracks,"change",function(){return Ll(b)}));if(b.a.textTracks){var f=b.a.textTracks;b.g.B(f,"addtrack",function(){return Ll(b)});b.g.B(f,"removetrack",function(){return Ll(b)});b.g.B(f,"change",function(){return Ll(b)})}c.v.src=c.uri;(Kc()||Lc("Web0S"))&&c.v.load();b.i=Ol;b.dispatchEvent(new K("streaming"));var g=new E;ui(b.a,HTMLMediaElement.HAVE_METADATA,
b.g,function(){g.resolve()});var h=!1;b.Mc.push(function(){h=!0});ui(b.a,HTMLMediaElement.HAVE_CURRENT_DATA,b.g,function(){return u(function l(){var c;return x(l,function(d){switch(d.j){case 1:if(h)return d["return"]();Pl(b);c=Ql(b);if(c.find(function(b){return"disabled"!=b.mode})){d.C(2);break}return v(d,new Promise(function(c){b.g.ua(b.a.textTracks,"change",c);(new I(c)).R(1)}),2);case 2:if(h)return d["return"]();Rl(b);w(d)}})})});b.a.error?g.reject(rl(b)):"none"==b.a.preload&&(B.Y('With <video preload="none">, the browser will not load anything until play() is called. We are unable to measure load latency in a meaningful way, and we cannot provide track info yet. Please do not use preload="none" with Shaka Player.'),
g.resolve());b.g.ua(b.a,"error",function(){g.reject(rl(b))});return new J(g,function(){g.reject(new D(2,7,7001));return Promise.resolve()})}function Pl(b){var c=b.b.preferredAudioLanguage;if(""!=c){b.Dd(c);var d=b.b.preferredVariantRole;""!=d&&b.Dd(c,d)}}function Rl(b){var c=b.b.preferredTextLanguage;if(""!=c){b.Ed(c);var d=b.b.preferredTextRole;""!=d&&b.Ed(c,d)}}
function vl(b){function c(b){return b.video&&b.audio||b.video&&b.video.codecs.includes(",")}b.some(function(b){return b.variants.some(c)})&&(B.debug("Found variant with audio and video content, so filtering out audio-only content in all periods."),b.forEach(function(b){b.variants=b.variants.filter(c)}))}function wl(b,c){return new Qc(c,b.b.drm.updateExpirationTime)}function $k(b){return new L(function(c,d){b.l&&b.l.segmentDownloaded(c,d)})}
function Fl(b,c){return new Ei(b.a,b.c,b.b.streaming,c,function(){b.qb&&ni(b.qb,!0);b.f&&mj(b.f);b.D&&Sl(b)},function(c){return b.dispatchEvent(c)})}function Gl(b){var c=new qi(b.c);ri(c,function(){Ll(b)});var d=new Mi(b.ec);Qi(d,function(c){tl(b,"timelineregionenter",c)},function(c){tl(b,"timelineregionexit",c)},function(c,d){d||(tl(b,"timelineregionenter",c),tl(b,"timelineregionexit",c))});var e=new mi(b.a);e.a.add(c);e.a.add(d);return e}
function Hl(b,c){b.D=new ci;b.D.a=ei;fi(b.D,c,Math.min(.5,c/2));sl(b);b.fc=(new I(function(){Sl(b)})).Ka(.25)}function Sl(b){switch(b.i){case Ol:var c=b.a.ended?!0:Dd(b.a.buffered)>=b.a.duration-1;break;case Jl:a:if(b.a.ended||ke(b.G))c=!0;else{if(b.c.presentationTimeline.X()){var d=b.c.presentationTimeline.xb();if(Dd(b.a.buffered)>=d){c=!0;break a}}c=!1}break;default:c=!1}var e=Fd(b.a.buffered,b.a.currentTime);d=b.D;var f=c,g=d.b.get(d.a);c=d.a;e=f||e>=g?di:ei;d.a=e;c!=e&&sl(b)}
function Il(b){return new Ri(b.c,{Za:function(){return b.o.g()},getBandwidthEstimate:function(){return b.l.getBandwidthEstimate()},O:b.G,Db:b.T,pe:b.Qf.bind(b),oe:b.Ue.bind(b),onError:b.Ra.bind(b),onEvent:function(c){return b.dispatchEvent(c)},Uf:b.Vf.bind(b),td:b.$f.bind(b)})}Y.prototype.configure=function(b,c){2==arguments.length&&"string"==typeof b&&(b=Nk(b,c));var d=Rk(this.b,b,Zk(this));Tl(this);return d};Y.prototype.configure=Y.prototype.configure;
function Tl(b){if(b.u){var c=cc(b.b.manifest);b.a&&"AUDIO"===b.a.nodeName&&(c.disableVideo=!0);b.u.configure(c)}b.h&&b.h.configure(b.b.drm);if(b.f){b.f.configure(b.b.streaming);try{b.c.periods.forEach(b.Vc.bind(b))}catch(g){b.Ra(g)}var d=Wi(b.f),e=Yi(b.f);c=Ml(b);d=O.de(d,e,c.variants);b.l&&d&&d.allowedByApplication&&d.allowedByKeySystem?Nl(b,c.variants):(B.debug("Choosing new streams after changing configuration"),Ul(b,c))}if(b.G&&(c=b.b.textDisplayFactory,b.Rc!=c)){d=new c;e=b.G;var f=e.g;e.g=d;
f&&(d.setTextVisibility(f.isTextVisible()),f.destroy());e.a&&(e.a.c=d);b.Rc=c;b.f&&(c=b.f,(d=c.b.get("text"))&&ej(c,d.stream,!0,0,!0))}b.l&&(b.l.configure(b.b.abr),b.b.abr.enabled&&!b.sb?b.l.enable():b.l.disable(),Vl(b));b.D&&(c=b.b.streaming.rebufferingGoal,b.c&&(c=Math.max(c,b.c.minBufferTime)),fi(b.D,c,Math.min(.5,c/2)))}Y.prototype.getConfiguration=function(){var b=Zk(this);Rk(b,this.b,Zk(this));return b};Y.prototype.getConfiguration=Y.prototype.getConfiguration;
Y.prototype.qg=function(){for(var b in this.b)delete this.b[b];Rk(this.b,Zk(this),Zk(this));Tl(this)};Y.prototype.resetConfiguration=Y.prototype.qg;Y.prototype.nf=function(){return this.i};Y.prototype.getLoadMode=Y.prototype.nf;Y.prototype.tf=function(){return this.a};Y.prototype.getMediaElement=Y.prototype.tf;Y.prototype.Ub=function(){return this.T};Y.prototype.getNetworkingEngine=Y.prototype.Ub;Y.prototype.pc=function(){return this.Ob};Y.prototype.getAssetUri=Y.prototype.pc;
Y.prototype.rf=function(){De("getManifestUri",'Please use "getAssetUri" instead.');return this.pc()};Y.prototype.getManifestUri=Y.prototype.rf;Y.prototype.X=function(){return this.c?this.c.presentationTimeline.X():this.a&&this.a.src?Infinity==this.a.duration:!1};Y.prototype.isLive=Y.prototype.X;Y.prototype.bb=function(){return this.c?this.c.presentationTimeline.bb():!1};Y.prototype.isInProgress=Y.prototype.bb;
Y.prototype.Lf=function(){if(this.c){if(!this.c.periods.length)return!1;var b=this.c.periods[0].variants;return b.length?!b[0].video:!1}return this.a&&this.a.src?this.a.videoTracks?0==this.a.videoTracks.length:0==this.a.videoHeight:!1};Y.prototype.isAudioOnly=Y.prototype.Lf;Y.prototype.Ce=function(){if(this.c){var b=this.c.presentationTimeline;return{start:b.wb(),end:b.Ga()}}return this.a&&this.a.src&&(b=this.a.seekable,b.length)?{start:b.start(0),end:b.end(b.length-1)}:{start:0,end:0}};
Y.prototype.seekRange=Y.prototype.Ce;Y.prototype.keySystem=function(){return kd(this.drmInfo())};Y.prototype.keySystem=Y.prototype.keySystem;Y.prototype.drmInfo=function(){return this.h?this.h.a:null};Y.prototype.drmInfo=Y.prototype.drmInfo;Y.prototype.Tb=function(){return this.h?this.h.Tb():Infinity};Y.prototype.getExpiration=Y.prototype.Tb;Y.prototype.fd=function(){return this.D?this.D.a==ei:!1};Y.prototype.isBuffering=Y.prototype.fd;
Y.prototype.xf=function(){if(this.H){var b=this.H;b=b.f?0:b.c}else b=0;return b};Y.prototype.getPlaybackRate=Y.prototype.xf;Y.prototype.Ig=function(b){0==b?B.Y("A trick play rate of 0 is unsupported!"):(this.a.paused&&this.a.play(),this.H&&this.H.set(b),this.i==Jl&&dj(this.f,1<Math.abs(b)))};Y.prototype.trickPlay=Y.prototype.Ig;Y.prototype.Ve=function(){this.i==Ol&&this.H.set(1);this.i==Jl&&(this.H.set(1),dj(this.f,!1))};Y.prototype.cancelTrickPlay=Y.prototype.Ve;
Y.prototype.cd=function(){if(this.c&&this.o){for(var b=Wl(this),c=[],d=t(Xl(this)),e=d.next();!e.done;e=d.next()){e=e.value;var f=O.Qd(e);f.active=e==b;c.push(f)}return c}return this.a&&this.a.audioTracks?Array.from(this.a.audioTracks).map(function(b){return O.ee(b)}):[]};Y.prototype.getVariantTracks=Y.prototype.cd;
Y.prototype.zb=function(){if(this.c&&this.o){for(var b=Yl(this),c=[],d=t(Zl(this)),e=d.next();!e.done;e=d.next()){e=e.value;var f=O.Fc(e);f.active=e==b;c.push(f)}return c}return this.a&&this.a.src&&this.a.textTracks?Ql(this).map(function(b){return O.Jf(b)}):[]};Y.prototype.getTextTracks=Y.prototype.zb;
Y.prototype.Fd=function(b){if(this.c&&this.f){var c=Ml(this),d=c.textStreams.find(function(c){return c.id==b.id});d?($l(this,c,d,!1),am(this,d),this.qa=d.language):B.error("No stream with id",b.id)}else if(this.a&&this.a.src&&this.a.textTracks){c=Ql(this);c=t(c);for(d=c.next();!d.done;d=c.next())d=d.value,O.ed(d)==b.id?d.mode=this.ob?"showing":"hidden":d.mode="disabled";bm(this)}};Y.prototype.selectTextTrack=Y.prototype.Fd;
Y.prototype.sg=function(){De("selectEmbeddedTextTrack","If closed captions are signaled in the manifest, a text stream will be created to represent them. Please use SelectTextTrack.");var b=this.zb().filter(function(b){return"application/cea-608"==b.mimeType});0<b.length?this.Fd(b[0]):B.m("Unable to find the text track embedded in the video.")};Y.prototype.selectEmbeddedTextTrack=Y.prototype.sg;
Y.prototype.Ng=function(){De("usingEmbeddedTextTrack","If closed captions are signaled in the manifest, a text stream will be created to represent them. There should be no reason to know if the player is playing embedded text.");var b=this.zb().filter(function(b){return b.active})[0];return b?"application/cea-608"==b.mimeType:!1};Y.prototype.usingEmbeddedTextTrack=Y.prototype.Ng;
Y.prototype.tg=function(b,c,d){d=void 0===d?0:d;if(this.c&&this.f){var e=Ml(this);this.b.abr.enabled&&B.Y("Changing tracks while abr manager is enabled will likely result in the selected track being overriden. Consider disabling abr before calling selectVariantTrack().");var f=e.variants.find(function(c){return c.id==b.id});f?O.Bb(f)?(Dl(this,e,f,!1),cm(this,f,c,d),this.Pb=new Yh(f),Nl(this,e.variants)):B.error("Unable to switch to restricted track",b.id):B.error("No variant with id",b.id)}else if(this.a&&
this.a.audioTracks){c=Array.from(this.a.audioTracks);c=t(c);for(d=c.next();!d.done;d=c.next())d=d.value,O.ed(d)==b.id&&(d.enabled=!0);dm(this)}};Y.prototype.selectVariantTrack=Y.prototype.tg;Y.prototype.hf=function(){return em(this.cd())};Y.prototype.getAudioLanguagesAndRoles=Y.prototype.hf;Y.prototype.Ef=function(){return em(this.zb())};Y.prototype.getTextLanguagesAndRoles=Y.prototype.Ef;Y.prototype.gf=function(){return Array.from(fm(this.cd()))};Y.prototype.getAudioLanguages=Y.prototype.gf;
Y.prototype.Df=function(){return Array.from(fm(this.zb()))};Y.prototype.getTextLanguages=Y.prototype.Df;Y.prototype.Dd=function(b,c){if(this.c&&this.o){var d=Ml(this);this.Pb=new Zh(b,c||"",0,"");gm(this,d)}else if(this.a&&this.a.audioTracks){var e=Array.from(this.a.audioTracks);d=N(b);var f=null,g=null;e=t(e);for(var h=e.next();!h.done;h=e.next()){h=h.value;var k=O.ee(h);N(k.language)==d&&(f=h,c?k.roles.includes(c)&&(g=h):0==k.roles.length&&(g=h))}g?(g.enabled=!0,dm(this)):f&&(f.enabled=!0,dm(this))}};
Y.prototype.selectAudioLanguage=Y.prototype.Dd;Y.prototype.Ed=function(b,c){if(this.c&&this.o){var d=Ml(this);this.qa=b;this.nb=c||"";var e=O.Sb(d.textStreams,this.qa,this.nb)[0]||null;e&&($l(this,d,e,!1),(this.b.streaming.alwaysStreamText||this.uc())&&am(this,e))}else{var f=N(b);(d=this.zb().filter(function(b){return N(b.language)==f&&(!c||b.roles.includes(c))})[0])&&this.Fd(d)}};Y.prototype.selectTextLanguage=Y.prototype.Ed;
Y.prototype.ug=function(b){if(this.c&&this.o){for(var c=Ml(this),d=null,e=t(Xl(this)),f=e.next();!f.done;f=e.next())if(f=f.value,f.audio.label==b){d=f;break}null==d?B.m("No variants were found with label: "+b+". Ignoring the request to switch."):(this.Pb=new Zh(d.language,"",0,b),gm(this,c))}};Y.prototype.selectVariantsByLabel=Y.prototype.ug;
Y.prototype.uc=function(){var b=this.ob;return this.G?this.G.g.isTextVisible():this.a&&this.a.src&&this.a.textTracks?Ql(this).some(function(b){return"showing"==b.mode}):b};Y.prototype.isTextTrackVisible=Y.prototype.uc;function Ql(b){return Array.from(b.a.textTracks).filter(function(b){return"metadata"!=b.kind&&"chapters"!=b.kind&&"Shaka Player TextTrack"!=b.label})}
Y.prototype.xg=function(b){var c=this;return u(function e(){var f,g,h,k,l,n;return x(e,function(e){switch(e.j){case 1:f=c.ob;g=!!b;if(f==g)return e["return"]();c.ob=g;if(c.i!=Jl){if(c.a&&c.a.src&&c.a.textTracks){h=Ql(c);for(var p=t(h),r=p.next();!r.done;r=p.next())k=r.value,"disabled"!=k.mode&&(k.mode=g?"showing":"hidden")}e.C(2);break}c.G.g.setTextVisibility(g);if(c.b.streaming.alwaysStreamText){e.C(2);break}if(!g){cj(c.f);e.C(2);break}if(Xi(c.f,"text")){e.C(2);break}l=Ml(c);n=O.Sb(l.textStreams,
c.qa,c.nb);if(!(0<n.length)){e.C(2);break}return v(e,Zi(c.f,n[0]),2);case 2:hm(c),w(e)}})})};Y.prototype.setTextTrackVisibility=Y.prototype.xg;
Y.prototype.zf=function(){if(!this.X())return B.m("getPlayheadTimeAsDate is for live streams!"),null;var b=this.Ta.f,c=0;if(this.o)c=this.o.g();else if(b){if(null==b.startTime)return new Date;c=b.startTime}if(this.c)return new Date(1E3*(this.c.presentationTimeline.f+this.a.currentTime));if(this.a&&this.a.getStartDate)return b=this.a.getStartDate(),isNaN(b.getTime())?(B.m("EXT-X-PROGRAM-DATETIME required to get playhead time as Date!"),null):new Date(b.getTime()+1E3*c);B.m("No way to get playhead time as Date!");
return null};Y.prototype.getPlayheadTimeAsDate=Y.prototype.zf;Y.prototype.Bf=function(){if(!this.X())return B.m("getPresentationStartTimeAsDate is for live streams!"),null;if(this.c)return new Date(1E3*this.c.presentationTimeline.f);if(this.a&&this.a.getStartDate){var b=this.a.getStartDate();return isNaN(b.getTime())?(B.m("EXT-X-PROGRAM-DATETIME required to get presentation start time as Date!"),null):b}B.m("No way to get presentation start time as Date!");return null};
Y.prototype.getPresentationStartTimeAsDate=Y.prototype.Bf;Y.prototype.$c=function(){var b={total:[],audio:[],video:[],text:[]};this.i==Ol&&(b.total=Gd(this.a.buffered));this.i==Jl&&this.G.$c(b);return b};Y.prototype.getBufferedInfo=Y.prototype.$c;
Y.prototype.getStats=function(){if(this.i!=Jl&&this.i!=Ol)return{width:NaN,height:NaN,streamBandwidth:NaN,decodedFrames:NaN,droppedFrames:NaN,corruptedFrames:NaN,estimatedBandwidth:NaN,loadLatency:NaN,playTime:NaN,pauseTime:NaN,bufferingTime:NaN,licenseTime:NaN,switchHistory:[],stateHistory:[]};zl(this);var b=this.a;if(b.getVideoPlaybackQuality){b=b.getVideoPlaybackQuality();var c=this.w,d=Number(b.totalVideoFrames);c.o=Number(b.droppedVideoFrames);c.l=d;this.w.i=Number(b.corruptedVideoFrames)}this.h?
(b=this.h,b=b.K?b.K:NaN):b=NaN;this.w.h=b;if(this.i==Jl){if(b=Wl(this))this.w.u=b.bandwidth;b&&b.video&&(c=this.w,d=b.video.height||NaN,c.w=b.video.width||NaN,c.g=d);b=this.l.getBandwidthEstimate();this.w.f=b}var e=this.w;b=e.w;c=e.g;d=e.u;var f=e.l,g=e.o,h=e.i,k=e.f,l=e.b,n=Uk(e.a,"playing"),p=Uk(e.a,"paused"),q=Uk(e.a,"buffering"),r=e.h,y=Vk(e.a),C=[];e=t(e.c.a);for(var z=e.next();!z.done;z=e.next())z=z.value,C.push({timestamp:z.timestamp,id:z.id,type:z.type,fromAdaptation:z.fromAdaptation,bandwidth:z.bandwidth});
return{width:b,height:c,streamBandwidth:d,decodedFrames:f,droppedFrames:g,corruptedFrames:h,estimatedBandwidth:k,loadLatency:l,playTime:n,pauseTime:p,bufferingTime:q,licenseTime:r,stateHistory:y,switchHistory:C}};Y.prototype.getStats=Y.prototype.getStats;
Y.prototype.addTextTrack=function(b,c,d,e,f,g){var h=this;return u(function l(){var n,p,q,r,y,C,z,F,H;return x(l,function(l){switch(l.j){case 1:if(h.i==Ol)throw B.error("Cannot add text when loaded with src="),Error("State error!");if(h.i!=Jl)throw B.error("Must call load() and wait for it to resolve before adding text tracks."),Error("State error!");n=Ml(h);p=Ab;q=h.c.periods.indexOf(n);r=q+1;y=r>=h.c.periods.length?h.c.presentationTimeline.ca():h.c.periods[r].startTime;C=y-n.startTime;if(Infinity==
C)throw new D(1,4,4033);z=new V(1,0,C,function(){return[b]},0,null);F={id:h.le++,originalId:null,createSegmentIndex:Promise.resolve.bind(Promise),findSegmentPosition:function(){return 1},getSegmentReference:function(b){return 1==b?z:null},initSegmentReference:null,presentationTimeOffset:0,mimeType:e,codecs:f||"",kind:d,encrypted:!1,keyId:null,language:c,label:g||null,type:p.va,primary:!1,frameRate:void 0,pixelAspectRatio:void 0,trickModeVideo:null,emsgSchemeIdUris:null,roles:[],channelsCount:null,
audioSamplingRate:null,closedCaptions:null};h.hc.add(F);n.textStreams.push(F);return v(l,Zi(h.f,F),2);case 2:return(H=Xi(h.f,"text"))&&Rh(h.ea,n,H),h.hc["delete"](F),B.debug("Choosing new streams after adding a text stream"),Ul(h,n),Ll(h),l["return"](O.Fc(F))}})})};Y.prototype.addTextTrack=Y.prototype.addTextTrack;Y.prototype.Hd=function(b,c){this.ic.width=b;this.ic.height=c};Y.prototype.setMaxHardwareResolution=Y.prototype.Hd;
Y.prototype.Cd=function(){if(this.i==Jl){var b=this.f;if(b.f)B.error("Unable to retry after StreamingEngine is destroyed!"),b=!1;else if(b.o)B.error("Unable to retry after StreamingEngine encountered a fatal error!"),b=!1;else{for(var c=t(b.b.values()),d=c.next();!d.done;d=c.next()){d=d.value;var e=ij(d);d.Xb&&(B.info(e,"Retrying after failure..."),d.Xb=!1,bj(b,d,.1))}b=!0}}else b=!1;return b};Y.prototype.retryStreaming=Y.prototype.Cd;Y.prototype.pf=function(){return this.c};
Y.prototype.getManifest=Y.prototype.pf;Y.prototype.qf=function(){return this.u?this.u.constructor:null};Y.prototype.getManifestParserFactory=Y.prototype.qf;function Dl(b,c,d,e){Sh(b.ea,c).variant=d;b=b.w.c;b.c!=d&&(b.c=d,b.a.push({timestamp:Date.now()/1E3,id:d.id,type:"variant",fromAdaptation:e,bandwidth:d.bandwidth}))}function $l(b,c,d,e){Rh(b.ea,c,d);b=b.w.c;b.b!=d&&(b.b=d,b.a.push({timestamp:Date.now()/1E3,id:d.id,type:"text",fromAdaptation:e,bandwidth:null}))}
function Zk(b){var c=Pk();c.streaming.failureCallback=function(c){var d=[1001,1002,1003];b.X()&&d.includes(c.code)&&(c.severity=1,B.m("Live streaming error.  Retrying automatically..."),b.Cd())};c.textDisplayFactory=function(){return new Jk(b.a)};return c}
function Bl(b,c){for(var d=0;d<c.length;d++){for(var e=c[d],f=new Map,g=t(e.variants),h=g.next();!h.done;h=g.next())if(h=h.value,h.video&&h.video.closedCaptions){h=h.video;for(var k=t(h.closedCaptions.keys()),l=k.next();!l.done;l=k.next())if(l=l.value,!f.has(l)){var n={id:b.le++,originalId:l,createSegmentIndex:Promise.resolve.bind(Promise),findSegmentPosition:function(){return null},getSegmentReference:function(){return null},initSegmentReference:null,presentationTimeOffset:0,mimeType:"application/cea-608",
codecs:"",kind:"caption",encrypted:!1,keyId:null,language:h.closedCaptions.get(l),label:null,type:"text",primary:!1,frameRate:void 0,pixelAspectRatio:void 0,trickModeVideo:null,emsgSchemeIdUris:null,roles:h.roles,channelsCount:null,audioSamplingRate:null,closedCaptions:null};f.set(l,n)}}f=t(f.values());for(g=f.next();!g.done;g=f.next())e.textStreams.push(g.value)}}
function ul(b,c){var d=b.f?Wi(b.f):null,e=b.f?Yi(b.f):null;c.forEach(O.filterNewPeriod.bind(null,b.h,d,e));d=gc(c,function(b){return b.variants.some(O.Bb)});if(0==d)throw new D(2,4,4032);if(d<c.length)throw new D(2,4,4011);c.forEach(function(b){O.Sd(b.variants,this.b.restrictions,this.ic)&&this.f&&Ml(this)==b&&Ll(this);im(this,b.variants)}.bind(b))}m=Y.prototype;
m.Vc=function(b){var c=this.f?Wi(this.f):null,d=this.f?Yi(this.f):null;O.filterNewPeriod(this.h,c,d,b);c=b.variants;if(!c.some(O.Bb))throw new D(2,4,4011);im(this,b.variants);O.Sd(c,this.b.restrictions,this.ic)&&this.f&&Ml(this)==b&&Ll(this);if((b=this.h?this.h.a:null)&&this.h.i)for(c=t(c),d=c.next();!d.done;d=c.next()){d=t(d.value.drmInfos);for(var e=d.next();!e.done;e=d.next())if(e=e.value,e.keySystem==b.keySystem){e=t(e.initData||[]);for(var f=e.next();!f.done;f=e.next())f=f.value,gd(this.h,f.initDataType,
f.initData)}}};function cm(b,c,d,e){d=void 0===d?!1:d;e=void 0===e?0:e;if(b.sb)return b.sa=c,b.ke=d,b.he=e,!0;(c=fj(b.f,c,d,e))&&dm(b);return c}function am(b,c){if(b.sb)return b.ra=c,!0;var d=ej(b.f,c,!0,0,!1);d&&bm(b);return d}
function Kl(b,c){function d(b,c){if(!b)return null;var d=b.findSegmentPosition(c-g.startTime);return null==d?null:(d=b.getSegmentReference(d))?d.startTime+g.startTime:null}var e=Wi(b.f),f=Yi(b.f),g=Ml(b);e=d(e,c);f=d(f,c);return null!=f&&null!=e?Math.max(f,e):null!=f?f:null!=e?e:c}function sl(b){var c=b.fd();if(b.w&&b.D&&b.o){var d=b.H;d.f=c;ti(d);zl(b)}b.dispatchEvent(new K("buffering",{buffering:c}))}function Al(b){var c=b.a.playbackRate;0!=c&&b.H.set(c)}
function zl(b){if(b.w&&b.D){var c=b.w.a;b.D.a==ei?Tk(c,"buffering"):b.a.paused?Tk(c,"paused"):b.a.ended?Tk(c,"ended"):Tk(c,"playing")}}function Nl(b,c){try{im(b,c)}catch(e){return b.Ra(e),null}var d=c.filter(function(b){return O.Bb(b)});d=b.Pb.create(d);b.l.setVariants(Array.from(d.values()));return b.l.chooseVariant()}function Ul(b,c){var d=gm(b,c,!1),e=O.Sb(c.textStreams,b.qa,b.nb)[0]||null,f=!1;e&&(b.b.streaming.alwaysStreamText||b.uc())&&($l(b,c,e,!0),f=am(b,e));(d||f)&&El(b)}
function gm(b,c,d){d=void 0===d?!0:d;var e=Nl(b,c.variants),f=!1;e&&(Dl(b,c,e,!0),f=cm(b,e,!0));d&&f&&El(b);return f}
m.Qf=function(b){B.debug("onChooseStreams_",b);try{B.J("onChooseStreams_, choosing variant from ",b.variants);B.J("onChooseStreams_, choosing text from ",b.textStreams);this.sb=!0;this.l.disable();Vl(this);B.debug("Choosing new streams after period changed");var c=Nl(this,b.variants),d=O.Sb(b.textStreams,this.qa,this.nb)[0]||null;this.sa&&(b.variants.includes(this.sa)&&(c=this.sa),this.sa=null);this.ra&&(b.textStreams.includes(this.ra)&&(d=this.ra),this.ra=null);c&&Dl(this,b,c,!0);d&&$l(this,b,d,
!0);var e=this.f,f=e.b.get("video");if(f)var g=e.c.periods[f.ka];else{var h=e.b.get("audio");g=h?e.c.periods[h.ka]:null}var k=c?c.audio:null;if(!g&&d){var l;if(l=k){b=d;var n=N(this.b.preferredTextLanguage),p=N(k.language),q=N(b.language);l=we(q,n)&&!we(p,q)}l&&(this.ob=!0);this.ob&&this.G.g.setTextVisibility(!0);hm(this)}var r=this.b.streaming.alwaysStreamText||this.uc()?{variant:c,text:d}:{variant:c,text:null};B.J("onChooseStreams_, chose variant ",r.variant);B.J("onChooseStreams_, chose text ",
r.text);return r}catch(y){return this.Ra(y),{variant:null,text:null}}};m.Ue=function(){B.debug("canSwitch_");this.sb=!1;this.b.abr.enabled&&(this.l.enable(),Vl(this));this.sa&&(fj(this.f,this.sa,this.ke,this.he),dm(this),this.sa=null);this.ra&&(ej(this.f,this.ra,!0,0,!1),bm(this),this.ra=null)};m.Vf=function(){this.u&&this.u.update&&this.u.update()};m.$f=function(){this.o&&this.o.u()};function El(b){jm(b,new K("adaptation"))}function Ll(b){jm(b,new K("trackschanged"))}
function dm(b){jm(b,new K("variantchanged"))}function bm(b){jm(b,new K("textchanged"))}function hm(b){jm(b,new K("texttrackvisibility"))}function Vl(b){jm(b,new K("abrstatuschanged",{Vg:b.b.abr.enabled}))}m.Ra=function(b){if(this.i!=kl){var c=new K("error",{detail:b});this.dispatchEvent(c);c.defaultPrevented&&(b.handled=!0)}};function tl(b,c,d){b.dispatchEvent(new K(c,{detail:{schemeIdUri:d.schemeIdUri,value:d.value,startTime:d.startTime,endTime:d.endTime,id:d.id,eventElement:d.eventElement}}))}
function rl(b){if(!b.a.error)return null;var c=b.a.error.code;if(1==c)return null;var d=b.a.error.msExtendedCode;d&&(0>d&&(d+=Math.pow(2,32)),d=d.toString(16));return new D(2,3,3016,c,d,b.a.error.message)}
function xl(b,c){if(b.f){var d=Ml(b),e=!1,f=Object.keys(c);0==f.length&&B.m("Got a key status event without any key statuses, so we don't know the real key statuses. If we don't have all the keys, you'll need to set restrictions so we don't select those tracks.");var g=1==f.length&&"00"==f[0];g&&B.m("Got a synthetic key status event, so we don't know the real key statuses. If we don't have all the keys, you'll need to set restrictions so we don't select those tracks.");f.length&&b.c.periods.forEach(function(b){b.variants.forEach(function(b){O.Ff(b).forEach(function(d){var f=
b.allowedByKeySystem;d.keyId&&(d=c[g?"00":d.keyId],b.allowedByKeySystem=!!d&&!ml.includes(d));f!=b.allowedByKeySystem&&(e=!0)})})});f=Wi(b.f);var h=Yi(b.f);(f=O.de(f,h,d.variants))&&!f.allowedByKeySystem&&(B.debug("Choosing new variants after key status changed"),gm(b,d));e&&(Ll(b),Nl(b,d.variants))}}function yl(b,c,d){if(b.u&&b.u.onExpirationUpdated)b.u.onExpirationUpdated(c,d);b.dispatchEvent(new K("expirationupdated"))}
function Cl(b,c,d){0<c&&(b.X()?B.m("|playRangeStart| has been configured for live content. Ignoring the setting."):b.Fe(c));d<b.ca()&&(b.X()?B.m("|playRangeEnd| has been configured for live content. Ignoring the setting."):b.Ba(d))}
function im(b,c){var d=b.h?Cc(b.h.$):{},e=Object.keys(d);e=e.length&&"00"==e[0];for(var f=!1,g=!1,h=[],k=[],l=t(c),n=l.next();!n.done;n=l.next()){n=n.value;var p=[];n.audio&&p.push(n.audio);n.video&&p.push(n.video);p=t(p);for(var q=p.next();!q.done;q=p.next())if(q=q.value,q.keyId){var r=d[e?"00":q.keyId];r?ml.includes(r)&&(k.includes(r)||k.push(r)):h.includes(q.keyId)||h.push(q.keyId)}n.allowedByApplication?n.allowedByKeySystem&&(f=!0):g=!0}if(!f)throw new D(2,4,4012,{hasAppRestrictions:g,missingKeys:h,
restrictedKeyStatuses:k});}function jm(b,c){u(function e(){return x(e,function(e){switch(e.j){case 1:return v(e,Promise.resolve(),2);case 2:b.i!=kl&&b.dispatchEvent(c),w(e)}})})}function fm(b){var c=new Set;b=t(b);for(var d=b.next();!d.done;d=b.next())d=d.value,d.language?c.add(N(d.language)):c.add("und");return c}
function em(b){var c=new Map;b=t(b);for(var d=b.next();!d.done;d=b.next()){var e=d.value;d="und";var f=[];e.language&&(d=N(e.language));"variant"==e.type?f=e.audioRoles:f=e.roles;f&&f.length||(f=[""]);c.has(d)||c.set(d,new Set);e=t(f);for(f=e.next();!f.done;f=e.next())f=f.value,c.get(d).add(f)}var g=[];c.forEach(function(b,c){for(var d=t(b),e=d.next();!e.done;e=d.next())g.push({language:c,role:e.value})});return g}
function Xl(b){b=Ml(b);return null==b?[]:b.variants.filter(function(b){return O.Bb(b)})}function Zl(b){var c=Ml(b);return null==c?[]:c.textStreams.filter(function(c){return!b.hc.has(c)})}function Ml(b){var c=b.o.g(),d=null;b=t(b.c.periods);for(var e=b.next();!e.done;e=b.next())e=e.value,e.startTime<=c&&(d=e);return d}function Wl(b){var c=Ml(b);return Sh(b.ea,c).variant}
function Yl(b){var c=Ml(b);if(null==c)return null;if(!Sh(b.ea,c).text){var d=O.Sb(c.textStreams,b.qa,b.nb);d.length&&Rh(b.ea,c,d[0])}return Sh(b.ea,c).text}function ol(){return new D(2,7,7E3)}function jl(b,c,d,e,f,g){return e==b&&f.v==g.v&&f.uri==g.uri&&f.mimeType==g.mimeType&&f.Ea==g.Ea?c:d}function Ek(){return{Ea:null,v:null,mimeType:null,startTime:null,Ld:null,uri:null}}
function pl(b){return new Promise(function(c,d){b.eb=function(){return d(ol())};b.xc=function(){return c()};b.onError=function(b){return d(b)};b.zc=function(){return d(ol())}})}var kl=0,Yk=1,Jl=2,Ol=3;Y.LoadMode={DESTROYED:kl,NOT_LOADED:Yk,MEDIA_SOURCE:Jl,SRC_EQUALS:Ol};function km(b,c,d){var e=void 0==c.expiration?Infinity:c.expiration,f=c.presentationTimeline.ca();c=lm(c.periods[0]);return{offlineUri:null,originalManifestUri:b,duration:f,size:0,expiration:e,tracks:c,appMetadata:d}}function mm(b,c){var d=tk(new rk(b.Aa(),b.fa()),c.periods[0],new X(null,0)),e=c.appMetadata||{};d=lm(d);return{offlineUri:b.toString(),originalManifestUri:c.originalManifestUri,duration:c.duration,size:c.size,expiration:c.expiration,tracks:d,appMetadata:e}}
function lm(b){var c=[],d=O.wf(b.variants);d=t(d);for(var e=d.next();!e.done;e=d.next())c.push(O.Qd(e.value));b=t(b.textStreams);for(d=b.next();!d.done;d=b.next())c.push(O.Fc(d.value));return c};function nm(){this.a={}}function om(b,c){var d=c.audio,e=c.video;d&&!e&&(b.a[d.id]=d.bandwidth||c.bandwidth);!d&&e&&(b.a[e.id]=e.bandwidth||c.bandwidth);if(d&&e){var f=d.bandwidth||393216,g=e.bandwidth||c.bandwidth-f;0>=g&&(B.m("Audio bit rate consumes variants bandwidth. Setting video bandwidth to match variant's bandwidth."),g=c.bandwidth);b.a[d.id]=f;b.a[e.id]=g}}function pm(b,c,d){d=d.endTime-d.startTime;return qm(b,c)*d}
function qm(b,c){var d=b.a[c];null==d&&(d=0,B.error("Asking for bitrate of stream not given to the estimator"));0==d&&B.m("Using bitrate of 0, this stream won't affect progress");return d};function rm(b){this.a=!1;this.b=new E;this.c=b}rm.prototype.destroy=function(){var b=this;if(this.a)return this.b;this.a=!0;return this.c().then(function(){b.b.resolve()},function(){b.b.resolve()})};function sm(b,c,d){b=t(b.periods);for(var e=b.next();!e.done;e=b.next())e=e.value,e.variants=e.variants.filter(function(b){return O.ld(b,c,d)})}function tm(b){b=t(b.periods);for(var c=b.next();!c.done;c=b.next())c=c.value,c.variants=c.variants.filter(function(b){var c=!0;b.audio&&(c=c&&ie(b.audio));b.video&&(c=c&&ie(b.video));return c})}function um(b,c){for(var d=t(b.periods),e=d.next();!e.done;e=d.next())e=e.value,e.variants=e.variants.filter(function(b){return xd(c,b)})}
function vm(b){var c=new wm;b.periods.forEach(function(b,d){var e=xm(b.variants);if(0==d){e=t(e.a);for(var f=e.next();!f.done;f=e.next())c.add(f.value)}else ym(c,e)});b=t(b.periods);for(var d=b.next();!d.done;d=b.next())d=d.value,d.variants=d.variants.filter(function(b){return zm(c,new Am(b))})}
function Bm(b,c){return u(function e(){var f,g,h,k;return x(e,function(e){switch(e.j){case 1:f=null,g=t(b.periods),h=g.next();case 2:if(h.done){e.C(0);break}k=h.value;f&&(k.variants=k.variants.filter(function(b){return zm(f,new Am(b))}));return v(e,c(k),5);case 5:f=xm(k.variants),h=g.next(),e.C(2)}})})}function Am(b){var c=b.audio;b=b.video;this.b=c?c.mimeType:null;this.a=c?c.codecs.split(".")[0]:null;this.f=b?b.mimeType:null;this.c=b?b.codecs.split(".")[0]:null}function wm(){this.a=[]}
wm.prototype.add=function(b){zm(this,b)||this.a.push(b)};function ym(b,c){b.a=b.a.filter(function(b){return zm(c,b)})}function zm(b,c){return b.a.some(function(b){return c.b==b.b&&c.a==b.a&&c.f==b.f&&c.c==b.c})}function xm(b){var c=new wm;b=t(b);for(var d=b.next();!d.done;d=b.next())c.add(new Am(d.value));return c};function Z(b){var c=this;if(b&&b.constructor!=Y)throw new D(2,9,9008);this.b=this.a=null;b?(this.a=b.b,this.b=b.Ub()):(this.a=Pk(),this.b=new L);this.f=!1;this.c=[];this.g=[];var d=!b;this.h=new rm(function(){return u(function f(){var b;return x(f,function(f){switch(f.j){case 1:return b=function(){},v(f,Promise.all(c.g.map(function(c){return c.then(b,b)})),2);case 2:if(!d){f.C(3);break}return v(f,c.b.destroy(),3);case 3:c.a=null,c.b=null,w(f)}})})})}A("shaka.offline.Storage",Z);
function Cm(){if(Hc())a:{var b=t(Zj.values());for(var c=b.next();!c.done;c=b.next())if(c=c.value,c=c()){c.destroy();b=!0;break a}b=!1}else b=!1;return b}Z.support=Cm;Z.prototype.destroy=function(){return this.h.destroy()};Z.prototype.destroy=Z.prototype.destroy;
Z.prototype.configure=function(b,c){2==arguments.length&&"string"==typeof b&&(b=Nk(b,c));var d=b,e=!1;null!=d.trackSelectionCallback&&(e=!0,d.offline=d.offline||{},d.offline.trackSelectionCallback=d.trackSelectionCallback,delete d.trackSelectionCallback);null!=d.progressCallback&&(e=!0,d.offline=d.offline||{},d.offline.progressCallback=d.progressCallback,delete d.progressCallback);null!=d.usePersistentLicense&&(e=!0,d.offline=d.offline||{},d.offline.usePersistentLicense=d.usePersistentLicense,delete d.usePersistentLicense);
e&&De("Storage.configure with OfflineConfig","Please configure storage with a player configuration.");return Rk(this.a,b)};Z.prototype.configure=Z.prototype.configure;Z.prototype.getConfiguration=function(){var b=Pk();Rk(b,this.a,Pk());return b};Z.prototype.getConfiguration=Z.prototype.getConfiguration;Z.prototype.Ub=function(){return this.b};Z.prototype.getNetworkingEngine=Z.prototype.Ub;
Z.prototype.store=function(b,c,d){var e=this;return Dm(this,Em(this,b,c||{},function(){return u(function g(){var c,k;return x(g,function(g){switch(g.j){case 1:return d&&"string"!=typeof d?(De("Storing with a manifest parser factory","Please register a manifest parser and for the mime-type."),c=d,g["return"](new c)):v(g,W.create(b,e.b,e.a.manifest.retryParameters,d),2);case 2:return k=g.s,g["return"](k)}})})}))};Z.prototype.store=Z.prototype.store;Z.prototype.Cf=function(){return this.f};
Z.prototype.getStoreInProgress=Z.prototype.Cf;
function Em(b,c,d,e){return u(function g(){var h,k,l,n,p,q,r,y,C,z;return x(g,function(g){switch(g.j){case 1:Fm();if(b.f)return g["return"](Promise.reject(new D(2,9,9006)));b.f=!0;return v(g,Gm(b,c,e),2);case 2:h=g.s;Hm(b);k=!h.presentationTimeline.X()&&!h.presentationTimeline.bb();if(!k)throw new D(2,9,9005,c);l=null;n=new Yj;q=p=null;Ba(g,3,4);return v(g,Im(b,h,function(b){q=q||b}),6);case 6:l=g.s;Hm(b);if(q)throw q;return v(g,Jm(b,h,l),7);case 7:return v(g,n.init(),8);case 8:return Hm(b),v(g,ak(n),
9);case 9:return p=g.s,Hm(b),v(g,Km(b,p.fa,l,h,c,d),10);case 10:r=g.s;Hm(b);if(q)throw q;return v(g,p.fa.addManifests([r]),11);case 11:return y=g.s,Hm(b),C=new pk("manifest",p.path.Aa,p.path.fa,y[0]),g["return"](mm(C,r));case 4:return Ha(g),b.f=!1,b.c=[],v(g,n.destroy(),12);case 12:if(!l){g.C(13);break}return v(g,l.destroy(),13);case 13:La(g,0);break;case 3:z=Ga(g);if(!p){g.C(15);break}return v(g,p.fa.removeSegments(b.c,function(){}),15);case 15:throw q||z;}})})}
function Jm(b,c,d){return u(function f(){var g,h;return x(f,function(f){switch(f.j){case 1:return g={width:Infinity,height:Infinity},sm(c,b.a.restrictions,g),tm(c),um(c,d),vm(c),h=b.a.preferredAudioChannelCount,O.Vd(c,h),v(f,Bm(c,function(c){return u(function p(){var d,f,g,h,k,l,H,R;return x(p,function(p){switch(p.j){case 1:d=O;f=[];for(var q=t(c.variants),r=q.next();!r.done;r=q.next())g=r.value,f.push(d.Qd(g));q=t(c.textStreams);for(r=q.next();!r.done;r=q.next())h=r.value,f.push(d.Fc(h));return v(p,
b.a.offline.trackSelectionCallback(f),2);case 2:k=p.s;l=new Set;H=new Set;q=t(k);for(r=q.next();!r.done;r=q.next())R=r.value,"variant"==R.type&&l.add(R.id),"text"==R.type&&H.add(R.id);c.variants=c.variants.filter(function(b){return l.has(b.id)});c.textStreams=c.textStreams.filter(function(b){return H.has(b.id)});w(p)}})})}),2);case 2:Lm(c),w(f)}})})}
function Km(b,c,d,e,f,g){return u(function k(){var l,n,p,q,r,y,C,z,F,H;return x(k,function(k){switch(k.j){case 1:return l=km(f,e,g),n=e.periods.some(function(b){return b.variants.some(function(b){return b.drmInfos&&b.drmInfos.length})}),p=e.periods.some(function(b){return b.variants.some(function(b){return b.drmInfos.some(function(b){return b.initData&&b.initData.length})})}),q=n&&!p,r=null,q&&(y=d.a,r=Mm.get(y.keySystem)),C=new Kj(b.b,function(c,d){l.size=d;b.a.offline.progressCallback(l,c)},function(c,
e){q&&b.a.offline.usePersistentLicense&&r==e&&gd(d,"cenc",c)}),Ca(k,2),F=z=Nm(b,C,c,d,e,f,g),v(k,Nj(C),4);case 4:F.size=k.s;z.expiration=d.Tb();H=md(d);z.sessionIds=b.a.offline.usePersistentLicense?H:[];if(n&&b.a.offline.usePersistentLicense&&!H.length)throw new D(2,9,9007);return k["return"](z);case 2:return Ha(k),v(k,C.destroy(),5);case 5:La(k,0)}})})}Z.prototype.remove=function(b){return Dm(this,Om(this,b))};Z.prototype.remove=Z.prototype.remove;
function Om(b,c){return u(function e(){var f,g,h,k,l,n;return x(e,function(e){switch(e.j){case 1:Fm();f=qk(c);if(null==f||"manifest"!=f.a)return e["return"](Promise.reject(new D(2,9,9004,c)));g=f;h=new Yj;Ca(e,2);return v(e,h.init(),4);case 4:return v(e,ck(h,g.Aa(),g.fa()),5);case 5:return k=e.s,v(e,k.getManifests([g.key()]),6);case 6:return l=e.s,n=l[0],v(e,Promise.all([Pm(b,n,h),Qm(b,k,g,n)]),2);case 2:return Ha(e),v(e,h.destroy(),8);case 8:La(e,0)}})})}
function Rm(b,c){for(var d=[],e=t(b.periods),f=e.next();!f.done;f=e.next()){f=t(f.value.streams);for(var g=f.next();!g.done;g=f.next())g=g.value,c&&"video"==g.contentType?d.push({contentType:Dc(g.mimeType,g.codecs),robustness:b.drmInfo.videoRobustness}):c||"audio"!=g.contentType||d.push({contentType:Dc(g.mimeType,g.codecs),robustness:b.drmInfo.audioRobustness})}return d}function Pm(b,c,d){return u(function f(){return x(f,function(f){switch(f.j){case 1:return v(f,Sm(b.b,b.a.drm,d,c),0)}})})}
function Qm(b,c,d,e){function f(){k+=1;b.a.offline.progressCallback(l,k/h)}var g=Tm(e),h=g.length+1,k=0,l=mm(d,e);return Promise.all([c.removeSegments(g,f),c.removeManifests([d.key()],f)])}Z.prototype.ng=function(){return Dm(this,Um(this))};Z.prototype.removeEmeSessions=Z.prototype.ng;
function Um(b){return u(function d(){var e,f,g,h,k,l,n,p,q;return x(d,function(d){switch(d.j){case 1:return Fm(),e=b.b,f=b.a.drm,g=new Yj,h=!1,Ca(d,2),v(d,g.init(),4);case 4:k=[];dk(g,function(b){return k.push(b)});l=Promise.resolve();n={};p=t(k);for(q=p.next();!q.done;n={Ec:n.Ec},q=p.next())n.Ec=q.value,l=l.then(function(b){return function(){return u(function z(){var d,g;return x(z,function(k){switch(k.j){case 1:return v(k,b.Ec.getAll(),2);case 2:return d=k.s,v(k,Ak(f,e,d),3);case 3:return g=k.s,
v(k,b.Ec.remove(g),4);case 4:g.length!=d.length&&(h=!0),w(k)}})})}}(n));return v(d,l,2);case 2:return Ha(d),v(d,g.destroy(),6);case 6:La(d,3);break;case 3:return d["return"](!h)}})})}Z.prototype.list=function(){return Dm(this,Vm())};Z.prototype.list=Z.prototype.list;
function Vm(){return u(function c(){var d,e,f;return x(c,function(c){switch(c.j){case 1:return Fm(),d=[],e=new Yj,Ca(c,2),v(c,e.init(),4);case 4:return f=Promise.resolve(),bk(e,function(c,e){f=f.then(function(){return u(function n(){var f;return x(n,function(g){switch(g.j){case 1:return v(g,e.getAllManifests(),2);case 2:f=g.s,f.forEach(function(e,f){var g=mm(new pk("manifest",c.Aa,c.fa,f),e);d.push(g)}),w(g)}})})})}),v(c,f,2);case 2:return Ha(c),v(c,e.destroy(),6);case 6:La(c,3);break;case 3:return c["return"](d)}})})}
function Gm(b,c,d){return u(function f(){var g,h,k,l,n,p;return x(f,function(f){switch(f.j){case 1:return g=null,h=b.b,k={networkingEngine:h,filterAllPeriods:function(){},filterNewPeriod:function(){},onTimelineRegionAdded:function(){},onEvent:function(){},onError:function(b){g=b}},v(f,d(),2);case 2:return l=f.s,l.configure(b.a.manifest),Hm(b),Ca(f,3),v(f,l.start(c,k),5);case 5:return n=f.s,Hm(b),p=Wm(n),v(f,Promise.all(zc(p,function(b){return b.createSegmentIndex()})),6);case 6:Hm(b);if(g)throw g;
return f["return"](n);case 3:return Ha(f),v(f,l.stop(),7);case 7:La(f,0)}})})}function Im(b,c,d){return u(function f(){var g,h,k;return x(f,function(f){switch(f.j){case 1:return g=new Qc({Db:b.b,onError:d,yc:function(){},onExpirationUpdated:function(){},onEvent:function(){}}),h=oi(c.periods),k=b.a,g.configure(k.drm),v(f,Vc(g,h,k.offline.usePersistentLicense),2);case 2:return v(f,ed(g),3);case 3:return v(f,fd(g),4);case 4:return f["return"](g)}})})}
function Nm(b,c,d,e,f,g,h){var k=new nm,l=f.periods.map(function(e){return Xm(b,c,d,k,f,e)}),n=e.a,p=b.a.offline.usePersistentLicense;n&&p&&(n.initData=[]);return{originalManifestUri:g,duration:f.presentationTimeline.ca(),size:0,expiration:e.Tb(),periods:l,sessionIds:p?md(e):[],drmInfo:n,appMetadata:h}}
function Xm(b,c,d,e,f,g){for(var h=t(g.variants),k=h.next();!k.done;k=h.next())om(e,k.value);h=t(g.textStreams);for(k=h.next();!k.done;k=h.next())e.a[k.value.id]=52;h=Ym(g);var l=new Map;h=t(h);for(k=h.next();!k.done;k=h.next()){k=k.value;var n=Zm(b,c,d,e,f,k);l.set(k.id,n)}g.variants.forEach(function(b){b.audio&&l.get(b.audio.id).variantIds.push(b.id);b.video&&l.get(b.video.id).variantIds.push(b.id)});return{startTime:g.startTime,streams:Array.from(l.values())}}
function Zm(b,c,d,e,f,g){var h={id:g.id,originalId:g.originalId,primary:g.primary,presentationTimeOffset:g.presentationTimeOffset||0,contentType:g.type,mimeType:g.mimeType,codecs:g.codecs,frameRate:g.frameRate,pixelAspectRatio:g.pixelAspectRatio,kind:g.kind,language:g.language,label:g.label,width:g.width||null,height:g.height||null,initSegmentKey:null,encrypted:g.encrypted,keyId:g.keyId,segments:[],variantIds:[]};f=f.presentationTimeline.Wb();var k=g.id,l=g.initSegmentReference;l&&(l=yg(l.c(),l.b,
l.a,b.a.streaming.retryParameters),Lj(c,k,l,.5*qm(e,g.id),!0,function(c){return u(function q(){var e;return x(q,function(f){switch(f.j){case 1:return v(f,d.addSegments([{data:c}]),2);case 2:e=f.s,b.c.push(e[0]),h.initSegmentKey=e[0],w(f)}})})}));$m(g,f,function(f){var l=yg(f.c(),f.b,f.a,b.a.streaming.retryParameters);Lj(c,k,l,pm(e,g.id,f),!1,function(c){return u(function y(){var e;return x(y,function(g){switch(g.j){case 1:return v(g,d.addSegments([{data:c}]),2);case 2:e=g.s,b.c.push(e[0]),h.segments.push({startTime:f.startTime,
endTime:f.endTime,dataKey:e[0]}),w(g)}})})})});return h}function $m(b,c,d){c=b.findSegmentPosition(c);for(var e=null==c?null:b.getSegmentReference(c);e;)d(e),e=b.getSegmentReference(++c)}function Hm(b){if(b.h.a)throw new D(2,9,7001);}function Fm(){if(!Cm())throw new D(2,9,9E3);}function Dm(b,c){return u(function e(){return x(e,function(e){switch(e.j){case 1:return b.g.push(c),Ca(e,2),v(e,c,4);case 4:return e["return"](e.s);case 2:Ha(e),fc(b.g,c),La(e,0)}})})}
function Tm(b){var c=[];b.periods.forEach(function(b){b.streams.forEach(function(b){null!=b.initSegmentKey&&c.push(b.initSegmentKey);b.segments.forEach(function(b){c.push(b.dataKey)})})});return c}Z.deleteAll=function(){return u(function c(){var d;return x(c,function(c){switch(c.j){case 1:return d=new Yj,Ca(c,2),v(c,d.erase(),2);case 2:return Ha(c),v(c,d.destroy(),5);case 5:La(c,0)}})})};
function Sm(b,c,d,e){return u(function g(){var h,k,l;return x(g,function(g){switch(g.j){case 1:if(!e.drmInfo)return g["return"]();h=ek(d);k=e.sessionIds.map(function(b){return{sessionId:b,keySystem:e.drmInfo.keySystem,licenseUri:e.drmInfo.licenseServerUri,serverCertificate:e.drmInfo.serverCertificate,audioCapabilities:Rm(e,!1),videoCapabilities:Rm(e,!0)}});return v(g,Ak(c,b,k),2);case 2:return l=g.s,v(g,h.remove(l),3);case 3:return v(g,h.add(k.filter(function(b){return-1==l.indexOf(b.sessionId)})),
0)}})})}function Wm(b){var c=new Set;b=t(b.periods);for(var d=b.next();!d.done;d=b.next()){d=d.value;for(var e=t(d.textStreams),f=e.next();!f.done;f=e.next())c.add(f.value);d=t(d.variants);for(e=d.next();!e.done;e=d.next())e=e.value,e.audio&&c.add(e.audio),e.video&&c.add(e.video)}return c}
function Ym(b){for(var c=new Set,d=t(b.textStreams),e=d.next();!e.done;e=d.next())c.add(e.value);b=t(b.variants);for(d=b.next();!d.done;d=b.next())d=d.value,d.audio&&c.add(d.audio),d.video&&c.add(d.video);return c}function Lm(b){if(0==b.periods.length)throw new D(2,4,4014);b=t(b.periods);for(var c=b.next();!c.done;c=b.next())an(c.value)}
function an(b){var c=new Set(b.variants.map(function(b){return b.video})),d=new Set(b.variants.map(function(b){return b.audio}));b=b.textStreams;1<c.size&&B.m("Multiple video tracks selected to be stored");c=t(d);for(var e=c.next();!e.done;e=c.next()){e=e.value;for(var f=t(d),g=f.next();!g.done;g=f.next())g=g.value,e!=g&&e.language==g.language&&B.m("Similar audio tracks were selected to be stored",e.id,g.id)}d=t(b);for(c=d.next();!c.done;c=d.next())for(c=c.value,e=t(b),f=e.next();!f.done;f=e.next())f=
f.value,c!=f&&c.language==f.language&&B.m("Similar text tracks were selected to be stored",c.id,f.id)}var Mm=(new Map).set("org.w3.clearkey","1077efecc0b24d02ace33c1e52e2fb4b").set("com.widevine.alpha","edef8ba979d64acea3c827dcd51d21ed").set("com.microsoft.playready","9a04f07998404286ab92e65be0885f95").set("com.adobe.primetime","f239e769efa348509c16a903c6932efb");nl.offline=Cm;A("shaka.polyfill.installAll",function(){for(var b=0;b<bn.length;++b)try{bn[b].Se()}catch(c){B.Y("Error installing polyfill!",c)}});var bn=[];function cn(b,c){c=c||0;for(var d={priority:c,Se:b},e=0;e<bn.length;e++)if(bn[e].priority<c){bn.splice(e,0,d);return}bn.push(d)}A("shaka.polyfill.register",cn);cn(function(){dn()},-1);function en(b){var c=b.type.replace(/^(webkit|moz|MS)/,"").toLowerCase();if("function"===typeof Event)var d=new Event(c,b);else d=document.createEvent("Event"),d.initEvent(c,b.bubbles,b.cancelable);b.target.dispatchEvent(d)}
cn(function(){if(window.Document){var b=Element.prototype;b.requestFullscreen=b.requestFullscreen||b.mozRequestFullScreen||b.msRequestFullscreen||b.webkitRequestFullscreen;b=Document.prototype;b.exitFullscreen=b.exitFullscreen||b.mozCancelFullScreen||b.msExitFullscreen||b.webkitCancelFullScreen;"fullscreenElement"in document||(Object.defineProperty(document,"fullscreenElement",{get:function(){return document.mozFullScreenElement||document.msFullscreenElement||document.webkitCurrentFullScreenElement||
document.webkitFullscreenElement}}),Object.defineProperty(document,"fullscreenEnabled",{get:function(){return document.mozFullScreenEnabled||document.msFullscreenEnabled||document.webkitFullscreenEnabled}}));document.addEventListener("webkitfullscreenchange",en);document.addEventListener("webkitfullscreenerror",en);document.addEventListener("mozfullscreenchange",en);document.addEventListener("mozfullscreenerror",en);document.addEventListener("MSFullscreenChange",en);document.addEventListener("MSFullscreenError",
en)}});function fn(b,c,d){if("input"==b)switch(this.type){case "range":b="change"}HTMLInputElement.prototype.originalAddEventListener.call(this,b,c,d)}cn(function(){B.debug("InputEvent.install");Lc("Trident/")&&!HTMLInputElement.prototype.originalAddEventListener&&(B.info("Patching input event support on IE."),HTMLInputElement.prototype.originalAddEventListener=HTMLInputElement.prototype.addEventListener,HTMLInputElement.prototype.addEventListener=fn)});cn(function(){navigator.languages||Object.defineProperty(navigator,"languages",{get:function(){return navigator.language?[navigator.language]:["en"]}})});cn(function(){B.debug("mathRound.install")});function gn(){var b=MediaSource.prototype.addSourceBuffer;MediaSource.prototype.addSourceBuffer=function(c){for(var d=[],e=0;e<arguments.length;++e)d[e]=arguments[e];d=b.apply(this,d);d.abort=function(){};return d}}function hn(){var b=SourceBuffer.prototype.remove;SourceBuffer.prototype.remove=function(c,d){return b.call(this,c,d-.001)}}function jn(){var b=MediaSource.isTypeSupported;MediaSource.isTypeSupported=function(c){return"mp2t"==c.split(/ *; */)[0].split("/")[1].toLowerCase()?!1:b(c)}}
function kn(){var b=MediaSource.isTypeSupported;MediaSource.isTypeSupported=function(c){return"opus"!=Gc(c)[0]&&b(c)}}function ln(){var b=MediaSource.isTypeSupported;MediaSource.isTypeSupported=function(c){var d=c.split(/ *; */);d.shift();return d.some(function(b){return b.startsWith("codecs=")})?cast.__platform__.canDisplayType(c):b(c)}}
cn(function(){B.debug("MediaSource.install");var b=Nc();window.MediaSource?window.cast&&cast.__platform__&&cast.__platform__.canDisplayType?(B.info("Patching Chromecast MSE bugs."),ln()):b?(jn(),12>=b?(B.info("Patching Safari 11 & 12 MSE bugs."),gn(),hn()):(B.info("Patching Safari 13 MSE bugs."),gn())):Lc("Tizen 2")||Lc("Tizen 3")||Lc("Tizen 4")?kn():B.info("Using native MSE as-is."):B.info("No MSE implementation available.")});function mn(b,c){B.debug("PatchedMediaKeysApple.requestMediaKeySystemAccess");try{var d=new nn(b,c);return Promise.resolve(d)}catch(e){return Promise.reject(e)}}
function nn(b,c){B.debug("PatchedMediaKeysApple.MediaKeySystemAccess");this.keySystem=b;if(b.startsWith("com.apple.fps"))for(var d=t(c),e=d.next();!e.done;e=d.next()){var f=e.value;if("required"==f.persistentState)e=null;else{e={audioCapabilities:[],videoCapabilities:[],persistentState:"optional",distinctiveIdentifier:"optional",initDataTypes:f.initDataTypes,sessionTypes:["temporary"],label:f.label};var g=!1,h=!1;if(f.audioCapabilities)for(var k=t(f.audioCapabilities),l=k.next();!l.done;l=k.next())if(l=
l.value,l.contentType){g=!0;var n=l.contentType.split(";")[0];WebKitMediaKeys.isTypeSupported(this.keySystem,n)&&(e.audioCapabilities.push(l),h=!0)}if(f.videoCapabilities)for(f=t(f.videoCapabilities),l=f.next();!l.done;l=f.next())k=l.value,k.contentType&&(g=!0,l=k.contentType.split(";")[0],WebKitMediaKeys.isTypeSupported(this.keySystem,l)&&(e.videoCapabilities.push(k),h=!0));g||(h=WebKitMediaKeys.isTypeSupported(this.keySystem,"video/mp4"));e=h?e:null}if(e){this.a=e;return}}d=Error("Unsupported keySystem");
d.name="NotSupportedError";d.code=DOMException.NOT_SUPPORTED_ERR;throw d;}nn.prototype.createMediaKeys=function(){B.debug("PatchedMediaKeysApple.MediaKeySystemAccess.createMediaKeys");var b=new on(this.keySystem);return Promise.resolve(b)};nn.prototype.getConfiguration=function(){B.debug("PatchedMediaKeysApple.MediaKeySystemAccess.getConfiguration");return this.a};
function pn(b){B.debug("PatchedMediaKeysApple.setMediaKeys");var c=this.mediaKeys;c&&c!=b&&qn(c,null);delete this.mediaKeys;return(this.mediaKeys=b)?qn(b,this):Promise.resolve()}function on(b){B.debug("PatchedMediaKeysApple.MediaKeys");this.b=new WebKitMediaKeys(b);this.a=new M}
on.prototype.createSession=function(b){B.debug("PatchedMediaKeysApple.MediaKeys.createSession");b=b||"temporary";if("temporary"!=b)throw new TypeError("Session type "+b+" is unsupported on this platform.");return new rn(this.b,b)};on.prototype.setServerCertificate=function(b){B.debug("PatchedMediaKeysApple.MediaKeys.setServerCertificate");b&&new Uint8Array(b);return Promise.resolve(!0)};
function qn(b,c){b.a.hb();if(!c)return Promise.resolve();b.a.B(c,"webkitneedkey",sn);try{return ui(c,HTMLMediaElement.HAVE_METADATA,b.a,function(){c.webkitSetMediaKeys(b.b)}),Promise.resolve()}catch(d){return Promise.reject(d)}}function rn(b){B.debug("PatchedMediaKeysApple.MediaKeySession");bc.call(this);this.b=null;this.g=b;this.c=this.a=null;this.f=new M;this.sessionId="";this.expiration=NaN;this.closed=new E;this.keyStatuses=new tn}bb(rn,bc);m=rn.prototype;
m.generateRequest=function(b,c){B.debug("PatchedMediaKeysApple.MediaKeySession.generateRequest");this.a=new E;try{this.b=this.g.createSession("video/mp4",new Uint8Array(c)),this.sessionId=this.b.sessionId||"",this.f.B(this.b,"webkitkeymessage",this.Cg.bind(this)),this.f.B(this.b,"webkitkeyadded",this.Ag.bind(this)),this.f.B(this.b,"webkitkeyerror",this.Bg.bind(this)),un(this,"status-pending")}catch(d){this.a.reject(d)}return this.a};
m.load=function(){B.debug("PatchedMediaKeysApple.MediaKeySession.load");return Promise.reject(Error("MediaKeySession.load not yet supported"))};m.update=function(b){B.debug("PatchedMediaKeysApple.MediaKeySession.update");this.c=new E;try{this.b.update(new Uint8Array(b))}catch(c){this.c.reject(c)}return this.c};m.close=function(){B.debug("PatchedMediaKeysApple.MediaKeySession.close");try{this.b.close(),this.closed.resolve(),this.f.hb()}catch(b){this.closed.reject(b)}return this.closed};
m.remove=function(){B.debug("PatchedMediaKeysApple.MediaKeySession.remove");return Promise.reject(Error("MediaKeySession.remove is only applicable for persistent licenses, which are not supported on this platform"))};
function sn(b){B.debug("PatchedMediaKeysApple.onWebkitNeedKey_",b);b=new Uint8Array(b.initData);if((new DataView(b.buffer,b.byteOffset,b.byteLength)).getUint32(0,!0)+4!=b.byteLength)throw new RangeError("Malformed FairPlay init data");b=Ib(b.subarray(4),!0);b=Kb(b);var c=new Event("encrypted");c.initDataType="skd";c.initData=b;this.dispatchEvent(c)}
m.Cg=function(b){B.debug("PatchedMediaKeysApple.onWebkitKeyMessage_",b);this.a&&(this.a.resolve(),this.a=null);this.dispatchEvent(new K("message",{messageType:void 0==this.keyStatuses.a?"license-request":"license-renewal",message:b.message.buffer}))};m.Ag=function(b){B.debug("PatchedMediaKeysApple.onWebkitKeyAdded_",b);this.c&&(un(this,"usable"),this.c.resolve(),this.c=null)};
m.Bg=function(b){B.debug("PatchedMediaKeysApple.onWebkitKeyError_",b);b=Error("EME PatchedMediaKeysApple key error");b.errorCode=this.b.error;if(null!=this.a)this.a.reject(b),this.a=null;else if(null!=this.c)this.c.reject(b),this.c=null;else switch(this.b.error.code){case WebKitMediaKeyError.MEDIA_KEYERR_OUTPUT:case WebKitMediaKeyError.MEDIA_KEYERR_HARDWARECHANGE:un(this,"output-not-allowed");break;default:un(this,"internal-error")}};
function un(b,c){var d=b.keyStatuses;d.size=void 0==c?0:1;d.a=c;b.dispatchEvent(new K("keystatuseschange"))}function tn(){this.size=0;this.a=void 0}var vn;m=tn.prototype;m.forEach=function(b){this.a&&b(this.a,vn)};m.get=function(b){if(this.has(b))return this.a};m.has=function(b){var c=vn;return this.a&&G.Da(new Uint8Array(b),new Uint8Array(c))?!0:!1};m.entries=function(){};m.keys=function(){};m.values=function(){};
cn(function(){window.HTMLVideoElement&&window.WebKitMediaKeys&&(B.info("Using Apple-prefixed EME"),vn=(new Uint8Array([0])).buffer,delete HTMLMediaElement.prototype.mediaKeys,HTMLMediaElement.prototype.mediaKeys=null,HTMLMediaElement.prototype.setMediaKeys=pn,window.MediaKeys=on,window.MediaKeySystemAccess=nn,navigator.requestMediaKeySystemAccess=mn)});function wn(b,c){B.debug("PatchedMediaKeysMs.requestMediaKeySystemAccess");try{var d=new xn(b,c);return Promise.resolve(d)}catch(e){return Promise.reject(e)}}
function xn(b,c){B.debug("PatchedMediaKeysMs.MediaKeySystemAccess");this.keySystem=b;for(var d=!1,e=0;e<c.length;++e){var f=c[e],g={audioCapabilities:[],videoCapabilities:[],persistentState:"optional",distinctiveIdentifier:"optional",initDataTypes:f.initDataTypes,sessionTypes:["temporary"],label:f.label},h=!1;if(f.audioCapabilities)for(var k=0;k<f.audioCapabilities.length;++k){var l=f.audioCapabilities[k];if(l.contentType){h=!0;var n=l.contentType.split(";")[0];MSMediaKeys.isTypeSupported(this.keySystem,
n)&&(g.audioCapabilities.push(l),d=!0)}}if(f.videoCapabilities)for(k=0;k<f.videoCapabilities.length;++k)l=f.videoCapabilities[k],l.contentType&&(h=!0,n=l.contentType.split(";")[0],MSMediaKeys.isTypeSupported(this.keySystem,n)&&(g.videoCapabilities.push(l),d=!0));h||(d=MSMediaKeys.isTypeSupported(this.keySystem,"video/mp4"));"required"==f.persistentState&&(d=!1);if(d){this.a=g;return}}d=Error("Unsupported keySystem");d.name="NotSupportedError";d.code=DOMException.NOT_SUPPORTED_ERR;throw d;}
xn.prototype.createMediaKeys=function(){B.debug("PatchedMediaKeysMs.MediaKeySystemAccess.createMediaKeys");var b=new yn(this.keySystem);return Promise.resolve(b)};xn.prototype.getConfiguration=function(){B.debug("PatchedMediaKeysMs.MediaKeySystemAccess.getConfiguration");return this.a};function zn(b){B.debug("PatchedMediaKeysMs.setMediaKeys");var c=this.mediaKeys;c&&c!=b&&An(c,null);delete this.mediaKeys;return(this.mediaKeys=b)?An(b,this):Promise.resolve()}
function yn(b){B.debug("PatchedMediaKeysMs.MediaKeys");this.b=new MSMediaKeys(b);this.a=new M}yn.prototype.createSession=function(b){B.debug("PatchedMediaKeysMs.MediaKeys.createSession");b=b||"temporary";if("temporary"!=b)throw new TypeError("Session type "+b+" is unsupported on this platform.");return new Bn(this.b,b)};yn.prototype.setServerCertificate=function(){B.debug("PatchedMediaKeysMs.MediaKeys.setServerCertificate");return Promise.resolve(!1)};
function An(b,c){b.a.hb();if(!c)return Promise.resolve();b.a.B(c,"msneedkey",Cn);try{return ui(c,HTMLMediaElement.HAVE_METADATA,b.a,function(){c.msSetMediaKeys(b.b)}),Promise.resolve()}catch(d){return Promise.reject(d)}}function Bn(b){B.debug("PatchedMediaKeysMs.MediaKeySession");bc.call(this);this.c=null;this.g=b;this.b=this.a=null;this.f=new M;this.sessionId="";this.expiration=NaN;this.closed=new E;this.keyStatuses=new Dn}bb(Bn,bc);m=Bn.prototype;
m.generateRequest=function(b,c){B.debug("PatchedMediaKeysMs.MediaKeySession.generateRequest");this.a=new E;try{this.c=this.g.createSession("video/mp4",new Uint8Array(c),null),this.f.B(this.c,"mskeymessage",this.Zf.bind(this)),this.f.B(this.c,"mskeyadded",this.Xf.bind(this)),this.f.B(this.c,"mskeyerror",this.Yf.bind(this)),En(this,"status-pending")}catch(d){this.a.reject(d)}return this.a};m.load=function(){B.debug("PatchedMediaKeysMs.MediaKeySession.load");return Promise.reject(Error("MediaKeySession.load not yet supported"))};
m.update=function(b){B.debug("PatchedMediaKeysMs.MediaKeySession.update");this.b=new E;try{this.c.update(new Uint8Array(b))}catch(c){this.b.reject(c)}return this.b};m.close=function(){B.debug("PatchedMediaKeysMs.MediaKeySession.close");try{this.c.close(),this.closed.resolve(),this.f.hb()}catch(b){this.closed.reject(b)}return this.closed};m.remove=function(){B.debug("PatchedMediaKeysMs.MediaKeySession.remove");return Promise.reject(Error("MediaKeySession.remove is only applicable for persistent licenses, which are not supported on this platform"))};
function Cn(b){B.debug("PatchedMediaKeysMs.onMsNeedKey_",b);if(b.initData){var c=document.createEvent("CustomEvent");c.initCustomEvent("encrypted",!1,!1,null);c.initDataType="cenc";c.initData=If(b.initData).buffer;this.dispatchEvent(c)}}m.Zf=function(b){B.debug("PatchedMediaKeysMs.onMsKeyMessage_",b);this.a&&(this.a.resolve(),this.a=null);this.dispatchEvent(new K("message",{messageType:void 0==this.keyStatuses.a?"license-request":"license-renewal",message:b.message.buffer}))};
m.Xf=function(b){B.debug("PatchedMediaKeysMs.onMsKeyAdded_",b);this.a?(B.debug("Simulating completion for a PR persistent license."),En(this,"usable"),this.a.resolve(),this.a=null):this.b&&(En(this,"usable"),this.b.resolve(),this.b=null)};
m.Yf=function(b){B.debug("PatchedMediaKeysMs.onMsKeyError_",b);b=Error("EME PatchedMediaKeysMs key error");b.errorCode=this.c.error;if(null!=this.a)this.a.reject(b),this.a=null;else if(null!=this.b)this.b.reject(b),this.b=null;else switch(this.c.error.code){case MSMediaKeyError.MS_MEDIA_KEYERR_OUTPUT:case MSMediaKeyError.MS_MEDIA_KEYERR_HARDWARECHANGE:En(this,"output-not-allowed");break;default:En(this,"internal-error")}};
function En(b,c){var d=b.keyStatuses;d.size=void 0==c?0:1;d.a=c;b.dispatchEvent(new K("keystatuseschange"))}function Dn(){this.size=0;this.a=void 0}var Fn;m=Dn.prototype;m.forEach=function(b){this.a&&b(this.a,Fn)};m.get=function(b){if(this.has(b))return this.a};m.has=function(b){var c=Fn;return this.a&&G.Da(new Uint8Array(b),new Uint8Array(c))?!0:!1};m.entries=function(){};m.keys=function(){};m.values=function(){};
cn(function(){!window.HTMLVideoElement||!window.MSMediaKeys||navigator.requestMediaKeySystemAccess&&MediaKeySystemAccess.prototype.getConfiguration||(B.info("Using ms-prefixed EME v20140218"),Fn=(new Uint8Array([0])).buffer,delete HTMLMediaElement.prototype.mediaKeys,HTMLMediaElement.prototype.mediaKeys=null,HTMLMediaElement.prototype.setMediaKeys=zn,window.MediaKeys=yn,window.MediaKeySystemAccess=xn,navigator.requestMediaKeySystemAccess=wn)});function Gn(){B.debug("PatchedMediaKeysNop.requestMediaKeySystemAccess");return Promise.reject(Error("The key system specified is not supported."))}function Hn(b){B.debug("PatchedMediaKeysNop.setMediaKeys");return null==b?Promise.resolve():Promise.reject(Error("MediaKeys not supported."))}function In(){throw new TypeError("Illegal constructor.");}In.prototype.createSession=function(){};In.prototype.setServerCertificate=function(){};function Jn(){throw new TypeError("Illegal constructor.");}
Jn.prototype.getConfiguration=function(){};Jn.prototype.createMediaKeys=function(){};cn(function(){!window.HTMLVideoElement||navigator.requestMediaKeySystemAccess&&MediaKeySystemAccess.prototype.getConfiguration||(B.info("EME not available."),navigator.requestMediaKeySystemAccess=Gn,delete HTMLMediaElement.prototype.mediaKeys,HTMLMediaElement.prototype.mediaKeys=null,HTMLMediaElement.prototype.setMediaKeys=Hn,window.MediaKeys=In,window.MediaKeySystemAccess=Jn)},-10);var Kn="";function Ln(b){var c=Kn;return c?c+b.charAt(0).toUpperCase()+b.slice(1):b}function Mn(b,c){B.debug("PatchedMediaKeysWebkit.requestMediaKeySystemAccess");try{var d=new Nn(b,c);return Promise.resolve(d)}catch(e){return Promise.reject(e)}}function On(b){B.debug("PatchedMediaKeysWebkit.setMediaKeys");var c=this.mediaKeys;c&&c!=b&&Pn(c,null);delete this.mediaKeys;(this.mediaKeys=b)&&Pn(b,this);return Promise.resolve()}
function Nn(b,c){B.debug("PatchedMediaKeysWebkit.MediaKeySystemAccess");this.a=this.keySystem=b;var d=!1;"org.w3.clearkey"==b&&(this.a="webkit-org.w3.clearkey",d=!1);var e=!1;var f=document.getElementsByTagName("video");f=f.length?f[0]:document.createElement("video");for(var g=0;g<c.length;++g){var h=c[g],k={audioCapabilities:[],videoCapabilities:[],persistentState:"optional",distinctiveIdentifier:"optional",initDataTypes:h.initDataTypes,sessionTypes:["temporary"],label:h.label},l=!1;if(h.audioCapabilities)for(var n=
0;n<h.audioCapabilities.length;++n){var p=h.audioCapabilities[n];if(p.contentType){l=!0;var q=p.contentType.split(";")[0];f.canPlayType(q,this.a)&&(k.audioCapabilities.push(p),e=!0)}}if(h.videoCapabilities)for(n=0;n<h.videoCapabilities.length;++n)p=h.videoCapabilities[n],p.contentType&&(l=!0,f.canPlayType(p.contentType,this.a)&&(k.videoCapabilities.push(p),e=!0));l||(e=f.canPlayType("video/mp4",this.a)||f.canPlayType("video/webm",this.a));"required"==h.persistentState&&(d?(k.persistentState="required",
k.sessionTypes=["persistent-license"]):e=!1);if(e){this.b=k;return}}d="Unsupported keySystem";if("org.w3.clearkey"==b||"com.widevine.alpha"==b)d="None of the requested configurations were supported.";d=Error(d);d.name="NotSupportedError";d.code=DOMException.NOT_SUPPORTED_ERR;throw d;}Nn.prototype.createMediaKeys=function(){B.debug("PatchedMediaKeysWebkit.MediaKeySystemAccess.createMediaKeys");var b=new Qn(this.a);return Promise.resolve(b)};
Nn.prototype.getConfiguration=function(){B.debug("PatchedMediaKeysWebkit.MediaKeySystemAccess.getConfiguration");return this.b};function Qn(b){B.debug("PatchedMediaKeysWebkit.MediaKeys");this.g=b;this.b=null;this.a=new M;this.c=[];this.f={}}function Pn(b,c){b.b=c;b.a.hb();var d=Kn;c&&(b.a.B(c,d+"needkey",b.cg.bind(b)),b.a.B(c,d+"keymessage",b.Fg.bind(b)),b.a.B(c,d+"keyadded",b.Dg.bind(b)),b.a.B(c,d+"keyerror",b.Eg.bind(b)))}m=Qn.prototype;
m.createSession=function(b){B.debug("PatchedMediaKeysWebkit.MediaKeys.createSession");b=b||"temporary";if("temporary"!=b&&"persistent-license"!=b)throw new TypeError("Session type "+b+" is unsupported on this platform.");var c=this.b||document.createElement("video");c.src||(c.src="about:blank");b=new Rn(c,this.g,b);this.c.push(b);return b};m.setServerCertificate=function(){B.debug("PatchedMediaKeysWebkit.MediaKeys.setServerCertificate");return Promise.resolve(!1)};
m.cg=function(b){B.debug("PatchedMediaKeysWebkit.onWebkitNeedKey_",b);var c=document.createEvent("CustomEvent");c.initCustomEvent("encrypted",!1,!1,null);c.initDataType="cenc";b.initData instanceof ArrayBuffer?c.initData=b.initData:c.initData=b.initData.buffer;this.b.dispatchEvent(c)};
m.Fg=function(b){B.debug("PatchedMediaKeysWebkit.onWebkitKeyMessage_",b);var c=Sn(this,b.sessionId);c?(b=new K("message",{messageType:void 0==c.keyStatuses.a?"licenserequest":"licenserenewal",message:b.message}),B.debug("PatchedMediaKeysWebkit.MediaKeySession.generated"),c.b&&(c.b.resolve(),c.b=null),c.dispatchEvent(b)):B.error("Session not found",b.sessionId)};
m.Dg=function(b){B.debug("PatchedMediaKeysWebkit.onWebkitKeyAdded_",b);if(b=Sn(this,b.sessionId))B.debug("PatchedMediaKeysWebkit.MediaKeySession.ready"),Tn(b,"usable"),b.a&&b.a.resolve(),b.a=null};m.Eg=function(b){B.debug("PatchedMediaKeysWebkit.onWebkitKeyError_",b);var c=Sn(this,b.sessionId);c&&c.handleError(b)};
function Sn(b,c){var d=b.f[c];return d?(B.debug("PatchedMediaKeysWebkit.MediaKeys.findSession_",d),d):(d=b.c.shift())?(d.sessionId=c,b.f[c]=d,B.debug("PatchedMediaKeysWebkit.MediaKeys.findSession_",d),d):null}function Rn(b,c,d){B.debug("PatchedMediaKeysWebkit.MediaKeySession");bc.call(this);this.f=b;this.h=!1;this.a=this.b=null;this.c=c;this.g=d;this.sessionId="";this.expiration=NaN;this.closed=new E;this.keyStatuses=new Un}bb(Rn,bc);m=Rn.prototype;
m.handleError=function(b){B.debug("PatchedMediaKeysWebkit.MediaKeySession.handleError",b);var c=Error("EME v0.1b key error"),d=b.errorCode;d.systemCode=b.systemCode;c.errorCode=d;!b.sessionId&&this.b?(45==b.systemCode&&(c.message="Unsupported session type."),this.b.reject(c),this.b=null):b.sessionId&&this.a?(this.a.reject(c),this.a=null):(c=b.systemCode,b.errorCode.code==MediaKeyError.MEDIA_KEYERR_OUTPUT?Tn(this,"output-restricted"):1==c?Tn(this,"expired"):Tn(this,"internal-error"))};
function Vn(b,c,d){if(b.h)return Promise.reject(Error("The session is already initialized."));b.h=!0;try{if("persistent-license"==b.g)if(d)var e=new Uint8Array(Kb("LOAD_SESSION|"+d));else{var f=Kb("PERSISTENT|"),g=new Uint8Array(f.byteLength+c.byteLength);g.set(new Uint8Array(f),0);g.set(new Uint8Array(c),f.byteLength);e=g}else e=new Uint8Array(c)}catch(k){return Promise.reject(k)}b.b=new E;var h=Ln("generateKeyRequest");try{b.f[h](b.c,e)}catch(k){if("InvalidStateError"!=k.name)return b.b=null,Promise.reject(k);
(new I(function(){try{b.f[h](b.c,e)}catch(l){b.b.reject(l),b.b=null}})).R(.01)}return b.b}
m.Kd=function(b,c){if(this.a)this.a.then(this.Kd.bind(this,b,c))["catch"](this.Kd.bind(this,b,c));else{this.a=b;if("webkit-org.w3.clearkey"==this.c){var d=Gb(c);var e=JSON.parse(d);"oct"!=e.keys[0].kty&&(this.a.reject(Error("Response is not a valid JSON Web Key Set.")),this.a=null);d=G.Fa(e.keys[0].k);e=G.Fa(e.keys[0].kid)}else d=new Uint8Array(c),e=null;var f=Ln("addKey");try{this.f[f](this.c,d,e,this.sessionId)}catch(g){this.a.reject(g),this.a=null}}};
function Tn(b,c){var d=b.keyStatuses;d.size=void 0==c?0:1;d.a=c;b.dispatchEvent(new K("keystatuseschange"))}m.generateRequest=function(b,c){B.debug("PatchedMediaKeysWebkit.MediaKeySession.generateRequest");return Vn(this,c,null)};m.load=function(b){B.debug("PatchedMediaKeysWebkit.MediaKeySession.load");return"persistent-license"==this.g?Vn(this,null,b):Promise.reject(Error("Not a persistent session."))};
m.update=function(b){B.debug("PatchedMediaKeysWebkit.MediaKeySession.update",b);var c=new E;this.Kd(c,b);return c};m.close=function(){B.debug("PatchedMediaKeysWebkit.MediaKeySession.close");if("persistent-license"!=this.g){if(!this.sessionId)return this.closed.reject(Error("The session is not callable.")),this.closed;var b=Ln("cancelKeyRequest");try{this.f[b](this.c,this.sessionId)}catch(c){}}this.closed.resolve();return this.closed};
m.remove=function(){B.debug("PatchedMediaKeysWebkit.MediaKeySession.remove");return"persistent-license"!=this.g?Promise.reject(Error("Not a persistent session.")):this.close()};function Un(){this.size=0;this.a=void 0}var Wn;m=Un.prototype;m.forEach=function(b){this.a&&b(this.a,Wn)};m.get=function(b){if(this.has(b))return this.a};m.has=function(b){var c=Wn;return this.a&&G.Da(new Uint8Array(b),new Uint8Array(c))?!0:!1};m.entries=function(){};m.keys=function(){};m.values=function(){};
cn(function(){if(!(!window.HTMLVideoElement||navigator.requestMediaKeySystemAccess&&MediaKeySystemAccess.prototype.getConfiguration)){if(HTMLMediaElement.prototype.webkitGenerateKeyRequest)B.info("Using webkit-prefixed EME v0.1b"),Kn="webkit";else if(HTMLMediaElement.prototype.generateKeyRequest)B.info("Using nonprefixed EME v0.1b");else return;Wn=(new Uint8Array([0])).buffer;navigator.requestMediaKeySystemAccess=Mn;delete HTMLMediaElement.prototype.mediaKeys;HTMLMediaElement.prototype.mediaKeys=
null;HTMLMediaElement.prototype.setMediaKeys=On;window.MediaKeys=Qn;window.MediaKeySystemAccess=Nn}});function Xn(b){b=b.target;if("picture-in-picture"==b.webkitPresentationMode){document.pictureInPictureElement=b;var c=new Event("enterpictureinpicture");b.dispatchEvent(c)}else document.pictureInPictureElement==b&&(document.pictureInPictureElement=null),c=new Event("leavepictureinpicture"),b.dispatchEvent(c)}
function Yn(){return this.webkitSupportsPresentationMode("picture-in-picture")?(this.webkitSetPresentationMode("picture-in-picture"),document.pictureInPictureElement=this,Promise.resolve()):Promise.reject(Error("PiP not allowed by video element"))}function Zn(){var b=document.pictureInPictureElement;return b?(b.webkitSetPresentationMode("inline"),document.pictureInPictureElement=null,Promise.resolve()):Promise.reject(Error("No picture in picture element found"))}
function $n(){return this.hasAttribute("disablePictureInPicture")?!0:!this.webkitSupportsPresentationMode("picture-in-picture")}function ao(b){b?this.setAttribute("disablePictureInPicture",""):this.removeAttribute("disablePictureInPicture")}
cn(function(){if(window.HTMLVideoElement){var b=HTMLVideoElement.prototype;b.requestPictureInPicture&&document.exitPictureInPicture||!b.webkitSupportsPresentationMode||(B.debug("PiPWebkit.install"),document.pictureInPictureEnabled=!0,document.pictureInPictureElement=null,b.requestPictureInPicture=Yn,Object.defineProperty(b,"disablePictureInPicture",{get:$n,set:ao,enumerable:!0,configurable:!0}),document.exitPictureInPicture=Zn,document.addEventListener("webkitpresentationmodechanged",Xn,!0))}});cn(function(){B.debug("VideoPlayPromise.install");if(window.HTMLMediaElement){var b=HTMLMediaElement.prototype.play;HTMLMediaElement.prototype.play=function(){var c=b.apply(this);c&&c["catch"](function(){});return c}}});function bo(){return{droppedVideoFrames:this.webkitDroppedFrameCount,totalVideoFrames:this.webkitDecodedFrameCount,corruptedVideoFrames:0,creationTime:NaN,totalFrameDelay:0}}cn(function(){if(window.HTMLVideoElement){var b=HTMLVideoElement.prototype;!b.getVideoPlaybackQuality&&"webkitDroppedFrameCount"in b&&(b.getVideoPlaybackQuality=bo)}});function co(b,c,d){return new window.TextTrackCue(b,c,d)}function eo(b,c,d){return new window.TextTrackCue(b+"-"+c+"-"+d,b,c,d)}
cn(function(){if(window.VTTCue)B.info("Using native VTTCue.");else if(window.TextTrackCue){var b=TextTrackCue.length;if(3==b)B.info("Using VTTCue polyfill from 3 argument TextTrackCue."),window.VTTCue=co;else if(6==b)B.info("Using VTTCue polyfill from 6 argument TextTrackCue."),window.VTTCue=eo;else{try{var c=!!co(1,2,"")}catch(d){c=!1}c&&(B.info("Using VTTCue polyfill from 3 argument TextTrackCue."),window.VTTCue=co)}}else B.error("VTTCue not available.")});function fo(){}A("shaka.text.TtmlTextParser",fo);fo.prototype.parseInit=function(){};fo.prototype.parseInit=fo.prototype.parseInit;
fo.prototype.parseMedia=function(b,c){var d=Gb(b),e=[],f=new DOMParser,g=null;if(""==d)return e;try{g=f.parseFromString(d,"text/xml")}catch(sa){throw new D(2,2,2005,"Failed to parse TTML.");}if(g){if(d=g.getElementsByTagName("parsererror")[0])throw new D(2,2,2005,d.textContent);if(f=g.getElementsByTagName("tt")[0]){var h=U.getAttributeNS(f,"http://www.w3.org/ns/ttml#parameter","frameRate");var k=U.getAttributeNS(f,"http://www.w3.org/ns/ttml#parameter","subFrameRate");var l=U.getAttributeNS(f,"http://www.w3.org/ns/ttml#parameter",
"frameRateMultiplier");var n=U.getAttributeNS(f,"http://www.w3.org/ns/ttml#parameter","tickRate");g=f.getAttribute("xml:space")||"default";d=U.getAttributeNS(f,"http://www.w3.org/ns/ttml#styling","extent")}else throw new D(2,2,2005,"TTML does not contain <tt> tag.");if("default"!=g&&"preserve"!=g)throw new D(2,2,2005,"Invalid xml:space value: "+g);g="default"==g;h=new go(h,k,l,n);k=ho(f.getElementsByTagName("metadata")[0]);l=ho(f.getElementsByTagName("styling")[0]);n=ho(f.getElementsByTagName("layout")[0]);
for(var p=[],q=0;q<n.length;q++){var r=n[q],y=l,C=d;var z=new Jd;var F=r.getAttribute("xml:id");if(F){z.id=F;F=null;C&&(F=io.exec(C)||jo.exec(C));C=F?Number(F[1]):null;F=F?Number(F[2]):null;var H,R;if(H=ko(r,y,"extent"))H=(R=io.exec(H))||jo.exec(H),null!=H&&(z.width=null!=C?100*Number(H[1])/C:Number(H[1]),z.height=null!=F?100*Number(H[2])/F:Number(H[2]),z.widthUnits=R||null!=C?Xd:0,z.heightUnits=R||null!=F?Xd:0);if(r=ko(r,y,"origin"))H=(R=io.exec(r))||jo.exec(r),null!=H&&(z.viewportAnchorX=null!=
C?100*Number(H[1])/C:Number(H[1]),z.viewportAnchorY=null!=F?100*Number(H[2])/F:Number(H[2]),z.viewportAnchorUnits=R||null!=C?Xd:0)}else B.m("TtmlTextParser parser encountered a region with no id. Region will be ignored."),z=null;z&&p.push(z)}d=lo(f.getElementsByTagName("body")[0]);d=t(d);for(f=d.next();!f.done;f=d.next())(f=mo(f.value,c.periodStart,h,k,l,n,p,g,!1))&&e.push(f)}return e};fo.prototype.parseMedia=fo.prototype.parseMedia;
var io=/^(\d{1,2}(?:\.\d+)?|100(?:\.0+)?)% (\d{1,2}(?:\.\d+)?|100(?:\.0+)?)%$/,no=/^(\d+px|\d+em)$/,jo=/^(\d+)px (\d+)px$/,oo=/^(\d{2,}):(\d{2}):(\d{2}):(\d{2})\.?(\d+)?$/,po=/^(?:(\d{2,}):)?(\d{2}):(\d{2})$/,qo=/^(?:(\d{2,}):)?(\d{2}):(\d{2}\.\d{2,})$/,ro=/^(\d*(?:\.\d*)?)f$/,so=/^(\d*(?:\.\d*)?)t$/,to=/^(?:(\d*(?:\.\d*)?)h)?(?:(\d*(?:\.\d*)?)m)?(?:(\d*(?:\.\d*)?)s)?(?:(\d*(?:\.\d*)?)ms)?$/,uo={left:Pd,center:"center",right:"end",start:Pd,end:"end"},vo={left:"line-left",center:"center",right:"line-right"};
function ho(b){var c=[];if(!b)return c;for(var d=t(b.childNodes),e=d.next();!e.done;e=d.next())e=e.value,e.nodeType==Node.ELEMENT_NODE&&"br"!==e.nodeName&&(e=ho(e),c=c.concat(e));c.length||c.push(b);return c}function lo(b){if(!b)return[];var c=[];b=t(b.childNodes);for(var d=b.next();!d.done;d=b.next())d=d.value,d instanceof Element&&(d.hasAttribute("begin")?c.push(d):c=c.concat(lo(d)));return c}
function wo(b,c){for(var d="",e=t(b.childNodes),f=e.next();!f.done;f=e.next())f=f.value,"br"==f.nodeName&&b.childNodes[0]!==f?d+="\n":f.childNodes&&0<f.childNodes.length?d+=wo(f,c):c?(f=f.textContent.trim(),f=f.replace(/\s+/g," "),d+=f):d+=f.textContent;return d}
function mo(b,c,d,e,f,g,h,k,l){if(l&&"br"==b.nodeName)return b=new Hd(0,0,""),b.spacer=!0,b;var n=/^[\s\n]*$/.test(b.textContent),p=b.nodeType==Node.ELEMENT_NODE&&!b.hasAttribute("begin")&&!b.hasAttribute("end");if(b.nodeType!=Node.ELEMENT_NODE||p&&n||p&&!l)return null;k="default"==(b.getAttribute("xml:space")||(k?"default":"preserve"));n=xo(b.getAttribute("begin"),d);p=xo(b.getAttribute("end"),d);var q=xo(b.getAttribute("dur"),d);null==p&&null!=q&&(p=n+q);if(!l&&(null==n||null==p))throw new D(2,
2,2001);n=l&&null==n?0:n+c;p=l&&null==p?0:p+c;q="";l=[];if(Array.from(b.childNodes).find(function(b){return b.nodeType===Node.TEXT_NODE&&/\S+/.test(b.textContent)}))q=wo(b,k);else for(var r=t(b.childNodes),y=r.next();!y.done;y=r.next())if(y=mo(y.value,c,d,e,f,g,h,k,!0))y.startTime=y.startTime||n,y.endTime=y.endTime||p,l.push(y);c=new Hd(n,p,q);c.nestedCues=l;if((g=yo(b,"region",g,"")[0])&&g.getAttribute("xml:id")){var C=g.getAttribute("xml:id");c.region=h.filter(function(b){return b.id==C})[0]}e=
yo(b,"backgroundImage",e,"#","http://www.smpte-ra.org/schemas/2052-1/2010/smpte-tt")[0];zo(c,b,g,e,f);return c}
function zo(b,c,d,e,f){"rtl"==Ao(c,d,f,"direction")&&(b.direction="rtl");var g=Ao(c,d,f,"writingMode");"tb"==g||"tblr"==g?b.writingMode="vertical-lr":"tbrl"==g?b.writingMode="vertical-rl":"rltb"==g||"rl"==g?b.direction="rtl":g&&(b.direction=Id);(g=Ao(c,d,f,"textAlign"))?(b.positionAlign=vo[g],b.lineAlign=uo[g],b.textAlign=Td[g.toUpperCase()]):b.textAlign="start";if(g=Ao(c,d,f,"displayAlign"))b.displayAlign=Ud[g.toUpperCase()];if(g=Ao(c,d,f,"color"))b.color=g;if(g=Ao(c,d,f,"backgroundColor"))b.backgroundColor=
g;if(g=Ao(c,d,f,"fontFamily"))b.fontFamily=g;(g=Ao(c,d,f,"fontWeight"))&&"bold"==g&&(b.fontWeight=700);(g=Ao(c,d,f,"wrapOption"))&&"noWrap"==g&&(b.wrapLine=!1);(g=Ao(c,d,f,"lineHeight"))&&g.match(no)&&(b.lineHeight=g);(g=Ao(c,d,f,"fontSize"))&&g.match(no)&&(b.fontSize=g);if(g=Ao(c,d,f,"fontStyle"))b.fontStyle=Wd[g.toUpperCase()];if(e){g=e.getAttribute("imageType")||e.getAttribute("imagetype");var h=e.getAttribute("encoding");e=e.textContent.trim();"PNG"==g&&"Base64"==h&&e&&(b.backgroundImage="data:image/png;base64,"+
e)}(d=ko(d,f,"textDecoration"))&&Bo(b,d);(c=Co(c,f,"textDecoration"))&&Bo(b,c)}
function Bo(b,c){for(var d=c.split(" "),e=0;e<d.length;e++)switch(d[e]){case "underline":b.textDecoration.includes("underline")||b.textDecoration.push("underline");break;case "noUnderline":b.textDecoration.includes("underline")&&fc(b.textDecoration,"underline");break;case "lineThrough":b.textDecoration.includes("lineThrough")||b.textDecoration.push("lineThrough");break;case "noLineThrough":b.textDecoration.includes("lineThrough")&&fc(b.textDecoration,"lineThrough");break;case "overline":b.textDecoration.includes("overline")||
b.textDecoration.push("overline");break;case "noOverline":b.textDecoration.includes("overline")&&fc(b.textDecoration,"overline")}}function Ao(b,c,d,e){return(b=Co(b,d,e))?b:ko(c,d,e)}function ko(b,c,d){if(!b)return null;for(var e=ho(b),f=0;f<e.length;f++){var g=U.getAttributeNS(e[f],"http://www.w3.org/ns/ttml#styling",d);if(g)return g}return Do(b,c,d)}function Co(b,c,d){var e=U.getAttributeNS(b,"http://www.w3.org/ns/ttml#styling",d);return e?e:Do(b,c,d)}
function Do(b,c,d){b=yo(b,"style",c,"");for(var e=null,f=0;f<b.length;f++){var g=U.getAttributeNS(b[f],"http://www.w3.org/ns/ttml#styling",d);g||(g=Co(b[f],c,d));g&&(e=g)}return e}
function yo(b,c,d,e,f){var g=[];if(!b||1>d.length)return g;var h=b;for(b=null;h&&!(b=f?U.getAttributeNS(h,f,c):h.getAttribute(c))&&(h=h.parentNode,h instanceof Element););if(c=b)for(c=c.split(" "),c=t(c),f=c.next();!f.done;f=c.next())for(f=f.value,b=t(d),h=b.next();!h.done;h=b.next())if(h=h.value,e+h.getAttribute("xml:id")==f){g.push(h);break}return g}
function xo(b,c){var d=null;if(oo.test(b)){d=oo.exec(b);var e=Number(d[1]),f=Number(d[2]),g=Number(d[3]),h=Number(d[4]);h+=(Number(d[5])||0)/c.b;g+=h/c.frameRate;d=g+60*f+3600*e}else po.test(b)?d=Eo(po,b):qo.test(b)?d=Eo(qo,b):ro.test(b)?(d=ro.exec(b),d=Number(d[1])/c.frameRate):so.test(b)?(d=so.exec(b),d=Number(d[1])/c.a):to.test(b)&&(d=Eo(to,b));return d}
function Eo(b,c){var d=b.exec(c);return null==d||""==d[0]?null:(Number(d[4])||0)/1E3+(Number(d[3])||0)+60*(Number(d[2])||0)+3600*(Number(d[1])||0)}function go(b,c,d,e){this.frameRate=Number(b)||30;this.b=Number(c)||1;this.a=Number(e);0==this.a&&(this.a=b?this.frameRate*this.b:1);d&&(b=/^(\d+) (\d+)$/g.exec(d))&&(this.frameRate*=Number(b[1])/Number(b[2]))}$d["application/ttml+xml"]=fo;function Fo(){this.a=new fo}A("shaka.text.Mp4TtmlParser",Fo);Fo.prototype.parseInit=function(b){var c=!1;(new T).L("moov",Df).L("trak",Df).L("mdia",Df).L("minf",Df).L("stbl",Df).ia("stsd",Ff).L("stpp",function(b){c=!0;b.parser.stop()}).parse(b);if(!c)throw new D(2,2,2007);};Fo.prototype.parseInit=Fo.prototype.parseInit;Fo.prototype.parseMedia=function(b,c){var d=!1,e=[];(new T).L("mdat",Gf(function(b){d=!0;e=e.concat(this.a.parseMedia(b,c))}.bind(this))).parse(b);if(!d)throw new D(2,2,2007);return e};
Fo.prototype.parseMedia=Fo.prototype.parseMedia;$d['application/mp4; codecs="stpp"']=Fo;$d['application/mp4; codecs="stpp.ttml.im1t"']=Fo;$d['application/mp4; codecs="stpp.TTML.im1t"']=Fo;function Go(){}A("shaka.text.VttTextParser",Go);Go.prototype.parseInit=function(){};Go.prototype.parseInit=Go.prototype.parseInit;
Go.prototype.parseMedia=function(b,c){var d=Gb(b);d=d.replace(/\r\n|\r(?=[^\n]|$)/gm,"\n");d=d.split(/\n{2,}/m);if(!/^WEBVTT($|[ \t\n])/m.test(d[0]))throw new D(2,2,2E3);var e=c.segmentStart;if(null==e&&(e=0,d[0].includes("X-TIMESTAMP-MAP"))){var f=d[0].match(/LOCAL:((?:(\d{1,}):)?(\d{2}):(\d{2})\.(\d{3}))/m),g=d[0].match(/MPEGTS:(\d+)/m);if(f&&g){e=Ho(new Ug(f[1]));if(null==e)throw new D(2,2,2E3);e=c.periodStart+(Number(g[1])/9E4-e)}}g=[];var h=d[0].split("\n");for(f=1;f<h.length;f++)if(/^Region:/.test(h[f])){var k=
new Ug(h[f]),l=new Jd;Xg(k);Vg(k);for(var n=Xg(k);n;){var p;a:{var q=l,r=n;if(p=/^id=(.*)$/.exec(r))q.id=p[1];else if(p=/^width=(\d{1,2}|100)%$/.exec(r))q.width=Number(p[1]);else if(p=/^lines=(\d+)$/.exec(r))q.height=Number(p[1]),q.heightUnits=2;else if(p=/^regionanchor=(\d{1,2}|100)%,(\d{1,2}|100)%$/.exec(r))q.regionAnchorX=Number(p[1]),q.regionAnchorY=Number(p[2]);else if(p=/^viewportanchor=(\d{1,2}|100)%,(\d{1,2}|100)%$/.exec(r))q.viewportAnchorX=Number(p[1]),q.viewportAnchorY=Number(p[2]);else if(/^scroll=up$/.exec(r))q.scroll=
"up";else{p=!1;break a}p=!0}p||B.m("VTT parser encountered an invalid VTTRegion setting: ",n," The setting will be ignored.");Vg(k);n=Xg(k)}g.push(l)}f=[];for(k=1;k<d.length;k++){h=d[k].split("\n");p=h;q=e;h=g;if(1==p.length&&!p[0]||/^NOTE($|[ \t])/.test(p[0])||"STYLE"==p[0])h=null;else{l=null;p[0].includes("--\x3e")||(l=p[0],p.splice(0,1));n=new Ug(p[0]);r=Ho(n);var y=Wg(n,/[ \t]+--\x3e[ \t]+/g),C=Ho(n);if(null==r||null==y||null==C)throw new D(2,2,2001);p=new Hd(r+q,C+q,p.slice(1).join("\n").trim());
Vg(n);for(q=Xg(n);q;)Io(p,q,h)||B.m("VTT parser encountered an invalid VTT setting: ",q," The setting will be ignored."),Vg(n),q=Xg(n);null!=l&&(p.id=l);h=p}h&&f.push(h)}return f};Go.prototype.parseMedia=Go.prototype.parseMedia;
function Io(b,c,d){var e;if(e=/^align:(start|middle|center|end|left|right)$/.exec(c))c=e[1],"middle"==c?b.textAlign=Md:b.textAlign=Td[c.toUpperCase()];else if(e=/^vertical:(lr|rl)$/.exec(c))b.writingMode="lr"==e[1]?"vertical-lr":"vertical-rl";else if(e=/^size:([\d.]+)%$/.exec(c))b.size=Number(e[1]);else if(e=/^position:([\d.]+)%(?:,(line-left|line-right|center|start|end))?$/.exec(c))b.position=Number(e[1]),e[2]&&(c=e[2],b.positionAlign="line-left"==c||"start"==c?"line-left":"line-right"==c||"end"==
c?"line-right":"center");else if(e=/^region:(.*)$/.exec(c)){if(c=Jo(d,e[1]))b.region=c}else{a:{if(d=/^line:([\d.]+)%(?:,(start|end|center))?$/.exec(c))b.lineInterpretation=1,b.line=Number(d[1]),d[2]&&(b.lineAlign=Vd[d[2].toUpperCase()]);else if(d=/^line:(-?\d+)(?:,(start|end|center))?$/.exec(c))b.lineInterpretation=Od,b.line=Number(d[1]),d[2]&&(b.lineAlign=Vd[d[2].toUpperCase()]);else{b=!1;break a}b=!0}return b}return!0}
function Jo(b,c){var d=b.filter(function(b){return b.id==c});return d.length?d[0]:(B.m("VTT parser could not find a region with id: ",c," The region will be ignored."),null)}function Ho(b){b=Wg(b,/(?:(\d{1,}):)?(\d{2}):(\d{2})\.(\d{3})/g);if(null==b)return null;var c=Number(b[2]),d=Number(b[3]);return 59<c||59<d?null:Number(b[4])/1E3+d+60*c+3600*(Number(b[1])||0)}$d["text/vtt"]=Go;$d['text/vtt; codecs="vtt"']=Go;$d['text/vtt; codecs="wvtt"']=Go;function Ko(){this.a=null}A("shaka.text.Mp4VttParser",Ko);Ko.prototype.parseInit=function(b){var c=!1;(new T).L("moov",Df).L("trak",Df).L("mdia",Df).ia("mdhd",function(b){0==b.version?(b.reader.P(4),b.reader.P(4),this.a=b.reader.I(),b.reader.P(4)):(b.reader.P(8),b.reader.P(8),this.a=b.reader.I(),b.reader.P(8));b.reader.P(4)}.bind(this)).L("minf",Df).L("stbl",Df).ia("stsd",Ff).L("wvtt",function(){c=!0}).parse(b);if(!this.a)throw new D(2,2,2008);if(!c)throw new D(2,2,2008);};
Ko.prototype.parseInit=Ko.prototype.parseInit;
Ko.prototype.parseMedia=function(b,c){var d=this;if(!this.a)throw B.error("No init segment for MP4+VTT!"),new D(2,2,2008);var e=0,f=[],g,h=[],k=!1,l=!1,n=!1,p=null;(new T).L("moof",Df).L("traf",Df).ia("tfdt",function(b){k=!0;e=0==b.version?b.reader.I():b.reader.Kb()}).ia("tfhd",function(b){var c=b.flags;b=b.reader;b.P(4);c&1&&b.P(8);c&2&&b.P(4);p=c&8?b.I():null}).ia("trun",function(b){l=!0;var c=b.version,d=b.flags;b=b.reader;var e=b.I();d&1&&b.P(4);d&4&&b.P(4);for(var g=[],h=0;h<e;h++){var k={duration:null,
sampleSize:null,Md:null};d&256&&(k.duration=b.I());d&512&&(k.sampleSize=b.I());d&1024&&b.P(4);d&2048&&(k.Md=0==c?b.I():b.ye());g.push(k)}f=g}).L("mdat",Gf(function(b){n=!0;g=b})).parse(b);if(!n&&!k&&!l)throw new D(2,2,2008);var q=e,r=new DataView(g.buffer,g.byteOffset,g.byteLength),y=new S(r,0);f.forEach(function(b){var f=b.duration||p,g=b.Md?e+b.Md:q;q=g+(f||0);var k=0;do{var l=y.I();k+=l;var n=y.I();n=Cf(n);var r=null;"vttc"==n?8<l&&(r=y.gb(l-8)):("vtte"!=n&&B.error("Unknown box "+n+"! Skipping!"),
y.P(l-8));f?r&&h.push(Lo(r,c.periodStart+g/d.a,c.periodStart+q/d.a)):B.error("WVTT sample duration unknown, and no default found!")}while(b.sampleSize&&k<b.sampleSize)});return h.filter(xb.Na)};Ko.prototype.parseMedia=Ko.prototype.parseMedia;function Lo(b,c,d){var e,f,g;(new T).L("payl",Gf(function(b){e=Gb(b)})).L("iden",Gf(function(b){f=Gb(b)})).L("sttg",Gf(function(b){g=Gb(b)})).parse(b);return e?Mo(e,f,g,c,d):null}
function Mo(b,c,d,e,f){b=new Hd(e,f,b);c&&(b.id=c);if(d)for(c=new Ug(d),d=Xg(c);d;)Io(b,d,[])||B.m("VTT parser encountered an invalid VTT setting: ",d," The setting will be ignored."),Vg(c),d=Xg(c);return b}$d['application/mp4; codecs="wvtt"']=Ko;A("shaka.util.Dom.createHTMLElement",function(b){return document.createElement(b)});A("shaka.util.Dom.createVideoElement",function(){var b=document.createElement("video");b.muted=!0;b.width=600;b.height=400;return b});A("shaka.util.Dom.asHTMLElement",function(b){return b});A("shaka.util.Dom.asHTMLMediaElement",function(b){return b});A("shaka.util.Dom.removeAllChildren",function(b){for(;b.firstChild;)b.removeChild(b.firstChild)});/*
 @license
 EME Encryption Scheme Polyfill
 Copyright 2019 Google LLC
 SPDX-License-Identifier: Apache-2.0
*/
function No(){}var Oo;A("EmeEncryptionSchemePolyfill",No);function Po(){Oo?console.debug("EmeEncryptionSchemePolyfill: Already installed."):navigator.requestMediaKeySystemAccess&&MediaKeySystemAccess.prototype.getConfiguration?(Oo=navigator.requestMediaKeySystemAccess,console.debug("EmeEncryptionSchemePolyfill: Waiting to detect encryptionScheme support."),navigator.requestMediaKeySystemAccess=Qo):console.debug("EmeEncryptionSchemePolyfill: EME not found")}No.install=Po;
function Qo(b,c){var d=this;return u(function f(){var g;return x(f,function(f){switch(f.j){case 1:return console.assert(d==navigator,'bad "this" for requestMediaKeySystemAccess'),v(f,Oo.call(d,b,c),2);case 2:g=f.s;if(Ro(g))return console.debug("EmeEncryptionSchemePolyfill: Native encryptionScheme support found."),navigator.requestMediaKeySystemAccess=Oo,f["return"](g);console.debug("EmeEncryptionSchemePolyfill: No native encryptionScheme support found. Patching encryptionScheme support.");navigator.requestMediaKeySystemAccess=
So;return f["return"](So.call(d,b,c))}})})}
function So(b,c){var d=this;return u(function f(){var g,h,k,l,n,p,q,r;return x(f,function(f){switch(f.j){case 1:console.assert(d==navigator,'bad "this" for requestMediaKeySystemAccess');g=To(b);h=[];for(var y=t(c),z=y.next();!z.done;z=y.next())k=z.value,l=Uo(k.videoCapabilities,g),n=Uo(k.audioCapabilities,g),k.videoCapabilities&&k.videoCapabilities.length&&!l.length||k.audioCapabilities&&k.audioCapabilities.length&&!n.length||(p=Object.assign({},k),p.videoCapabilities=l,p.audioCapabilities=n,h.push(p));
if(!h.length)throw q=Error("Unsupported keySystem or supportedConfigurations."),q.name="NotSupportedError",q.code=DOMException.NOT_SUPPORTED_ERR,q;return v(f,Oo.call(d,b,h),2);case 2:return r=f.s,f["return"](new Vo(r,g))}})})}function Uo(b,c){return b?b.filter(function(b){return!b.encryptionScheme||b.encryptionScheme==c}):b}function Wo(){}var Xo;A("McEncryptionSchemePolyfill",Wo);
function Yo(){Xo?console.debug("McEncryptionSchemePolyfill: Already installed."):navigator.mediaCapabilities?(Xo=navigator.mediaCapabilities.decodingInfo,console.debug("McEncryptionSchemePolyfill: Waiting to detect encryptionScheme support."),navigator.mediaCapabilities.decodingInfo=Zo):console.debug("McEncryptionSchemePolyfill: MediaCapabilities not found")}Wo.install=Yo;
function Zo(b){var c=this;return u(function e(){var f,g;return x(e,function(e){switch(e.j){case 1:return console.assert(c==navigator.mediaCapabilities,'bad "this" for decodingInfo'),v(e,Xo.call(c,b),2);case 2:f=e.s;if(!b.keySystemConfiguration||!f.keySystemAccess)return e["return"](f);g=f.keySystemAccess;if(Ro(g))return console.debug("McEncryptionSchemePolyfill: Native encryptionScheme support found."),navigator.mediaCapabilities.decodingInfo=Xo,e["return"](f);console.debug("McEncryptionSchemePolyfill: No native encryptionScheme support found. Patching encryptionScheme support.");
navigator.mediaCapabilities.decodingInfo=$o;return e["return"]($o.call(c,b))}})})}
function $o(b){var c=this;return u(function e(){var f,g,h,k,l,n,p;return x(e,function(e){switch(e.j){case 1:return console.assert(c==navigator.mediaCapabilities,'bad "this" for decodingInfo'),f=null,b.keySystemConfiguration&&(g=b.keySystemConfiguration,h=g.keySystem,k=g.audio&&g.audio.encryptionScheme,l=g.video&&g.video.encryptionScheme,f=To(h),n={powerEfficient:!1,smooth:!1,supported:!1,keySystemAccess:null,configuration:b},k&&k!=f||l&&l!=f)?e["return"](n):v(e,Xo.call(c,b),2);case 2:return p=e.s,
p.keySystemAccess&&(p.keySystemAccess=new Vo(p.keySystemAccess,f)),e["return"](p)}})})}function Vo(b,c){this.b=b;this.a=c;this.keySystem=b.keySystem}Vo.prototype.getConfiguration=function(){var b=this.b.getConfiguration();if(b.videoCapabilities)for(var c=t(b.videoCapabilities),d=c.next();!d.done;d=c.next())d.value.encryptionScheme=this.a;if(b.audioCapabilities)for(c=t(b.audioCapabilities),d=c.next();!d.done;d=c.next())d.value.encryptionScheme=this.a;return b};Vo.prototype.createMediaKeys=function(){return this.b.createMediaKeys()};
function To(b){if(b.startsWith("com.widevine")||b.startsWith("com.microsoft")||b.startsWith("com.adobe")||b.startsWith("org.w3"))return"cenc";if(b.startsWith("com.apple"))return"cbcs-1-9";console.warn("EmeEncryptionSchemePolyfill: Unknown key system:",b,"Please contribute!");return null}function Ro(b){b=b.getConfiguration();var c=b.audioCapabilities&&b.audioCapabilities[0];return(b=b.videoCapabilities&&b.videoCapabilities[0]||c)&&void 0!==b.encryptionScheme?!0:!1}function ap(){}
A("EncryptionSchemePolyfills",ap);function dn(){Po();Yo()}ap.install=dn;"undefined"!==typeof module&&module.bf&&(module.bf=ap);}).call(exportTo,innerGlobal,innerGlobal,undefined);if(typeof exports!="undefined")for(var k in exportTo.shaka)exports[k]=exportTo.shaka[k];else if(typeof define=="function"&&define.amd)define(function(){return exportTo.shaka});else innerGlobal.shaka=exportTo.shaka})();

//# sourceMappingURL=shaka-player.compiled.map